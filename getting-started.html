<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Quick Reference" href="quick-reference.html" /><link rel="prev" title="Sharing data" href="sharing-data.html" />

    <meta name="generator" content="sphinx-4.4.0, furo 2022.02.14.1"/>
        <title>Getting started - Docs</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=a8f031f701c6af50c9919b48f173a5785af06fac" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=25ceb02ed1c46dc30f2321ff83e92799f69dfdb9" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="announcement">
  <aside class="announcement-content">
     This is a preview of the restructured Sesam Documenantation site. For production go to <a href="https://docs.sesam.io">docs.sesam.io</a> 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Docs</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/sesamlogo.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="core-principles.html">Core principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Key features</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Concepts</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="best-practices.html">Best Practices</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="pre-planning.html">Planning a Sesam project</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup-environment.html">Setting up a Sesam environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="collecting_data.html">Collect</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-enrichment.html">Enrichment</a></li>
<li class="toctree-l2"><a class="reference internal" href="connecting-data.html">Connect</a></li>
<li class="toctree-l2"><a class="reference internal" href="transform-data.html">Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="sharing-data.html">Sharing data</a></li>
</ul>
</li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick-reference.html">Quick Reference</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="developer-guide.html">Developer Guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Service Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="entitymodel.html">Entity Data Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="DTLReferenceGuide.html">Data Transformation Language (DTL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html">Service API</a></li>
<li class="toctree-l2"><a class="reference internal" href="extension-points.html">Developer Extension Points</a></li>
<li class="toctree-l2"><a class="reference internal" href="json-pull.html">JSON Pull Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="json-push.html">JSON Push Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="pump-execution.html">Pump Execution Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="cron-expressions.html">Cron Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="rdf-support.html">RDF support</a></li>
<li class="toctree-l2"><a class="reference internal" href="idempotency.html">Non-idempotency</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="notifications.html">Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="low-level-debugging.html">Low-level debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="source-datatype-mapping.html">Source datatype mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="self-hosted.html">Self-hosted service</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-modelling.html">Data modelling in Sesam</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="project-workflow.html">Working on a Sesam project</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="version-control-system.html">Using Sesam with a version control system</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing-locally.html">Testing a Sesam configuration locally</a></li>
<li class="toctree-l3"><a class="reference internal" href="continuous-integration.html">Continuous integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="automatic-deployment.html">Automatic deployment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="azure.html">Sesam in Microsoft Azure</a></li>
<li class="toctree-l2"><a class="reference internal" href="deprecations.html">Deprecated features</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tools.html">Tools</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="management-studio.html">Management Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="sesam-client.html">Sesam Client</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="databrowser.html">Databrowser</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="databrowser-guide.html">Databrowser Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="databrowser-auth.html">Authentication and authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="databrowser-api.html">Configuration file API</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="gdpr-platform.html">GDPR platform</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="gdpr-platform-configuration.html">Platform configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="gdpr-data-types-purposes-configuration.html">Datatypes and purposes configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="gdpr-data-access-portal.html">The GDPR data access portal</a></li>
<li class="toctree-l3"><a class="reference internal" href="gdpr-platform-developer-docs.html">Developer documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="gdpr-getting-started.html">Getting started</a></li>
<li class="toctree-l3"><a class="reference internal" href="gdpr-changelog.html">Changelog</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="behind-the-scenes.html">Behind the scenes</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="legal.html">Legal</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="terms.html">Terms of Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="legal-service.html">Description of the Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="pricing.html">Subscription Fee, payment terms</a></li>
<li class="toctree-l2"><a class="reference internal" href="legal-dap.html">Data Process Agreement</a></li>
<li class="toctree-l2"><a class="reference internal" href="partner-agreement.html">Partner Agreement</a></li>
<li class="toctree-l2"><a class="reference internal" href="privacy-policy.html">Privacy Policy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="getting-started">
<span id="id1"></span><h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">#</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>Welcome to this introduction to Sesam! This is a basic course that will guide you through what Sesam is, what it does and how it works.</p>
<p>Sesam is an Master Data Hub using a unique approach for collection, connecting and sharing of data. The datahub is optimized for collecting or receiving data from source systems, transforming data and pushing or providing data to target systems.</p>
<p>If you want to jump straight into Sesam and get hands-on, you can go right  to the <a class="reference internal" href="#getting-started-labs"><span class="std std-ref">Labs section</span></a>.</p>
</div>
<div class="section" id="setting-up-our-sesam-instance">
<span id="getting-started-setting-up-our-sesam-node"></span><h2>Setting up our Sesam instance<a class="headerlink" href="#setting-up-our-sesam-instance" title="Permalink to this headline">#</a></h2>
<p>You must sign up using the <a class="reference external" href="https://portal.sesam.io/auth/login?redirect=dashboard">Sesam Portal</a> to purchase new or access existing Sesam instances. The default instance type is cloud based, but it’s also possible to install Sesam on-premise or in a local cloud environment. If you consider this option, please be free to contact us on <a class="reference external" href="mailto:info%40sesam.io">info<span>@</span>sesam<span>.</span>io</a> for further information). This document assumes a cloud based installation. You can also access an existing Sesam instance by registering in the <a class="reference external" href="https://portal.sesam.io/auth/login?redirect=dashboard">Sesam Portal</a> and obtaining an invitation from someone with management permissions for the existing installation.</p>
<p>The following guide requires the use of Python 3.5.x/3.4.x and a Git client.</p>
<div class="section" id="sign-up">
<span id="getting-started-sign-up"></span><h3>Sign up<a class="headerlink" href="#sign-up" title="Permalink to this headline">#</a></h3>
<p>Go to the <a class="reference external" href="https://portal.sesam.io/auth/login?redirect=dashboard">Sesam Portal</a> and sign up.</p>
<p>Once you’ve signed up you’ll see this page. Click on Request private trial.</p>
<a class="reference internal image-reference" href="_images/dashboard-view.png"><img alt="Generic pipe concept" class="align-center" src="_images/dashboard-view.png" style="width: 800px;"/></a>
<p>Once you get access to your requested private trial from the Sesam team you’ll get a card for your requested node in the Dashboard. If wanted, you can change the name of the node in the ‘Basics’ section under ‘Subscription’-settings.</p>
</div>
<div class="section" id="upload-config">
<span id="getting-started-upload-config"></span><h3>Upload config<a class="headerlink" href="#upload-config" title="Permalink to this headline">#</a></h3>
<p>Please note that uploading a config as described below <strong>will overwrite</strong> any config already on the node. You should have a node dedicated for the purpose if you are going set it up for this guide and its labs.</p>
<p>Download the <a class="reference download internal" download="" href="_downloads/47628582f05c9664e8750bb478a53fdc/getting-started-config.json"><code class="xref download docutils literal notranslate"><span class="pre">getting-started-config.json</span></code></a> and save it locally on your computer.</p>
<p>Go to your ‘Requested private trial node’ on the Sesam portal. Click on <strong>Datahub</strong> in the left menu and select the <strong>Tools tab</strong>.</p>
<a class="reference internal image-reference" href="_images/importdata.png"><img alt="Generic pipe concept" class="align-center" src="_images/importdata.png" style="width: 800px;"/></a>
<p>Upload the getting-started-config.json file through the drag &amp; drop interface. Then go to the <strong>Variables</strong> tab and paste the below code as environment variables.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"node-env"</span><span class="p">:</span> <span class="s2">"test"</span><span class="p">,</span>
  <span class="s2">"pump-mode"</span><span class="p">:</span> <span class="s2">"manual"</span><span class="p">,</span>
  <span class="s2">"udir-baseurl"</span><span class="p">:</span> <span class="s2">"https://data-nxr-fellestjeneste.udir.no/api/</span><span class="si">%s</span><span class="s2">"</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You should now have several pipes available in the <strong>pipes</strong> tab. Select all pipes and click the <strong>Enable</strong> and <strong>Start</strong> buttons. This will first populate the input pipes’ datasets with test data and then subsecuently the rest of the pipes will run to make the data flow downstream and populate the node. You can click on a pipe in the list to see details on how it’s configured.</p>
<div class="section" id="config-contents">
<h4>Config contents<a class="headerlink" href="#config-contents" title="Permalink to this headline">#</a></h4>
<p>The config, and now our node, contains eight input pipes. Six of them have embedded person data, one has postal codes and the last one has embedded orders from a webshop. In addition there is a a merge pipe for person data, two global pipes, and example pipes for modelling and exporting person address data. Have a look at how the pipes are connected by navigating between them through their Graph-tabs. The “merged-person” pipe is a good place to start.</p>
</div>
</div>
</div>
<div class="section" id="sesam-overview">
<span id="getting-started-sesam-overview"></span><h2>Sesam overview<a class="headerlink" href="#sesam-overview" title="Permalink to this headline">#</a></h2>
<p>We will now give a short overview of the Sesam machinery and the Sesam portal, before we start learning and applying the different concepts.</p>
<p>In the image above we see five main tabs under the “Training Node” section on the left-hand side. The <strong>Overview</strong> tab shows the current systems you have active, as well as their corresponding inbound and outbound pipes. The <a class="reference internal" href="concepts.html#concepts-datasets"><span class="std std-ref">Datasets</span></a> tab shows the datasets existing in the node. The tab <a class="reference internal" href="concepts.html#concepts-pipes"><span class="std std-ref">Pipes</span></a> displays the different pipes existing in the node. <a class="reference internal" href="concepts.html#concepts-systems"><span class="std std-ref">Systems</span></a> displays the various systems you employ, note that any <a class="reference internal" href="#getting-started-microservices"><span class="std std-ref">microservices</span></a> will be listed as a system. The tab <strong>Flows</strong> gives you an overview of your pipes and their connections to other pipes and systems.</p>
<p>The following picture shows the general setup of a Sesam node.</p>
<a class="reference internal image-reference" href="_images/sesam_overview.png"><img alt="Generic pipe concept" class="align-center" src="_images/sesam_overview.png" style="width: 800px;"/></a>
<p>The data is supplied to the pipes via different <a class="reference internal" href="concepts.html#concepts-sources"><span class="std std-ref">sources</span></a>. These sources might be databases such as a SQL database or a CSV file. Sometimes, the data available might not be compatible with the requirements that Sesam have, or you might wish to extract data from an API. In these cases, Sesam offers an architecture that provides a way to plugin a self-developed script, code or service into the node. This is done through what we call a <a class="reference internal" href="#getting-started-microservices"><span class="std std-ref">microservice</span></a>, which act as <strong>Systems</strong> in the Sesam node. Since not all sources have their data updated at the same time, every pipe has a <a class="reference internal" href="concepts.html#concepts-pumps"><span class="std std-ref">pump</span></a> which tells the pipe how often to run and send the data from the source dataset to its configured <a class="reference internal" href="concepts.html#concepts-sinks"><span class="std std-ref">sink</span></a>. A <strong>Sink</strong> writes the final result to a target.</p>
<p>The picture below shows the different tabs when working on a pipe.</p>
<a class="reference internal image-reference" href="_images/pipe_tabs.png"><img alt="Generic pipe concept" class="align-center" src="_images/pipe_tabs.png" style="width: 800px;"/></a>
<p>The first five tabs are the most used ones, and the ones we will focus on in this section.</p>
<p>The <strong>Dashboard</strong> tab gives you an overview of the different pipes connected to this specific pipe. The <strong>Config</strong> tab displays the <strong>DTL</strong> code in which we transform the data into the performed format and setup. The <strong>Input</strong> and <strong>Output</strong> tabs shows the data before and after being sent through the pipe, respectively. The <strong>Execution log</strong> is a helpful tool when debugging your code. This tab will display the different error messages.</p>
<div class="section" id="glossary">
<span id="getting-started-glossary"></span><h3>Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline">#</a></h3>
<p><a class="reference internal" href="concepts.html#concepts-datasets"><span class="std std-ref">Datasets</span></a>: Sesam stores its data as datasets consisting of entities. The stored datasets can be used as sources for internal pipes, where entities can be transformed using DTL, or as sources for delivering data to target systems (endpoints).</p>
<p><a class="reference internal" href="entitymodel.html"><span class="doc">Entities</span></a>: Sesam uses an entity data model as the core representation of data. Each entity is a dictionary of key-value pairs. Each key is a string and the value can either be a literal value, a list or another dictionary.</p>
<p><a class="reference internal" href="concepts.html#concepts-pipes"><span class="std std-ref">Pipes</span></a>: Defines the flow of data in Sesam. They consist of a source and can also have a set of transformations and a sink. In addition, every pipe has a pump. When the pump is running, the pipe will read the entities from its source dataset, process the configured transformations and send the resulting entities into the configured sink.</p>
<p><a class="reference internal" href="concepts.html#concepts-pumps"><span class="std std-ref">Pumps</span></a>: A scheduler that handles the mechanics of running a pipe, it can either run on a periodic schedule or on a schedule defined by a ‘cron’ expression. When the pump is scheduled to start, it will run its corresponding pipe.</p>
<p><a class="reference internal" href="concepts.html#concepts-sinks"><span class="std std-ref">Sinks</span></a>: Sinks are at the receiving end of pipes and are responsible for writing entities into an internal dataset or a target system.</p>
<p><a class="reference internal" href="concepts.html#concepts-sources"><span class="std std-ref">Sources</span></a>: A source is the system from where Sesam reads its data from. It can either be an external data source, which can be a SQL database, a CSV file, a XML file, JSON data, REST APIs or others. Or it can be an internal data source as a Sesam dataset.</p>
<p><a class="reference internal" href="concepts.html#concepts-systems"><span class="std std-ref">Systems</span></a>: A system component represents an external system that can provide data entities. The system is responsible for communicating with the external system and provide functionality so that data from the system can be read into Sesam.</p>
<p><a class="reference internal" href="concepts.html#concepts-transforms"><span class="std std-ref">Transformations</span></a>: These are described using the Data Transformation Language (DTL). Using data transformation, you can enrich or transform your data to construct new entities based on a source dataset.</p>
</div>
<div class="section" id="naming-conventions">
<span id="getting-started-naming-conventions"></span><h3>Naming conventions<a class="headerlink" href="#naming-conventions" title="Permalink to this headline">#</a></h3>
<p>To ensure we have a structured set of pipes that stay manageable in a bigger system we need to stick to a convention when naming them. Below is our recommended way of naming pipes.</p>
<div class="section" id="general-rules">
<h4>General rules<a class="headerlink" href="#general-rules" title="Permalink to this headline">#</a></h4>
<blockquote>
<div><ul class="simple">
<li><p>Lower case letters</p></li>
<li><p>Use dash <strong>-</strong> as delimiter</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="systems">
<h4>Systems<a class="headerlink" href="#systems" title="Permalink to this headline">#</a></h4>
<blockquote>
<div><ul class="simple">
<li><p>Name the system after the service you integrate with, not the technology used (e.g. <strong>salesforce</strong> instead of <strong>mysql</strong>).</p></li>
<li><p>If multiple systems are required to talk to a system, postfixc them with a qualifier (e.g. <strong>salesforce-out</strong>).</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="pipes">
<h4>Pipes<a class="headerlink" href="#pipes" title="Permalink to this headline">#</a></h4>
<blockquote>
<div><ul class="simple">
<li><p>Name inbound pipes with the system they read from, and postfix with the type of content (e.g. <strong>salesforce-sale</strong>).</p></li>
<li><p>Do not use plural names (e.g. <strong>crm-store</strong>, not <strong>crm-stores</strong>).</p></li>
<li><p>Prefix merge pipes with <strong>merged-</strong> (e.g. <strong>merged-person</strong>).</p></li>
<li><p>Prefix global pipes with <strong>global-</strong> (e.g. <strong>global-person</strong>).</p></li>
<li><p>Name intermediate outbound pipes with the type of the content and the name of the system to send to (e.g. <strong>sale-bigquery</strong>).</p></li>
<li><p>Name outgoing pipes by postfixing the intermediate output with <strong>-endpoint</strong> (e.g. <strong>sale-bigquery-endpoint</strong>).</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="datasets">
<h4>Datasets<a class="headerlink" href="#datasets" title="Permalink to this headline">#</a></h4>
<blockquote>
<div><ul class="simple">
<li><p>Name them the same as the pipe that produced it (the default).</p></li>
</ul>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="getting-started-pipes">
<span id="id2"></span><h2>Pipes<a class="headerlink" href="#getting-started-pipes" title="Permalink to this headline">#</a></h2>
<p>In this section we will go further into what pipes are, how they work and what we can do with them.</p>
<p>When we analyse the different data available to us, we discover many opportunities to use it and increase its value. For example, we might not have the need for all of it. Some of that data might be abundant due to multiple occurrences, i.e. the name of an employee occurring in several sources. Some data might have to be split up into different categories, i.e. the personal vs public information of an employee. In other instances we wish to display all the data about a specific object in one place, thus we need to join data from different sources, or enrich data either by adding new properties, or by adding properties existing in different datasets. The pipes are responsible for the transformation of the source data (either from one or several sources) from one setup to another, with the purpose of adding structure to the data. These pipes generate new datasets with new and transformed data ready to be used by other systems.</p>
<a class="reference internal image-reference" href="_images/pipe-struckture.png"><img alt="Generic pipe concept" class="align-center" src="_images/pipe-struckture.png" style="width: 800px;"/></a>
<p>As seen above a pipe in Sesam typically consists of five blocks and each block is available as a template to make writing pipes easier and quicker. For source and targets we can choose available systems and press replace to add values to pipe. Same with pump and transforms.</p>
<a class="reference internal image-reference" href="_images/templates.png"><img alt="Generic pipe concept" class="align-center" src="_images/templates.png" style="width: 800px;"/></a>
<p>The data is typically structured as a list of entities. An entity is a dictionary with key-value pairs and is identified through its ‘_id’ tag. This data might be a list of employees, with the ‘_id’ tag corresponding to their personal employee number.</p>
<p>For more details on how to use the templates when making a new pipe from scratch, please click <a class="reference internal" href="management-studio.html#management-studio-new-pipe"><span class="std std-ref">here</span></a>.</p>
<div class="section" id="basic-dtl-and-functions">
<span id="getting-started-basic-dtl-functions"></span><h3>Basic DTL and functions<a class="headerlink" href="#basic-dtl-and-functions" title="Permalink to this headline">#</a></h3>
<p>Sesam utilizes <a class="reference internal" href="concepts.html#concepts-dtl"><span class="std std-ref">DTL</span></a> (Data Transformation Language) which enables the user to easily apply logical operations on the data. In this section we will go through the most common functions available in DTL. For a more extensive walk-through, visit the <a class="reference internal" href="DTLReferenceGuide.html#dtlreferenceguide"><span class="std std-ref">DTL reference guide</span></a>.</p>
<p>DTL scripts are written inside the config tab when selecting a pipe in your Sesam node. The scripts consist of five sections:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>System</strong>: We initialize the DTL scripts in Sesam by specifying the <strong>_id</strong> and <strong>type</strong> of the script. The <strong>_id</strong> is the name of the script, and the type is simply just <strong>pipe</strong>.</p></li>
<li><p><strong>Provider</strong>: We need to tell DTL which source/sources to get the data from.</p></li>
<li><p><strong>Transform</strong>: Next we need to specify the rules with which we wish to transform the data.</p></li>
<li><p><strong>Pump</strong>: We need to add a pump in order to schedule the pumping of data from a source to a <strong>Sink</strong>.</p></li>
<li><p><strong>Sink</strong>: Finally we need to specify a <strong>Sink</strong> which writes the data to the target.</p></li>
</ul>
</div></blockquote>
<p>Next, let us briefly explain key-value pair. It is quite simply a property with a value. E.g.:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">"firstname":</span> <span class="pre">"Ole"</span></code></p>
</div></blockquote>
<a class="reference internal image-reference" href="_images/key_value_pair.png"><img alt="Generic pipe concept" class="align-center" src="_images/key_value_pair.png" style="width: 600px;"/></a>
</div>
<div class="section" id="lab-time">
<span id="getting-started-labtime-1"></span><h3>Lab time<a class="headerlink" href="#lab-time" title="Permalink to this headline">#</a></h3>
<p>Now that some basics of Sesam are established head over to the <a class="reference internal" href="#getting-started-labs"><span class="std std-ref">labs</span></a> and try your hand at the labs in the “Basics” and “Import data” sections.</p>
</div>
<div class="section" id="transformations">
<span id="getting-started-transformations"></span><h3>Transformations<a class="headerlink" href="#transformations" title="Permalink to this headline">#</a></h3>
<p>There are many different ways of transforming the source data. In this section will will encounter some of the more frequently used operations. For a full technical overview of the available operations visit the <a class="reference internal" href="DTLReferenceGuide.html#dtlreferenceguide"><span class="std std-ref">DTL reference guide</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"Type"</span><span class="p">,</span> <span class="s2">"customer"</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"Fullname"</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"concat"</span><span class="p">,</span><span class="s2">"_S.FirstName"</span><span class="p">,</span><span class="s2">" "</span><span class="p">,</span><span class="s2">"_S.LastName"</span><span class="p">]],</span>
            <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span><span class="s2">"Firstname-lower"</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"lower"</span><span class="p">,</span><span class="s2">"_S.FirstName"</span><span class="p">]],</span>
            <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"part-of-string"</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"substring"</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="s2">"_S.FirstName"</span><span class="p">]],</span>
            <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"fullname-lower-case"</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"concat"</span><span class="p">,</span><span class="s2">"_T.Firstname-lower"</span><span class="p">,</span><span class="s2">" "</span><span class="p">,</span><span class="s2">"_S.LastName"</span><span class="p">]],</span>
            <span class="p">[</span><span class="s2">"remove"</span><span class="p">,</span> <span class="s2">"Username"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>The above DTL snippet displays the <a class="reference internal" href="DTLReferenceGuide.html#dtl-transform-add"><span class="std std-ref">add</span></a> function as well as the  <a class="reference internal" href="DTLReferenceGuide.html#concat-dtl-function"><span class="std std-ref">concat</span></a>, <a class="reference internal" href="DTLReferenceGuide.html#lower-dtl-function"><span class="std std-ref">add</span></a>, <a class="reference internal" href="DTLReferenceGuide.html#substring-dtl-function"><span class="std std-ref">substring</span></a> and the <a class="reference internal" href="DTLReferenceGuide.html#dtl-transform-remove"><span class="std std-ref">remove</span></a> function inside the transform.</p>
<blockquote>
<div><ul class="simple">
<li><p>The first <code class="docutils literal notranslate"><span class="pre">["add"]</span></code>  creates a new property named <strong>“Type”</strong> that has the value <strong>“customer”</strong>.</p></li>
<li><p>The second <code class="docutils literal notranslate"><span class="pre">["add"]</span></code> creates a new property named <strong>“Fullname”</strong> which is constructed by using the function concatenate (<code class="docutils literal notranslate"><span class="pre">["concat"]</span></code>).</p></li>
<li><p>The third <code class="docutils literal notranslate"><span class="pre">["add"]</span></code> uses the function <code class="docutils literal notranslate"><span class="pre">["lower"]</span></code> to make all characters lower case.</p></li>
<li><p>The fourth <code class="docutils literal notranslate"><span class="pre">["add"]</span></code> uses the function <code class="docutils literal notranslate"><span class="pre">["substring"]</span></code> to make a substring of the <strong>“FirstName”</strong>.</p></li>
<li><p>The fifth <code class="docutils literal notranslate"><span class="pre">["add"]</span></code> uses the function``[“concat”]`` to combine the lower cased first name with the last name.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">["remove"]</span></code> function removes the selected property.</p></li>
</ul>
</div></blockquote>
<p>Notice the <code class="docutils literal notranslate"><span class="pre">["_S.[property1]"</span></code> and <code class="docutils literal notranslate"><span class="pre">["_T.[property2]"</span></code>. The <strong>_S</strong> and <strong>_T</strong> are called variables, and refer to the source and the target entity respectively.</p>
<div class="section" id="rules">
<h4>Rules<a class="headerlink" href="#rules" title="Permalink to this headline">#</a></h4>
<p>In each pipe there is one mandatory rule where most of functions to apply transforms to source data is added; <strong>“default”</strong>.The other rules can be applied via the <code class="docutils literal notranslate"><span class="pre">["apply"]</span></code>,  and <code class="docutils literal notranslate"><span class="pre">["apply-hops"]</span></code> DTL functions. This means that most of the logic applied to the entities of the source data, will be added inside <strong>“default”</strong>. That can be <code class="docutils literal notranslate"><span class="pre">["add"]</span></code>,  <code class="docutils literal notranslate"><span class="pre">["remove™]</span></code>, <code class="docutils literal notranslate"><span class="pre">["filter"]</span></code> and <code class="docutils literal notranslate"><span class="pre">["copy"]</span></code> to name a few examples.</p>
<p>It is important to remember the <em>order of the functions is significant</em>. This means Sesam can use output from a previous function (by using the variable <code class="docutils literal notranslate"><span class="pre">["_T"]</span></code> ) in a transform step further down within the default rule. The rules applied to the <code class="docutils literal notranslate"><span class="pre">["apply"]</span></code>  and <code class="docutils literal notranslate"><span class="pre">["apply-hops"]</span></code> , are stated outside the default rule, but within the curly brackets of <strong>{“rules”}</strong>.</p>
<p>Let us have a look at an example of a global pipe to try to highlight some of this:</p>
<p>As we can see in “default” several <code class="docutils literal notranslate"><span class="pre">["add"]</span></code> have been listed. When adding “fullname” The order is important as this is based on “firstname” and “lastname” which was already added. Also <code class="docutils literal notranslate"><span class="pre">["filter"]</span></code> used for <strong>“consents”</strong> which is added straight after <strong>“consents”</strong> was added via <code class="docutils literal notranslate"><span class="pre">["hops"]</span></code> function. Filters are often added at the start of “default rule”, e.g. if you only want to process entities that meet certain requirements. And in some cases at the end of the “default rule” as in this example the filter checks if “consents” contain data, in which case the entity is included in further processing.</p>
<p>In our example we have one rule in addition to the “default rule”. As we can see it is the rule is called <strong>“location”</strong> which is called on by <code class="docutils literal notranslate"><span class="pre">["apply-hops"]</span></code> in the default rule. This rule specifies what output is to be returned. In this case “kommunenavn” and “poststed” is copied from “global-location”.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"global-person"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"merge"</span><span class="p">,</span>
    <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"erp-person ep"</span><span class="p">,</span> <span class="s2">"greg-crm-person gcp"</span><span class="p">,</span> <span class="s2">"hr-person hp"</span><span class="p">,</span> <span class="s2">"salesforce-userprofile sup"</span><span class="p">],</span>
    <span class="s2">"equality"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"gcp.SSN"</span><span class="p">,</span> <span class="s2">"ep.SSN"</span><span class="p">],</span>
      <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"gcp.SSN"</span><span class="p">,</span> <span class="s2">"hp.SSN"</span><span class="p">],</span>
      <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"gcp.EmailAddress"</span><span class="p">,</span> <span class="s2">"sup.EmailAddress"</span><span class="p">]],</span>
    <span class="s2">"identity"</span><span class="p">:</span> <span class="s2">"first"</span><span class="p">,</span>
    <span class="s2">"strategy"</span><span class="p">:</span> <span class="s2">"default"</span><span class="p">,</span>
    <span class="s2">"version"</span><span class="p">:</span> <span class="mi">2</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">[{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.hr-person:ZipCode"</span><span class="p">,</span> <span class="s2">"_S.greg-crm-person:PostalCode"</span><span class="p">,</span> <span class="s2">"_S.erp-person:ZipCode"</span><span class="p">]]],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"email"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span> <span class="s2">"_S.EmailAddress"</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"firstname"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.erp-person:Firstname"</span><span class="p">,</span> <span class="s2">"_S.hr-person:GivenName"</span><span class="p">,</span> <span class="s2">"_S.greg-crm-person:FirstName"</span><span class="p">]]],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"lastname"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.erp-person:Lastname"</span><span class="p">,</span> <span class="s2">"_S.greg-crm-person:LastName"</span><span class="p">,</span> <span class="s2">"_S.hr-person:Surname"</span><span class="p">]]],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"fullname"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"concat"</span><span class="p">,</span> <span class="s2">"_T.firstname"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">,</span> <span class="s2">"_S.erp-person:MiddleInitial"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">,</span> <span class="s2">"_T.lastname"</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"active-subscriptions"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"apply"</span><span class="p">,</span> <span class="s2">"filter-subscriptions"</span><span class="p">,</span> <span class="s2">"_S.erp-person:subscriptions"</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"consents"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"hops"</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"global-consent gc"</span><span class="p">],</span>
            <span class="s2">"where"</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.salesforce-userprofile:Username"</span><span class="p">,</span> <span class="s2">"gc.Username"</span><span class="p">]],</span>
            <span class="s2">"return"</span><span class="p">:</span> <span class="s2">"gc.title"</span>
          <span class="p">}]],</span>
        <span class="p">[</span><span class="s2">"filter"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"is-not-empty"</span><span class="p">,</span> <span class="s2">"_T.consents"</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">"merge"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"apply-hops"</span><span class="p">,</span> <span class="s2">"location"</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"global-location gl"</span><span class="p">],</span>
            <span class="s2">"where"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.ZipCode"</span><span class="p">,</span> <span class="s2">"gl.postnummer"</span><span class="p">]</span>
          <span class="p">}]],</span>
      <span class="s2">"location"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"kommunenavn"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"poststed"</span><span class="p">]]</span>
    <span class="p">}</span>
  <span class="p">}],</span>
  <span class="s2">"metadata"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"global"</span><span class="p">:</span> <span class="n">true</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="merging-sources">
<span id="getting-started-merging-sources"></span><h4>Merging sources<a class="headerlink" href="#merging-sources" title="Permalink to this headline">#</a></h4>
<p>Merging gives us an aggregated representation of two or more datasets​​. We can create an aggregated dataset source that contains all the data from multiple datasets by using the source type “merge”. With this merge type we will join datasets through properties that have corresponding values across different datasets. The resulting aggregated dataset will contain entities with all the properties from the different datasets.</p>
<a class="reference internal image-reference" href="_images/db-table-after-merge.png"><img alt="Generic pipe concept" class="align-center" src="_images/db-table-after-merge.png" style="width: 800px;"/></a>
<p>When merging datasets we need to combine entities through identical values across datasets. In the image above we merge datasets A and B through their “lastname” properties, and B and C through their “email” properties. As we can see, the resulting dataset will have “null” values in the fields that cannot be populated through entities with matching values.</p>
<p>This way you can for example, combine a customer dataset with another customer dataset through the <strong>“lastname”</strong> property and work with an entity that contains more customer info. In the configuration below we have given the datasets <strong>aliases</strong> in the source config. This is for easy referencing later in the source configuration. We see the alisases
here:</p>
<p><strong>[“customerA a”, “customerB b”]</strong></p>
<p>In the equality rule we simply put <strong>“a.lastname” and “b.lastname”</strong> to specify which dataset and which key we use. IF we were not using aliases, it would look like this <strong>“customerA.lastname”, “customerB.lastname”</strong> so aliases make it easier and tidier to write DTL.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"merge"</span><span class="p">,</span>
    <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"customerA a"</span><span class="p">,</span> <span class="s2">"customerB b"</span><span class="p">],</span>
    <span class="s2">"equality"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"a.lastname"</span><span class="p">,</span> <span class="s2">"b.lastname"</span><span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">"identity"</span><span class="p">:</span> <span class="s2">"first"</span><span class="p">,</span>
    <span class="s2">"version"</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the <a class="reference internal" href="DTLReferenceGuide.html#eq-dtl-function"><span class="std std-ref">equality</span></a> property of the source we set the joining condition for the merge. The join expression <strong>[“eq”, “a.lastname”, “b.lastname”]</strong> will combine entities where the lastname from <strong>”customer A”</strong> matches the <strong>”lastname”</strong> from <strong>“customer B”</strong> . Our source dataset will after the merge contain entities with data from both the customers.</p>
<p>The <strong>“identity”</strong> property specifies the ID of the resulting entity. Set to <strong>“first”</strong> it will use a single ID value from one dataset. This ID will be copied from the first dataset that contains one, in the order that the datasets are listed in the <strong>“source”</strong> property. Set to <strong>“composite”</strong> it will instead make a custom id composed of all the different IDs in the datasets.</p>
<p>The <strong>”version”</strong> property refers to the version of the merge source. The default value is 1, but version 1 is deprecated. Set this to <strong>2</strong>.</p>
</div>
<div class="section" id="coalesce-list-and-other-useful-dtl-functions">
<h4>Coalesce, list and other useful DTL functions<a class="headerlink" href="#coalesce-list-and-other-useful-dtl-functions" title="Permalink to this headline">#</a></h4>
<p><strong>“Coalesce”</strong> means to join or combine. In SQL it is commonly used together with <code class="docutils literal notranslate"><span class="pre">["is-null"]</span></code> to return the first non-null value in a list. In DTL, when we need to prioritize which keys we want to use to pick a value, we use <strong>“Coalesce”</strong>. So, when is this useful and how is it used?</p>
<p>Say we want to add a property or a key called “lastname”. This key-value is found in three different systems. We want to make sure we use the most trusted value, we use <code class="docutils literal notranslate"><span class="pre">["Coalesce"]</span></code> to state the order which Sesam checks for values. If the hr-person “lastname” is null, <code class="docutils literal notranslate"><span class="pre">["Coalesce"]</span></code> gives us the opportunity to choose which is the next best option.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">"comment"</span><span class="p">,</span> <span class="s2">"Below code will first check "</span><span class="n">lastname</span><span class="s2">" in hr-person</span>
            <span class="n">dataset</span> <span class="p">,</span><span class="k">if</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">null</span> <span class="n">then</span> <span class="n">it</span> <span class="n">goes</span> <span class="n">to</span> <span class="n">crm</span><span class="o">-</span><span class="n">person</span> <span class="n">dataset</span> <span class="ow">and</span> <span class="n">so</span>
            <span class="n">on</span><span class="o">.</span> <span class="n">basically</span><span class="p">,</span> <span class="n">we</span> <span class="n">prioritize</span> <span class="n">the</span> <span class="n">order</span> <span class="n">on</span> <span class="n">most</span> <span class="n">trusted</span> <span class="n">values</span><span class="s2">"],</span>
            <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.hr-person:lastname"</span><span class="p">,</span>
                <span class="s2">"_S.crm-person:name"</span><span class="p">,</span> <span class="s2">"_S.erp-person:surname"</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">["Coalesce"]</span></code> is used together with <code class="docutils literal notranslate"><span class="pre">["list"]</span></code> function, which basically is a list of values. We need <code class="docutils literal notranslate"><span class="pre">["list"]</span></code>  to list the order of which keys to pick values from.</p>
<p>If you need a list of key-value pairs, in other words a list of properties <em>and</em> values, you need to make a dictionary using the <code class="docutils literal notranslate"><span class="pre">["dict"]</span></code>  function.</p>
<p>To illustrate the difference let us look at some DTL in a pipe</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"global-person"</span><span class="p">,</span>
<span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
<span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">"type"</span><span class="p">:</span> <span class="s2">"merge"</span><span class="p">,</span>
<span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"erp-person ep"</span><span class="p">,</span> <span class="s2">"crm-person cp"</span><span class="p">,</span> <span class="s2">"salesforce-userprofile su"</span><span class="p">,</span> <span class="s2">"hr-person hr"</span><span class="p">],</span>
<span class="s2">"equality"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"ep.SSN"</span><span class="p">,</span> <span class="s2">"cp.SSN"</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"ep.SSN"</span><span class="p">,</span> <span class="s2">"hr.SSN"</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"ep.Username"</span><span class="p">,</span> <span class="s2">"su.Username"</span><span class="p">]</span>
  <span class="p">],</span>
  <span class="s2">"identity"</span><span class="p">:</span> <span class="s2">"first"</span><span class="p">,</span>
  <span class="s2">"version"</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">},</span>
<span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
  <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
      <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"firstname"</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.crm-person:FirstName"</span><span class="p">,</span> <span class="s2">"_S.erp-person:Firstname"</span><span class="p">,</span> <span class="s2">"_S.hr-person:GivenName"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"lastname"</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.crm-person:LastName"</span><span class="p">,</span> <span class="s2">"_S.erp-person:Lastname"</span><span class="p">,</span> <span class="s2">"_S.hr-person:Surname"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">],</span>
<span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"fields"</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">"dict"</span><span class="p">,</span> <span class="s2">"SSN"</span><span class="p">,</span> <span class="s2">"_S.ssn"</span><span class="p">,</span> <span class="s2">"contact"</span><span class="p">,</span> <span class="s2">"_S.emailaddress"</span><span class="p">,</span>
<span class="s2">"Origin"</span><span class="p">,</span> <span class="s2">"_S.birth_place "</span><span class="p">]</span>
      <span class="p">]</span>
</pre></div>
</div>
<p>As seen in pipe above, the dictionary contains key and where to access value i.e. <strong>[“dict”,”SSN”, “_S.ssn”].</strong> A list could be a list of items separated by commas i.e.  <strong>[“list”,”_S.crm-person:FirstName”, “_S.erp-person:Firstname”, “_S.hr-person:GivenName”].</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">["if"]</span></code>  condition is a function in DTL that works by evaluating a statement and by performing different actions depending on the outcome of the evaluation.</p>
<p>In everyday life we might say “if you’re 50 years old or older, then you’re entitled to a longer vacation”. If not, then you have the standard number of weeks set aside for vacation.</p>
<p>In DTL this would be utilized in the following way:</p>
<p>First we need to be able to assort the different people into two separate groups, e.g. group_1 is the group containing people with normal vacation (under 50 years of age) and group_2 is the group with people with extended vacation. Now let’s assume that every person has an attribute named “age”. Assuming that the person entity is the source entity we could define our evaluating statement as the following: [“gte”, “_S.age”, “50”], which will be true if the person is 50 years old or older, and false otherwise. We use the <code class="docutils literal notranslate"><span class="pre">["gte"]</span></code>  function which is used to get values greater than or equal to. In comparison <code class="docutils literal notranslate"><span class="pre">["gt"]</span></code>  simply means greater than. Now we can construct our complete if-statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">"if"</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">"gte"</span><span class="p">,</span> <span class="s2">"_S.age"</span><span class="p">,</span> <span class="s2">"50"</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"age_group"</span><span class="p">,</span> <span class="s2">"group_1"</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"age_group"</span><span class="p">,</span> <span class="s2">"group_2"</span><span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>The third line is activated if the statement is true, and the fourth line if the statement is false.</p>
<p>Another handy function is <code class="docutils literal notranslate"><span class="pre">["return"]</span></code>  which allows us to specify which values we want returned from source when doing hops. Please see code example below</p>
<p>Config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"FirstName"</span><span class="p">,</span>
  <span class="p">[</span><span class="s2">"first"</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">"hops"</span><span class="p">,</span> <span class="p">{</span>
      <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"users u"</span><span class="p">],</span>
      <span class="s2">"where"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.Username"</span><span class="p">,</span> <span class="s2">"u.Username"</span><span class="p">]</span>

      <span class="s2">"return"</span><span class="p">:</span> <span class="s2">"u.FirstName"</span>
    <span class="p">}]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This example will make a hops to the ‘users’ dataset based on the Username properties, and if a match is found, return the value of the ‘FirstName’ property. If the value of that property is ‘John’, the resulting output would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"FirstName"</span><span class="p">:</span> <span class="s2">"John"</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">["Tuples"]</span></code> is mainly used when we need to make several equalities between two datasets in one hops. Let us say you have two properties in dataset A that will match two properties in dataset B, it will be done as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span>
  <span class="p">[</span><span class="s2">"tuples"</span><span class="p">,</span> <span class="s2">"A.prop1"</span><span class="p">,</span> <span class="s2">"A.prop2"</span><span class="p">],</span>
  <span class="p">[</span><span class="s2">"tuples"</span><span class="p">,</span> <span class="s2">"B.prop1"</span><span class="p">,</span> <span class="s2">"B.prop2"</span><span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<p><strong>Filters</strong> they can be used in many contexts, but one typical case we use <code class="docutils literal notranslate"><span class="pre">["filter"]</span></code>  for is on out from globals to filter in correct entities (typically on rdf: type) to be processed further.</p>
<p>When we need to filter data, there is a <code class="docutils literal notranslate"><span class="pre">["filter"]</span></code> function. This can be used in several ways and in various combinations with other functions. Below are some examples:</p>
<ul class="simple">
<li><p>To stop processing, simply use <code class="docutils literal notranslate"><span class="pre">["filter"]</span></code></p></li>
<li><p>Continue processing only if the source entity’s age is greater than say 42, use  <code class="docutils literal notranslate"><span class="pre">["filter",</span> <span class="pre">["gt",</span> <span class="pre">"_S.age",</span> <span class="pre">42]]</span></code></p></li>
<li><p>Continue processing only if the source entity’s doctype is report, use <code class="docutils literal notranslate"><span class="pre">["filter",</span> <span class="pre">["eq",</span> <span class="pre">"_S.doctype",</span> <span class="pre">"report"]]</span></code></p></li>
<li><p>If you wish to process only if doctype <em>isn’t</em> report, then use <code class="docutils literal notranslate"><span class="pre">[["filter",</span> <span class="pre">["neq",</span> <span class="pre">"_S.doctype",</span> <span class="pre">"report"]]</span></code></p></li>
<li><p>If you have more than one type, continues processing if source entity has doctypes either report, letter or budget, you can combine with <code class="docutils literal notranslate"><span class="pre">["or"]</span></code></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">"filter"</span><span class="p">,</span>
         <span class="p">[</span><span class="s2">"or"</span><span class="p">,</span>
           <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.doctype"</span><span class="p">,</span> <span class="s2">"report"</span><span class="p">],</span>
           <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.doctype"</span><span class="p">,</span> <span class="s2">"letter"</span><span class="p">],</span>
           <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.doctype"</span><span class="p">,</span> <span class="s2">"budget"</span><span class="p">]</span>
</pre></div>
</div>
<p>If we don’t need exact match, we can use <code class="docutils literal notranslate"><span class="pre">["intersects"]</span></code> instead; it will continue  to process if we get overlap.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">"filter"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"intersects"</span><span class="p">,</span> <span class="s2">"_S.doctype"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"report"</span><span class="p">,</span> <span class="s2">"letter"</span><span class="p">,</span> <span class="s2">"budget"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="global-datasets">
<h4>Global datasets<a class="headerlink" href="#global-datasets" title="Permalink to this headline">#</a></h4>
<p>Global datasets are key to getting the most out of using Sesam. We combine data from sources with logically linked information to provide one common place to then retrieve this data from when needed. This will reduce the total number of pipes needed compared to a system where you get data from the original sources each time.
You can read more about global datasets; what they are, how to use them and how to develop them <a class="reference internal" href="data-modelling.html#best-practice-global"><span class="std std-ref">here</span></a>.</p>
</div>
<div class="section" id="namespace-identifiers">
<h4>Namespace identifiers<a class="headerlink" href="#namespace-identifiers" title="Permalink to this headline">#</a></h4>
<p>A namespaced identifier consists of two parts; a namespace and an identifier. The namespace part can consist of any character, including colons. The identifier part can consist of any character except colons (:).</p>
<p>Example of an entity with namespaces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"users:123"</span><span class="p">,</span>
<span class="s2">"user:username"</span><span class="p">:</span> <span class="s2">"erica"</span><span class="p">,</span>
<span class="s2">"user:firstname"</span><span class="p">:</span> <span class="s2">"Erica"</span><span class="p">,</span>
<span class="s2">"user:manager"</span><span class="p">:</span> <span class="s2">"~:users:101"</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Namespace identifiers are recommended way for referring datasets for matching properties during transformations. Suppose, if you have three different person datasets and you want to merge on some common properties, like e-mail or SSN, then we should use namespace identifiers. The code below will add a namespace identifier, based on common SSN properties between datasets <strong>“crm-person”</strong> and <strong>“erp-person”</strong> during transformation inside DTL of <strong>“crm-person”</strong>. Same way, we need to create a namespace identifier between <strong>“hr-person”</strong> and <strong>“erp-person”</strong> datasets so that we can refer them during merging.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">"make-ni"</span><span class="p">,</span> <span class="s2">"erp-person"</span><span class="p">,</span> <span class="s2">"SSN"</span><span class="p">],</span>
</pre></div>
</div>
<p>This will produce the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"crm-person:SSN-ni"</span><span class="p">:</span> <span class="s2">"~:erp-person:23072451376"</span><span class="p">,</span>
</pre></div>
</div>
<p>Now, you have unique namespace identifiers based on SSN, which you can refer now.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"global-person"</span><span class="p">,</span>
 <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
 <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"merge"</span><span class="p">,</span>
     <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"crm-person cp"</span><span class="p">,</span> <span class="s2">"hr-person hp"</span><span class="p">,</span> <span class="s2">"erp-person ep"</span><span class="p">],</span>
     <span class="s2">"equality"</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"cp.SSN-ni"</span><span class="p">,</span> <span class="s2">"ep.$ids"</span><span class="p">],</span>
         <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"hp.SSN-ni"</span><span class="p">,</span> <span class="s2">"ep.$ids"</span><span class="p">]</span>
     <span class="p">],</span>
     <span class="s2">"identity"</span><span class="p">:</span> <span class="s2">"first"</span><span class="p">,</span>
     <span class="s2">"version"</span><span class="p">:</span> <span class="mi">2</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>In the above code we are connecting the foreign keys, <strong>“SSN-ni”</strong> of <strong>“hr-person”</strong> and <strong>“crm-person”</strong> with the primary key, <strong>“$ids”</strong>, of <strong>“erp-person”</strong>. You do not need to add the third equality between <strong>“hr-person”</strong> and <strong>“crm-person”</strong> as it will happen automatically.</p>
</div>
<div class="section" id="merging-with-dtl">
<h4>Merging with DTL<a class="headerlink" href="#merging-with-dtl" title="Permalink to this headline">#</a></h4>
<p>We can merge entities in the DTL transform section with the <a class="reference internal" href="DTLReferenceGuide.html#dtl-transform-merge"><span class="std std-ref">merge</span></a> function. This will combine its input properties (for example Age, CellNumber and salary) into the target dataset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">"merge"</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="p">{</span>
        <span class="s2">"Age"</span><span class="p">:</span> <span class="mi">40</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="s2">"CellNumber"</span><span class="p">:</span> <span class="mi">7854216</span><span class="p">,</span>
        <span class="s2">"Salary"</span><span class="p">:</span> <span class="mi">400000</span>
    <span class="p">}]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>We will later see the use of the <code class="docutils literal notranslate"><span class="pre">["merge"]</span></code> function in combination with functions that fetch entities from other datasets.</p>
</div>
<div class="section" id="apply">
<h4>Apply<a class="headerlink" href="#apply" title="Permalink to this headline">#</a></h4>
<p>The <a class="reference internal" href="DTLReferenceGuide.html#apply-dtl-function"><span class="std std-ref">apply</span></a> operation applies an own-specified rule to an entity. I.e. the call [“apply”, “SomeRule”, “_S.orders”] applied the rule “SomeFunc” to the source “_S.orders”.</p>
</div>
<div class="section" id="hops">
<h4>Hops<a class="headerlink" href="#hops" title="Permalink to this headline">#</a></h4>
<p>The <a class="reference internal" href="DTLReferenceGuide.html#hops-dtl-function"><span class="std std-ref">hops</span></a> function joins two datasets and returns the entities where the specified parameters match:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>"transform": {​
     "type": "dtl",​
      "rules": {​
          "default": [​
              ["copy", "*"],​
              ["add", "order-data"​,
                  ["hops", {​
                      "datasets": ["global-orders glo"],​
                      "where": [​
                          ["eq", "_S.custno", "glo.custno"]​
                      ]​
                  }
              ]​
           ]​
       }
   }
</pre></div>
</div>
<p>In this transform we first copy everything from the source dataset into the target. To do a <code class="docutils literal notranslate"><span class="pre">["hops"]</span></code>  you first add a new property to the target dataset. Then, inside that <code class="docutils literal notranslate"><span class="pre">["add"]</span></code>  you call on the <code class="docutils literal notranslate"><span class="pre">["hops"]</span></code>  function to fetch entities from the specified dataset, in this example (<strong>“global-orders”</strong>).</p>
</div>
<div class="section" id="apply-hops">
<h4>Apply-hops<a class="headerlink" href="#apply-hops" title="Permalink to this headline">#</a></h4>
<p>There is also the function <a class="reference internal" href="DTLReferenceGuide.html#apply-hops-dtl-function"><span class="std std-ref">apply-hops</span></a>, which is a combined <code class="docutils literal notranslate"><span class="pre">["apply"]</span></code>  and <code class="docutils literal notranslate"><span class="pre">["hops"]</span></code>  function. This adds another <strong>“rule”</strong> in the DTL configuration in which we can specify how to implement the entities fetched with the hops. You can read more about the <code class="docutils literal notranslate"><span class="pre">["apply"]</span></code>  function <a class="reference internal" href="DTLReferenceGuide.html#hops-dtl-function"><span class="std std-ref">here</span></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">"merge"</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"apply-hops"</span><span class="p">,</span> <span class="s2">"order"</span><span class="p">,</span> <span class="p">{</span>
                    <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"orders o"</span><span class="p">],</span>
                    <span class="s2">"where"</span><span class="p">:</span>
                    <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S._id"</span><span class="p">,</span> <span class="s2">"o.cust_id"</span><span class="p">]</span>
                <span class="p">}]</span>
            <span class="p">]</span>
        <span class="p">],</span>
        <span class="s2">"order"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span><span class="s2">"ID"</span><span class="p">,</span><span class="s2">"_S._id"</span><span class="p">]</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This will retrieve orders through the hops expression and then add them using the order transformation rule. The output is a dataset where the ID of all orders are added to the customers from the source dataset.</p>
</div>
<div class="section" id="should-i-add-or-merge-an-apply-hops">
<h4>Should I “add” or “merge” an apply-hops?<a class="headerlink" href="#should-i-add-or-merge-an-apply-hops" title="Permalink to this headline">#</a></h4>
<p>As you can see in the examples below we want to add the “City” and “Municipality” from another dataset to the source. In the two examples we have the same source but the difference is in how we use the <code class="docutils literal notranslate"><span class="pre">["apply-hops"]</span></code> . In the first case we <code class="docutils literal notranslate"><span class="pre">["add"]</span></code>  a new property called “difi-data” which you can see in the results creates a dictionary containing “City” and “Municipality” in <strong>“difi-data”</strong>.</p>
<blockquote>
<div><p>When adding “City” and “Municipality” from another dataset we need to specify which <em>sources</em> and <em>entities</em> we want to match on. This is done by adding <code class="docutils literal notranslate"><span class="pre">["_S"]</span></code>  in front of name of dataset and entity.  It looks like this: <strong>_S.hr-person:ZipCode</strong></p>
<blockquote>
<div><p><strong>“_S”</strong> is a built-in variable in <strong>DTL</strong>. Read more about Variables <a class="reference internal" href="DTLReferenceGuide.html#variables"><span class="std std-ref">here</span></a>.</p>
</div></blockquote>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
   <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
       <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
           <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
           <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span><span class="s2">"difi-data"</span><span class="p">,</span>
               <span class="p">[</span><span class="s2">"apply-hops"</span><span class="p">,</span> <span class="s2">"foobar"</span><span class="p">,</span> <span class="p">{</span>
                   <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"difi-postnummer dip"</span><span class="p">],</span>
                   <span class="s2">"where"</span><span class="p">:</span> <span class="p">[</span>
                       <span class="p">[</span><span class="s2">"or"</span><span class="p">,</span>
                           <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.hr-person:ZipCode"</span><span class="p">,</span> <span class="s2">"dip.postnummer"</span><span class="p">],</span>
                           <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.crm-person:PostalCode"</span><span class="p">,</span> <span class="s2">"dip.postnummer"</span><span class="p">]</span>
                       <span class="p">]</span>
                   <span class="p">]</span>
               <span class="p">}]</span>
           <span class="p">],</span>
           <span class="p">[</span><span class="s2">"comment"</span><span class="p">,</span> <span class="s2">"Below code will first check zipcode in hr-person</span>
           <span class="n">dataset</span><span class="p">,</span> <span class="k">if</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">null</span> <span class="n">then</span> <span class="n">it</span> <span class="n">goes</span> <span class="n">to</span> <span class="n">crm</span><span class="o">-</span><span class="n">person</span> <span class="n">dataset</span> <span class="ow">and</span> <span class="n">so</span> <span class="n">on</span><span class="o">.</span>
           <span class="n">Basically</span> <span class="n">we</span> <span class="n">prioritize</span> <span class="n">the</span> <span class="n">order</span> <span class="n">on</span> <span class="n">most</span> <span class="n">trusted</span> <span class="n">values</span><span class="s2">"],</span>
           <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">,</span>
               <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
                   <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.hr-person:ZipCode"</span><span class="p">,</span> <span class="s2">"_S.crm-person:PostalCode"</span><span class="p">,</span>
                   <span class="s2">"_S.erp-person:ZipCode"</span><span class="p">]</span>
               <span class="p">]</span>
           <span class="p">]</span>
       <span class="p">],</span>
       <span class="s2">"foobar"</span><span class="p">:</span> <span class="p">[</span>
           <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"Municipality"</span><span class="p">,</span> <span class="s2">"_S.kommunenavn"</span><span class="p">],</span>
           <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"City"</span><span class="p">,</span> <span class="s2">"_S.poststed"</span><span class="p">]</span>
       <span class="p">]</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/add_applyhops.png"><img alt="Generic pipe concept" class="align-center" src="_images/add_applyhops.png" style="width: 800px;"/></a>
<p>In the second example, instead of adding the <code class="docutils literal notranslate"><span class="pre">["apply-hops"]</span></code> , we use <code class="docutils literal notranslate"><span class="pre">["merge"]</span></code> . This will add the “City” and “Municipality” as properties in the target.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
     <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
             <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
             <span class="p">[</span><span class="s2">"merge"</span><span class="p">,</span>
                 <span class="p">[</span><span class="s2">"apply-hops"</span><span class="p">,</span> <span class="s2">"foobar"</span><span class="p">,</span> <span class="p">{</span>
                     <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"difi-postnummer dip"</span><span class="p">],</span>
                     <span class="s2">"where"</span><span class="p">:</span> <span class="p">[</span>
                         <span class="p">[</span><span class="s2">"or"</span><span class="p">,</span>
                             <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.hr-person:ZipCode"</span><span class="p">,</span> <span class="s2">"dip.postnummer"</span><span class="p">],</span>
                             <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.crm-person:PostalCode"</span><span class="p">,</span> <span class="s2">"dip.postnummer"</span><span class="p">]</span>
                         <span class="p">]</span>
                     <span class="p">]</span>
                 <span class="p">}]</span>
             <span class="p">],</span>
             <span class="p">[</span><span class="s2">"comment"</span><span class="p">,</span> <span class="s2">"Below code will first check zipcode in hr-person</span>
             <span class="n">dataset</span> <span class="p">,</span><span class="k">if</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">null</span> <span class="n">then</span> <span class="n">it</span> <span class="n">goes</span> <span class="n">to</span> <span class="n">crm</span><span class="o">-</span><span class="n">person</span> <span class="n">dataset</span> <span class="ow">and</span> <span class="n">so</span>
             <span class="n">on</span><span class="o">.</span> <span class="n">basically</span><span class="p">,</span> <span class="n">we</span> <span class="n">prioritize</span> <span class="n">the</span> <span class="n">order</span> <span class="n">on</span> <span class="n">most</span> <span class="n">trusted</span> <span class="n">values</span><span class="s2">"],</span>
             <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">,</span>
                 <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.hr-person:ZipCode"</span><span class="p">,</span>
                 <span class="s2">"_S.crm-person:PostalCode"</span><span class="p">,</span> <span class="s2">"_S.erp-person:ZipCode"</span><span class="p">]</span>
             <span class="p">]</span>
         <span class="p">]</span>
     <span class="p">],</span>
     <span class="s2">"foobar"</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"Municipality"</span><span class="p">,</span> <span class="s2">"_S.kommunenavn"</span><span class="p">],</span>
         <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"City"</span><span class="p">,</span> <span class="s2">"_S.poststed"</span><span class="p">]</span>
     <span class="p">]</span>
 <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/merge_applyhops.png"><img alt="Generic pipe concept" class="align-center" src="_images/merge_applyhops.png" style="width: 800px;"/></a>
</div>
</div>
<div class="section" id="getting-started-labtime-2">
<span id="id3"></span><h3>Lab time<a class="headerlink" href="#getting-started-labtime-2" title="Permalink to this headline">#</a></h3>
<p>Now that we are more familier with transforming data with DTL it’s time to go to the labs section again and try doing the labs under <a class="reference internal" href="#getting-started-labs-data-modelling"><span class="std std-ref">Data modelling</span></a>. Save the last one of the data modelling labs until you have read the next section of this guide below regarding dependency-tracking and resets.</p>
</div>
<div class="section" id="dependency-tracking-and-resetting-a-pipe">
<span id="getting-started-dependency-tracking-and-resetting-a-pipe"></span><h3>Dependency-tracking and resetting a pipe<a class="headerlink" href="#dependency-tracking-and-resetting-a-pipe" title="Permalink to this headline">#</a></h3>
<p>in the labs we have now started to create dependencies between datasets through hops. In the node config provided for this guide there is also a pipe named <strong>person-address-csv</strong> which uses <strong>global-person</strong> as its source dataset. In its DTL transform there is a hops to <strong>global-location</strong>. This means that entities from <strong>person-address-csv</strong> should change when the data in the source dataset <strong>global-person</strong> changes, in addition to when the relevant data in <strong>global-location</strong> changes. We could of course check through every entity in global-location for changes, but this would also mean we need to reprocess every entity in the source datasets to check for changes when they connect to global-location.</p>
<p>In order to make sure that only entities that have changed since the last time the integration ran are updated, Sesam utilizes <strong>“dependency tracking”</strong>. <strong>Dependency tracking</strong> ensures that Sesam recognizes changes in connected data, and not only changes in the pipe’s sources, and acts accordingly. For further information regarding dependency tracking visit the <a class="reference internal" href="concepts.html#concepts-dependency-tracking"><span class="std std-ref">Concepts-section</span></a> of the Developer Guide.</p>
<p>We will try to explain the workings of dependency tracking with a different example, and then apply this information in <a class="reference internal" href="#getting-started-labs-22"><span class="std std-ref">lab 22</span></a>.</p>
<p>Let us assume you have a dataset in your Sesam node concerning all the employees in a company. This dataset may contain information regarding the employee’s names, employee numbers, age, length of employment and so on. In another dataset you have information regarding which projects the employees have worked on as well as the employee number. You now wish to combine these datasets to generate a new dataset that includes both the employees name, employee number and the different projects this employee has worked on. This could be done using the <a class="reference internal" href="DTLReferenceGuide.html#hops-dtl-function"><span class="std std-ref">hops</span></a> function.</p>
<p>If we start with the dataset containing employee information, we may combine the data from the employee dataset with the project dataset based on matching employee numbers. Should an employee change their name, Sesam will pick up a change in the source entity and reprocess that entity to update the results. However, the project dataset is not the source in this case, but registering the changes in this dataset is just as vital as registering changes in the source dataset, as they both combine to make the resulting dataset in this use-case. This is where dependency tracking comes into play.</p>
<p>Dependency tracking tracks all the data this pipe, as well as the dataset it is connected to, such that changes to data outside the source dataset are registered and reprocessed in the pipe.</p>
<p>So far in the labs we have only covered changes outside the pipe we are working on. But, what about changes in the pipe itself? If we add lines in our DTL config, how does Sesam know that the entities should be reprocessed? The source or the dependent data has no changes, and therefore no entities will be reprocessed as Sesam thinks nothing has changed. In short, Sesam does not recognize this automatically. Entities are only reprocessed in Sesam if there are changes in the data coming into the pipe. This means that if we make changes to a Sesam pipe, only changed or new data will be populated with the extra information, the entities that has already been processed will not by themselves be reprocessed.</p>
<p>To remedy this, every time we make changes in a pipe that will affect the output data, and if we want all old entities to have that extra information, we must manually <strong>reset</strong> and <strong>start</strong> the pipe. When we reset a pipe, all the entities from the source will be reprocessed. This can be done by clicking on the three dots next to the pipe name at the top of your pipe.</p>
<a class="reference internal image-reference" href="_images/pipesmenu.png"><img alt="DataSet" class="align-center" src="_images/pipesmenu.png" style="width: 600px;"/></a>
<p>Some of the alternatives presented are <strong>“Restart”</strong>, <strong>“Start”</strong> and <strong>“Reset”</strong>. <strong>“Restart”</strong> is simply a combination of <strong>“Reset”</strong> followed by <strong>“Start”</strong>. This will send all the entities from the source dataset through the pipe and populate them with the extra data you have specified through your DTL config.</p>
<p>In many cases, we do not wish to reprocess all the entities, but only some of the them. E.g. imagine you have a dataset of 5 million entities, tracing back many years. In your DTL config, you have added logic that yields extra data if the entities are two months old or newer. Reprocessing entities older than two month makes no sense now, since they will not be populated with the new data either way. In these situations, press <strong>“…”</strong> at end of pipe name and on the menu choose <strong>“Update last seen”</strong> . In this case, we choose which entities should be reprocessed, which greatly decreases the computational time.</p>
<p>Similarly, imagine you work on a global pipe which merges data from 3 different sources. Two of these sources contain millions of entities, and one only a few. Let’s say you wish to change the output containing data from the source with only a few entities. Resetting the whole pipe in this case is unnecessary since we only need to reprocess a few entities, The <strong>Update last seen</strong> option also supports resetting the data from several sources at different times, thus if you need to reprocess the entities from the “small” dataset, you may do so without sending through all the other million entities, which will in either case be unaffected by your DTL changes.</p>
<p>There are other reasons both to reprocess all the data and only some of it, but the main point is to assess every situation individually.</p>
<p>Try doing <a class="reference internal" href="#getting-started-labs-22"><span class="std std-ref">lab 22</span></a> to see examples and play around with data to see how this works.</p>
</div>
</div>
<div class="section" id="sinks">
<span id="getting-started-sinks"></span><h2>Sinks<a class="headerlink" href="#sinks" title="Permalink to this headline">#</a></h2>
<p>Sinks are at the receiving end of pipes and are responsible for writing entities into an internal dataset or a target system.</p>
<p>Sinks can support <a class="reference internal" href="configuration.html#pipe-batching"><span class="std std-ref">batching</span></a> by implementing specific methods and accumulating entities in a buffer before writing the batch. The size of each batch can be specified using the batch_size property on the pipe. See the section on batching for more information. We also recommend that you read about
<a class="reference internal" href="data-modelling.html#best-practice-output-pipes"><span class="std std-ref">the sinks</span></a> in the documentation and “Best practice” for best ways of working with them <a class="reference internal" href="data-modelling.html#best-practice-output-pipes"><span class="std std-ref">here</span></a>.</p>
<div class="section" id="csv-endpoint-sink">
<span id="getting-started-csv-endpoint"></span><h3>CSV endpoint sink<a class="headerlink" href="#csv-endpoint-sink" title="Permalink to this headline">#</a></h3>
<p>We will first look at setting up a sink to expose the output for a .csv (comma separated values) file. The CSV endpoint sink does not support pumping and the batching explained above. The only way to have entities flow through the pipe is by requesting the output as explained below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"sink"</span><span class="p">:</span> <span class="p">{</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"csv_endpoint"</span><span class="p">,</span>
  <span class="s2">"columns"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"lastname"</span><span class="p">,</span> <span class="s2">"address"</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The sink config can include more parameters, but their default values are OK for our example and do not need to be listed and changed. For example <strong>“delimiter”</strong> is set as <strong>“,”</strong> by default. Look up other parameters in the documentation if needed. The values listed in <strong>“columns”</strong> correspond to values in the output of the DTL.</p>
<p>After creating a pipe with a CSV endpoint sink you can go to the <strong>“Output”</strong> tab of the pipe. Here you can download the entity output. Select the number of entities you want to include and click “Download” to get a .csv file with the same name as the pipe. This can be viewed in a text editor to see the result, or you can open the file in e.g. Microsoft Excel. In Excel open a document, go to the “Data” tab and click “From Text/CSV”.</p>
<p>You can also download the output by copying the cURL and creating your .csv file in a CLI like curl or Git Bash. Paste the cURL into you CLI and add ” &gt; my_file.csv” at the end. This will create the file at your current location. You can remove the entity limit and get all entities by removing “?limit=X” from the curl.</p>
</div>
<div class="section" id="sql-database-to-csv-file-output-step-by-step">
<h3>SQL database to CSV file output step by step<a class="headerlink" href="#sql-database-to-csv-file-output-step-by-step" title="Permalink to this headline">#</a></h3>
<p>In this next chapter we will walk you through the steps of using a SQL database as a source and create a CSV endpoint. First, if you don’t have access to a SQL server you can sign up at <a class="reference external" href="https://www.elephantsql.com">ElephantSQL</a> and select a free trial.</p>
<p>Once you’ve set up your account click on details in the left menu. It should look like this:</p>
<a class="reference internal image-reference" href="_images/Elephant_SQL.png"><img alt="Generic pipe concept" class="align-center" src="_images/Elephant_SQL.png" style="width: 800px;"/></a>
<p>Now you are ready to create a new system. In <strong>Sesam</strong> go to Systems and select <strong>New system</strong>. In the <strong>Choose template</strong> select <strong>postgresql prototype</strong> (Because we’re using ElephantSQL. Will be different for other sources).</p>
<p>To fill in the <strong>“database”</strong>, <strong>“host”</strong>, <strong>“password”</strong> and <strong>“username”</strong> go to your <em>ElephantSQL</em> and select <strong>details</strong>. From the figure above you’ll see that you have the <strong>Server</strong>, <strong>User &amp; Default database</strong> and <strong>Password</strong>.</p>
<p>In the <strong>“_id”</strong> you’ll create the name of the system (the same as creating a pipe).</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>“type”</strong>: “system:postgresql”</p></li>
<li><p><strong>“database”</strong>: User &amp; Default database</p></li>
<li><p><strong>“host”</strong>: Server</p></li>
<li><p><strong>“password”</strong>: Password</p></li>
<li><p><strong>“username”</strong>: User &amp; Default database</p></li>
</ul>
</div></blockquote>
<div class="section" id="using-secrets">
<h4>Using secrets<a class="headerlink" href="#using-secrets" title="Permalink to this headline">#</a></h4>
<a class="reference internal image-reference" href="_images/new_system3.png"><img alt="Generic pipe concept" class="align-center" src="_images/new_system3.png" style="width: 800px;"/></a>
<p>As you can see, we are using <a class="reference internal" href="security.html#secrets-manager"><span class="std std-ref">secrets</span></a> for the database, password and username. To do this go into the <strong>Secrets</strong> tab, click <strong>Add secret</strong>, give it a name (e.g. “password” for the password and “username” for the username) and paste the values from ElephantSQL. Read more about secrets <a class="reference external" href="https://docs.sesam.io/security.html">here</a>.</p>
</div>
<div class="section" id="creating-a-table-in-the-database">
<h4>Creating a table in the database<a class="headerlink" href="#creating-a-table-in-the-database" title="Permalink to this headline">#</a></h4>
<p>Until now your database has been empty. If you are not familiar with SQL, do not worry. We have created some sample data for you. In ElephantSQL, click on <strong>browser</strong> in the left menu.</p>
<a class="reference internal image-reference" href="_images/elephantQuery.png"><img alt="Generic pipe concept" class="align-center" src="_images/elephantQuery.png" style="width: 800px;"/></a>
<p>Copy/paste the following</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">EmployeeTable</span> <span class="p">(</span>
<span class="nb">id</span> <span class="n">SERIAL</span> <span class="n">PRIMARY</span> <span class="n">KEY</span><span class="p">,</span>
<span class="n">firstname</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
<span class="n">lastname</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
<span class="n">DateOfBirth</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="n">Address</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
<span class="n">Salary</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Department</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Then click on <strong>Execute</strong></p>
<p>Delete the old text and copy/paste the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">EmployeeTable</span> <span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">firstname</span> <span class="p">,</span><span class="n">lastname</span> <span class="p">,</span><span class="n">DateOfBirth</span> <span class="p">,</span><span class="n">address</span><span class="p">,</span><span class="n">Salary</span><span class="p">,</span><span class="n">Department</span><span class="p">)</span>
<span class="n">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">'Larry'</span><span class="p">,</span><span class="s1">'Johnson'</span><span class="p">,</span><span class="s1">'27-05-1989'</span><span class="p">,</span><span class="s1">'Country road 1'</span><span class="p">,</span><span class="mi">58000</span><span class="p">,</span><span class="s1">'Sales'</span><span class="p">),</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">'Mike'</span><span class="p">,</span> <span class="s1">'Jensen'</span><span class="p">,</span><span class="s1">'05-27-1989'</span><span class="p">,</span><span class="s1">'Upper street 3'</span><span class="p">,</span><span class="mi">62000</span><span class="p">,</span> <span class="s1">'Marketing'</span><span class="p">),</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">'Hannah'</span><span class="p">,</span> <span class="s1">'Jackson'</span><span class="p">,</span><span class="s1">'10-12-1982'</span><span class="p">,</span><span class="s1">'East road 5'</span><span class="p">,</span><span class="mi">60000</span><span class="p">,</span><span class="s1">'Production'</span><span class="p">),</span>
<span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s1">'Phillip'</span><span class="p">,</span> <span class="s1">'Blackstone'</span><span class="p">,</span><span class="s1">'08-02-1978'</span><span class="p">,</span><span class="s1">'Sourt Street 23'</span><span class="p">,</span><span class="mi">49000</span><span class="p">,</span><span class="s1">'Sales'</span><span class="p">),</span>
<span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">'Otto'</span><span class="p">,</span> <span class="s1">'Greene'</span><span class="p">,</span><span class="s1">'03-20-1969'</span><span class="p">,</span><span class="s1">'North street 65'</span><span class="p">,</span><span class="mi">48000</span><span class="p">,</span><span class="s1">'HR'</span><span class="p">),</span>
<span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">'Siri'</span><span class="p">,</span> <span class="s1">'Stone'</span><span class="p">,</span><span class="s1">'03-05-1989'</span><span class="p">,</span><span class="s1">'Middle street 5'</span><span class="p">,</span><span class="mi">62000</span><span class="p">,</span> <span class="s1">'Marketing'</span><span class="p">),</span>
<span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="s1">'Olav'</span><span class="p">,</span> <span class="s1">'Olsen'</span><span class="p">,</span><span class="s1">'11-30-1989'</span><span class="p">,</span><span class="s1">'Down street 2'</span><span class="p">,</span><span class="mi">54000</span><span class="p">,</span> <span class="s1">'Accounting'</span><span class="p">);</span>
</pre></div>
</div>
<p>Then click on <strong>Execute</strong>. We have now created a sample table with some properties with values.</p>
<p>Head back to your ‘Requested private trial node’. Now you can create a new pipe that pulls this table from the database.</p>
<a class="reference internal image-reference" href="_images/new-pipe-db.png"><img alt="Generic pipe concept" class="align-center" src="_images/new-pipe-db.png" style="width: 800px;"/></a>
<p>Should <strong>Provider</strong> -&gt; <strong>employeetable</strong> not pop up automatically just type in the necessary lines manually as shown in the picture above.</p>
<p>You are now free to transform the data as you want, but it is not needed and will be omitted here.</p>
</div>
<div class="section" id="creating-our-csv-sink">
<h4>Creating our CSV sink<a class="headerlink" href="#creating-our-csv-sink" title="Permalink to this headline">#</a></h4>
<a class="reference internal image-reference" href="_images/csv-endpoint.png"><img alt="Generic pipe concept" class="align-center" src="_images/csv-endpoint.png" style="width: 800px;"/></a>
<p>There are multiple ways of viewing the data. The simplest is to download the file and opening it with Excel or any text editor. (If you are familiar with cURL you can copy the link and past it in terminal/command.)</p>
<a class="reference internal image-reference" href="_images/csv-sink.png"><img alt="Generic pipe concept" class="align-center" src="_images/csv-sink.png" style="width: 800px;"/></a>
<p>Click <strong>Download</strong>. Open a new Excel document. Go to <strong>Data</strong> then select <strong>From text</strong>. Find the CSV-file and click <strong>Get Data</strong>.</p>
<p>Select as shown in figures below:</p>
<a class="reference internal image-reference" href="_images/csv-test.png"><img alt="Generic pipe concept" class="align-center" src="_images/csv-test.png" style="width: 800px;"/></a>
</div>
</div>
<div class="section" id="sql-sink-example-configuration">
<h3>SQL sink example configuration<a class="headerlink" href="#sql-sink-example-configuration" title="Permalink to this headline">#</a></h3>
<p>The outermost object would be your pipe configuration, which is omitted here for brevity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">"sink"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"sql"</span><span class="p">,</span>
        <span class="s2">"system"</span><span class="p">:</span> <span class="s2">"my-mssql-system"</span><span class="p">,</span>
        <span class="s2">"table"</span><span class="p">:</span> <span class="s2">"customers"</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Each object is on the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">"source_property"</span><span class="p">:</span> <span class="s2">"name_of_property"</span><span class="p">,</span>
   <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"name_of_column"</span><span class="p">,</span>
   <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"string|integer|decimal|float|bytes|datetime|date|time|uuid|boolean"</span><span class="p">,</span>
   <span class="s2">"max_size|max_value"</span><span class="p">:</span> <span class="mi">1234</span><span class="p">,</span>
   <span class="s2">"min_size|min_value"</span><span class="p">:</span> <span class="mi">1234</span><span class="p">,</span>
   <span class="s2">"precision"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
   <span class="s2">"scale"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
   <span class="s2">"allow_null"</span><span class="p">:</span> <span class="n">true</span><span class="o">|</span><span class="n">false</span><span class="p">,</span>
   <span class="s2">"primary_key"</span><span class="p">:</span> <span class="n">true</span><span class="o">|</span><span class="n">false</span><span class="p">,</span>
   <span class="s2">"index"</span><span class="p">:</span> <span class="n">true</span><span class="o">|</span><span class="n">false</span><span class="p">,</span>
   <span class="s2">"default"</span><span class="p">:</span> <span class="s2">"default-value"</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Let’s look at an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"employeetable-endpoint"</span><span class="p">,</span>
 <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
 <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
   <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"db-employee"</span>
 <span class="p">},</span>
 <span class="s2">"sink"</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"sql"</span><span class="p">,</span>
   <span class="s2">"system"</span><span class="p">:</span> <span class="s2">"employee"</span><span class="p">,</span>
   <span class="s2">"batch_size"</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
   <span class="s2">"bulk_operation_queue_size"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
   <span class="s2">"bulk_operation_timeout"</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>
   <span class="s2">"create_table_if_missing"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
   <span class="s2">"keep_failed_bulk_operation_files"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
   <span class="s2">"primary_key"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"id"</span><span class="p">],</span>
   <span class="s2">"schema"</span><span class="p">:</span> <span class="s2">"dbo"</span><span class="p">,</span>
   <span class="s2">"schema_definition"</span><span class="p">:</span> <span class="p">[{</span>
     <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"integer"</span><span class="p">,</span>
     <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"id"</span><span class="p">,</span>
     <span class="s2">"default"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
     <span class="s2">"allow_null"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"index"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"max_value"</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
     <span class="s2">"min_value"</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
     <span class="s2">"primary_key"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
     <span class="s2">"source_property"</span><span class="p">:</span> <span class="s2">"id"</span>
   <span class="p">},</span> <span class="p">{</span>
     <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"string"</span><span class="p">,</span>
     <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"firstname"</span><span class="p">,</span>
     <span class="s2">"default"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
     <span class="s2">"allow_null"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
     <span class="s2">"index"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"max_size"</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
     <span class="s2">"min_size"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="s2">"primary_key"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"source_property"</span><span class="p">:</span> <span class="s2">"firstname"</span>
   <span class="p">},</span> <span class="p">{</span>
     <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"string"</span><span class="p">,</span>
     <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"lastname"</span><span class="p">,</span>
     <span class="s2">"default"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
     <span class="s2">"allow_null"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
     <span class="s2">"index"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"max_size"</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
     <span class="s2">"min_size"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="s2">"primary_key"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"source_property"</span><span class="p">:</span> <span class="s2">"lastname"</span>
   <span class="p">},</span> <span class="p">{</span>
     <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"string"</span><span class="p">,</span>
     <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"dateofbirth"</span><span class="p">,</span>
     <span class="s2">"default"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
     <span class="s2">"allow_null"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
     <span class="s2">"index"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"max_size"</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
     <span class="s2">"min_size"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="s2">"primary_key"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"source_property"</span><span class="p">:</span> <span class="s2">"dateofbirth"</span>
   <span class="p">},</span> <span class="p">{</span>
     <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"string"</span><span class="p">,</span>
     <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"department"</span><span class="p">,</span>
     <span class="s2">"default"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
     <span class="s2">"allow_null"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
     <span class="s2">"index"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"max_size"</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
     <span class="s2">"min_size"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="s2">"primary_key"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"source_property"</span><span class="p">:</span> <span class="s2">"department"</span>
   <span class="p">},</span> <span class="p">{</span>
     <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"integer"</span><span class="p">,</span>
     <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"salary"</span><span class="p">,</span>
     <span class="s2">"default"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
     <span class="s2">"allow_null"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
     <span class="s2">"index"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"max_value"</span><span class="p">:</span> <span class="mi">10000000</span><span class="p">,</span>
     <span class="s2">"min_value"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="s2">"primary_key"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"source_property"</span><span class="p">:</span> <span class="s2">"salary"</span>
   <span class="p">},</span> <span class="p">{</span>
     <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"string"</span><span class="p">,</span>
     <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"address"</span><span class="p">,</span>
     <span class="s2">"default"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
     <span class="s2">"allow_null"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
     <span class="s2">"index"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"max_size"</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
     <span class="s2">"min_size"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="s2">"primary_key"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">"source_property"</span><span class="p">:</span> <span class="s2">"address"</span>
   <span class="p">}],</span>
   <span class="s2">"table"</span><span class="p">:</span> <span class="s2">"db-test-emlpoyee"</span><span class="p">,</span>
   <span class="s2">"timestamp"</span><span class="p">:</span> <span class="s2">"time_added"</span><span class="p">,</span>
   <span class="s2">"truncate_table_on_first_run"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
   <span class="s2">"use_bulk_operations"</span><span class="p">:</span> <span class="n">false</span>
 <span class="p">},</span>
 <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
   <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
       <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span>
         <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"id"</span><span class="p">,</span> <span class="s2">"firstname"</span><span class="p">,</span> <span class="s2">"lastname"</span><span class="p">,</span> <span class="s2">"dateofbirth"</span><span class="p">,</span> <span class="s2">"department"</span><span class="p">,</span> <span class="s2">"salary"</span><span class="p">,</span> <span class="s2">"address"</span><span class="p">]</span>
       <span class="p">]</span>
     <span class="p">]</span>
   <span class="p">}</span>
 <span class="p">},</span>
 <span class="s2">"pump"</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">"mode"</span><span class="p">:</span> <span class="s2">"manual"</span>
 <span class="p">},</span>
 <span class="s2">"metadata"</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">"tags"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"test"</span><span class="p">]</span>
 <span class="p">},</span>
 <span class="s2">"remove_namespaces"</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This sink configuration creates an SQL table containing data from the <strong>“db-employee”</strong> dataset.</p>
<div class="section" id="http-endpoint-and-retrieving-data">
<h4>HTTP-endpoint and retrieving data<a class="headerlink" href="#http-endpoint-and-retrieving-data" title="Permalink to this headline">#</a></h4>
<p>We can expose the entities of a dataset in Sesam through an HTTP-endpoint and fetch them with an HTTP Get-request.</p>
</div>
<div class="section" id="exposing-datasets-with-http-endpoint">
<h4>Exposing datasets with HTTP-endpoint<a class="headerlink" href="#exposing-datasets-with-http-endpoint" title="Permalink to this headline">#</a></h4>
<p>To expose a dataset from Sesam we create an HTTP-endpoint pipe in our Sesam node. Below is the configuration for a pipe called “person-crm-endpoint”, which exposes the dataset ‘person-crm’.</p>
<p><strong>Replace the dataset</strong> in the “source” with the dataset you want data from and <strong>name the pipe</strong> accordingly in the <strong>“_id”</strong>. We recommend setting the <strong>“_id”</strong> of the pipe as <strong>“name-of-dataset-endpoint”</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"person-crm-endpoint"</span><span class="p">,</span>
 <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
 <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
   <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"person-crm"</span>
 <span class="p">},</span>
 <span class="s2">"sink"</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"http_endpoint"</span>
 <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="fetch-data">
<h4>Fetch data<a class="headerlink" href="#fetch-data" title="Permalink to this headline">#</a></h4>
<p>To get hold of the data we have exposed in our HTTP-endpoint we send HTTP Get-requests from our client. Provided below are templates for implementing this in Python, Java or C# .Net.</p>
<p><strong>Python</strong></p>
<p>We will use Python’s HTTP library Requests. This can be installed by running <strong>pip install requests</strong> in our Python interpreter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://DATAHUB-URL.sesam.cloud/api/publishers/ENDPOINT-ID/entities"</span>
<span class="n">JWT</span> <span class="o">=</span> <span class="s2">"YOUR-JWT-TOKEN"</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">'Authorization'</span><span class="p">:</span> <span class="s1">'bearer '</span><span class="o">+</span><span class="n">JWT</span><span class="p">})</span>
<span class="n">entities</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>

<span class="nb">print</span><span class="p">(</span><span class="n">entities</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Java</strong></p>
<p>We will use Apache HttpClient to create a GET request and will need the following Maven dependency:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">httpcomponents</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">httpclient</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="mf">4.5.4</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><strong>Java class</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">package</span> <span class="n">sesam</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStreamReader</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.HttpResponse</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.client.methods.HttpGet</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.impl.client.CloseableHttpClient</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.http.impl.client.HttpClientBuilder</span><span class="p">;</span>

<span class="n">public</span> <span class="k">class</span> <span class="nc">ApacheHttpClientGet</span> <span class="p">{</span>

   <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="n">throws</span> <span class="n">IOException</span> <span class="p">{</span>

       <span class="n">String</span> <span class="n">entities</span> <span class="o">=</span> <span class="n">getEntities</span><span class="p">();</span>
       <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="n">entities</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="n">private</span> <span class="n">static</span> <span class="n">String</span> <span class="n">getEntities</span><span class="p">()</span> <span class="n">throws</span> <span class="n">IOException</span> <span class="p">{</span>

       <span class="k">try</span> <span class="p">(</span><span class="n">CloseableHttpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">HttpClientBuilder</span><span class="o">.</span><span class="n">create</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">())</span> <span class="p">{</span>

           <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s2">"https://DATAHUB-URL.sesam.cloud/api/publishers/ENDPOINT-ID/entities"</span><span class="p">;</span>
           <span class="n">String</span> <span class="n">JWT</span> <span class="o">=</span> <span class="s2">"YOUR-JWT-TOKEN"</span><span class="p">;</span>

           <span class="n">HttpGet</span> <span class="n">request</span> <span class="o">=</span> <span class="n">new</span> <span class="n">HttpGet</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
           <span class="n">request</span><span class="o">.</span><span class="n">addHeader</span><span class="p">(</span><span class="s2">"Authorization"</span><span class="p">,</span> <span class="s2">"Bearer "</span><span class="o">+</span><span class="n">JWT</span><span class="p">);</span>
           <span class="n">HttpResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>

           <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getStatusLine</span><span class="p">()</span><span class="o">.</span><span class="n">getStatusCode</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
               <span class="o">//</span> <span class="n">handle</span> <span class="k">as</span> <span class="n">preferred</span>
               <span class="k">return</span> <span class="n">null</span><span class="p">;</span>
           <span class="p">}</span>

           <span class="n">BufferedReader</span> <span class="n">bufReader</span> <span class="o">=</span> <span class="n">new</span> <span class="n">BufferedReader</span><span class="p">(</span><span class="n">new</span> <span class="n">InputStreamReader</span><span class="p">(</span>
                   <span class="n">response</span><span class="o">.</span><span class="n">getEntity</span><span class="p">()</span><span class="o">.</span><span class="n">getContent</span><span class="p">()));</span>

           <span class="k">return</span> <span class="n">bufReader</span><span class="o">.</span><span class="n">readLine</span><span class="p">();</span>
       <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>C#.Net</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>using System;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Threading.Tasks;

namespace Sesam
{
  class Program
  {
      static void Main(string[] args)
      {
          var entities = GetEntities().Result;
          Console.WriteLine($"Entities: {entities}");
          Console.ReadLine();
      }

      private static async Task&lt;String&gt; GetEntities()
      {
          var url = "https://DATAHUB-URL.sesam.cloud/";
          var apiUrl = $"/api/publishers/ENDPOINT-ID/entities";
          string jwt = "YOUR-JWT-TOKEN";

          using (var client = new HttpClient() { BaseAddress = new Uri(url) })
          {
              client.BaseAddress = new Uri(url);
              client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue("application/json"));
              client.DefaultRequestHeaders.Add("Authorization", $"Bearer {jwt}");

              using (var response = await client.GetAsync(apiUrl))
              {
                  if (response.StatusCode == System.Net.HttpStatusCode.OK)
                      return await response.Content.ReadAsStringAsync();

                  else return null;
              }
          }
      }
  }
}
</pre></div>
</div>
<p><strong>Adaptation</strong>
To make these code implementations work with our HTTP endpoint we have to replace the capitalized parts of the URL and the JWT-token creation.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><strong>Replace DATAHUB-URL</strong> with the URL of our Sesam datahub. This URL is found just below the Sesam logo at the top-left corner of the page when logged into our node in the Sesam portal.</p></li>
<li><p><strong>Replace</strong> the <strong>ENDPOINT-ID</strong> part of the URL with the <strong>“_id”</strong> of the endpoint pipe we want data from.</p></li>
<li><p><strong>Replace YOUR-JWT-TOKEN</strong> with a JWT-token from our Sesam subscription. This is to provide authorization to access the HTTP-endpoint. The token is not retrievable through Sesam, but we might have already stored it somewhere for later use. We can find our JWT-token inside our .syncconfig-files if we have previously created these to support storing Sesam-configs locally. If we don’t have access to our existing JWTs, we can create a new one in the Sesam portal under “Subscription” -&gt; “JWT”.</p></li>
</ol>
<ul class="simple">
<li><p>Optionally we can add <strong>?limit=x</strong> or <strong>?since=x</strong> to the end of the URL in our get-call. Limit has to be an integer and specifies the maximum number of entities to get. Adding since will give you only the entities that have a higher value of “_updated” than the value you give since. The “_updated” property of the entities are either an integer or a timestamp, but since is treated as a string. When using since to only fetch entities that have been added since our previous request, we need to keep track the “_updated” value of the last entity fetched client side to have it available for the next call.</p></li>
</ul>
</div></blockquote>
<p>The complete URL could look like this <code class="docutils literal notranslate"><span class="pre">https://datahub-425aagcte.sesam.cloud/api/publishers/person-crm-httpendpoint/entities?since=255</span></code>:</p>
<p>All of these templates provide the data from the HTTP endpoint as a JSON-formatted string object named <strong>entities</strong>. We can now replace the printing of this string with our own implementation to make use of the data.</p>
</div>
<div class="section" id="writing-data-to-external-systems">
<span id="getting-started-labs-export"></span><h4>Writing data to external systems<a class="headerlink" href="#writing-data-to-external-systems" title="Permalink to this headline">#</a></h4>
<p>How we write data to a system from Sesam depends on the target system. For many databases, APIs and other targets there are ready-made connectors in Sesam. These are available as systems and can be created using templates, in which you fill in the required connection info. The system in Sesam then serves as your connection to the external system. Previously in these labs we set up a URL-system in our Sesam node to import data from geonorge.no.</p>
<p>If a system in Sesam is connected to an external system that we can write to, we can reference that Sesam-system in an output pipe’s sink. When the pipe is run, data will be written to the external system instead of a dataset in Sesam.</p>
<p>If we need to connect to a system that is not supported out-of-the-box or do operations that are not supported we can create and run a custom microservice as a system, used with a JSON push sink. You can find open-source, community developed microservices at <a class="reference external" href="https://github.com/sesam-community">https://github.com/sesam-community</a>. We can also expose data directly in an HTTP publisher endpoint as JSON, CSV or XML without any system, just using a sink.</p>
<p>You will find documentation for the systems and sinks on the Developer Guide’s <a class="reference internal" href="configuration.html#configuration"><span class="std std-ref">Service Configuration</span></a> page.</p>
</div>
</div>
<div class="section" id="getting-started-labtime-3">
<span id="id4"></span><h3>Lab time<a class="headerlink" href="#getting-started-labtime-3" title="Permalink to this headline">#</a></h3>
<p>Now that we have had a look at different types of sinks it’s time to have a go at the <a class="reference internal" href="#getting-started-labs-23"><span class="std std-ref">Writing data to external systems</span></a> section of the labs.</p>
</div>
</div>
<div class="section" id="pumps">
<span id="getting-started-pumps"></span><h2>Pumps<a class="headerlink" href="#pumps" title="Permalink to this headline">#</a></h2>
<p>The pumps specify the schedule with which the pipe runs. This can be done through a scheduled interval specified either pr.seconds, hours, days, weeks or months. A pump can be added to a pipe through the <strong>Schedule</strong> template.</p>
<div class="section" id="dead-letters">
<h3>Dead letters<a class="headerlink" href="#dead-letters" title="Permalink to this headline">#</a></h3>
<p>“Pump” is also the part of the pipe where more advanced settings for keeping control of dead letters are configured.</p>
<p>A general definition of “dead letter” is a letter sent to unknown address, in other words “failed delivery”. Transferring this to Sesam, a dead letter is an entity in a dataset that fails to write when a pipe runs. Hence a “failed delivery” to the target system it is supposed to be written to.</p>
<p>If a pipe fails, Sesam provides a function which allows failed entities to be written to a “dead letter” dataset. If the entities can be transferred later on, they are flagged as “ok” in the dead letter dataset. Sesam can be configured to keep trying to write the entities to appropriate dataset.</p>
<p>Once pipe has run, go into <strong>Dataset</strong>. On top go to column <strong>“Origin”</strong> and click <strong>“system”</strong>. This filter shows on the systems datasets and it is here you will find you dead letter datasets. So for pipes configurated to use <strong>dead letters</strong>, a dataset prefix <code class="docutils literal notranslate"><span class="pre">system:dead-letter:</span></code> followed by the pipe name will be generated. If no entities failed, the dataset will be empty. Those entities that failed, will be listed in this dataset.</p>
<a class="reference internal image-reference" href="_images/how-to-dl-dataset.png"><img alt="DataSet" class="align-center" src="_images/how-to-dl-dataset.png" style="width: 600px;"/></a>
<a class="reference internal image-reference" href="_images/dl-dataset.png"><img alt="DataSet" class="align-center" src="_images/dl-dataset.png" style="width: 600px;"/></a>
<p>Now we have a list of datasets that failed and you can do more configuration to pump to say when to retry to write the failed entities, how often, max number of times Sesam should try to re-write them and delay when try to re-write. For more detail on how to use the various options, please read more about configuring <a class="reference internal" href="configuration.html#pump-section"><span class="std std-ref">pumps</span></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"crm-person-endpoint"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"person-cmm"</span>
  <span class="p">},</span>
  <span class="s2">"sink"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="s2">"system"</span><span class="p">:</span> <span class="s2">"cmm"</span><span class="p">,</span>
    <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"timestamp"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"datetime-format"</span><span class="p">,</span> <span class="s2">"%Y-%m-</span><span class="si">%d</span><span class="s2">"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"now"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">"pump"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"max_consecutive_write_errors"</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">"max_retries_per_entity"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">"max_write_errors_in_retry_dataset"</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
    <span class="s2">"track_dead_letters"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">"use_dead_letter_dataset"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">"write_retry_delay"</span><span class="p">:</span> <span class="s2">"~f0.1"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="microservices">
<span id="getting-started-microservices"></span><h2>Microservices<a class="headerlink" href="#microservices" title="Permalink to this headline">#</a></h2>
<p>The DTL in Sesam is a powerful tool to transform our data. But sometimes we need to do something with our data that is outside the scope of the DTL. We can then create a microservice that does what we need and run it inside Sesam to serve those needs. We can also use a microservice when we need to connect to an external system where the connection point is not compatible with the Sesam source systems. The microservice can be made according to our preferences and in any language.</p>
<a class="reference internal image-reference" href="_images/MS-types.jpg"><img alt="Generic pipe concept" class="align-center" src="_images/MS-types.jpg" style="width: 800px;"/></a>
<p>As shown above, irrespective of nature or technologies of external system, we can easily connect with them using microservices to read, write and update data. Microservices add flexibility to do more with data than may be possible with DTL.</p>
<div class="section" id="workflow">
<h3>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">#</a></h3>
<p>Microservices in Sesam run in docker containers. These containers run on our Sesam-node in what we call a system. Below is a visual representation of the flow of hosting our microservice in Sesam.</p>
<a class="reference internal image-reference" href="_images/workflow-ms.png"><img alt="Generic pipe concept" class="align-center" src="_images/workflow-ms.png" style="width: 800px;"/></a>
<p>We start by building a Docker image from our microservice. A Docker image is the blueprint for creating a container with our microservice.</p>
<p>The Docker image is then pushed up to a repository on Docker Hub (or any Docker platform. When hosted in the repository the image can be pulled by anyone with access.</p>
<p>Finally, we pull the image from our Docker Hub repository (although private repositories are also supported) and spin up a container on our Sesam node. The container is created from the image and started. The Docker-commands for this are performed by Sesam. We simply specify the location of the image on Docker Hub in our Sesam system configuration and the container is spun up automatically. Once the Docker image location is defined in the System config Sesam will spin up the correponding container automatically. Finally to transfer data between Sesam datahub and the microservice, we need an inbound pipe or endpoint pipe depending on solution. For example a SQL database sends data to a Sesam pipe via a default microservice available inside your Sesam node, and similarly for data going out of Sesam to target systems.</p>
</div>
<div class="section" id="microservices-with-docker">
<h3>Microservices with Docker<a class="headerlink" href="#microservices-with-docker" title="Permalink to this headline">#</a></h3>
<p>First you need to sign up on <a class="reference external" href="https://www.docker.com">Docker</a> and create a new repository.</p>
<a class="reference internal image-reference" href="_images/Docker-repo.png"><img alt="Generic pipe concept" class="align-center" src="_images/Docker-repo.png" style="width: 800px;"/></a>
<p>Then download <a class="reference external" href="https://www.docker.com/get-started">Docker Desktop</a>.</p>
<p>You now need to download Python. Here we’re using Python 3.6 but you can use any version after 3.5. Then install pip and Flask.</p>
<p>Flask is a web framework used by Pything to develop web services nad pip is a de facto standard package-management system used to install and manage software packages written in Python. If you need help with this, follow the instructions <a class="reference external" href="https://pip.pypa.io/en/stable/installing/">here</a> for pip and <a class="reference external" href="https://flask.palletsprojects.com/en/1.0.x/installation/">here</a> for Flask.</p>
<a class="reference internal image-reference" href="_images/flaskInstall.png"><img alt="Generic pipe concept" class="align-center" src="_images/flaskInstall.png" style="width: 800px;"/></a>
<p>First things first, we need to decice which IDE (integrated development environment) you want to use. In this exercise we will use <em>Pycharm</em>, but there are various other options so if you are currently using another one, that is not a problem.</p>
<p>You are now ready to create the microservice. We will generate a folder and a couple of files that a microservice always need to run. Firstly we need to create a <strong>Dockerfile</strong>. A <a class="reference external" href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Dockerfile</a> is a text file that Docker reads in from top to bottom. It contains instructions which informs Docker <em>how</em> the Docker image should get built. To read more about Docker, Docker image, Docker build, it is helpful to browse the <a class="reference external" href="https://docs.docker.com">Docker documentation</a> . In addition we need to generate the actual program which is stored in a python file (.py).</p>
<p>This is the program that actually runs inside Sesam and tells the system that it is connected to what needs to be done. In this example, it only sends 3 entities with embedded order data. In other cases, the MS must contain authentication to the system (eg basic auth or sql database), or in some cases we have to extract the data in the correct format (such as retrieving OData). All of these .py files (must not be .py, these are only python programs. It could have been .java for java programs, for example) are the “programs” that are running.</p>
<p>In addition we need requirements.txt file which tells the microservice file which libraries this program needs to run. In our example, we only run Flaks so we simply write it in in the following format:</p>
<p><cite>Flask==1.1.2`</cite></p>
<p>If you want to know more about requirements.txt files, please click <a class="reference external" href="https://pip.pypa.io/en/stable/user_guide/#requirements-files">here</a></p>
<p>Now let us go through this step by step.</p>
<p>First thing we need is to create a new project in Pycharm. Name your project “Demo_MicroserviceProject”. The files we need to create the Microservices, will be stored inside the project.</p>
<p>Once we have this, we can start by adding the <strong>“Dockerfile”</strong>.</p>
<p>Inside your Demo_MicroserviceProject folder create a new file called “Dockerfile” and paste:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FROM</span> <span class="n">python</span><span class="p">:</span><span class="mi">3</span><span class="o">-</span><span class="n">alpine</span>

<span class="n">RUN</span> <span class="n">apk</span> <span class="n">update</span>

<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span>

<span class="n">COPY</span> <span class="o">./</span><span class="n">service</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="n">COPY</span> <span class="o">./</span><span class="n">service</span> <span class="o">/</span><span class="n">service</span>

<span class="n">EXPOSE</span> <span class="mi">5000</span>

<span class="n">CMD</span> <span class="p">[</span><span class="s2">"python3"</span><span class="p">,</span> <span class="s2">"./service/DemoMicroservice.py"</span><span class="p">]</span>
</pre></div>
</div>
<p>Once Dockerfile is ready, we create a new folder called “service” inside your project root folder.</p>
<a class="reference internal image-reference" href="_images/MSproject.png"><img alt="Generic pipe concept" class="align-center" src="_images/MSproject.png" style="width: 800px;"/></a>
<p>Next step is to create the “requirements.txt” inside the “service” folder and paste the following text inside it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flask</span><span class="o">==</span><span class="mf">1.0.2</span>

<span class="n">If</span> <span class="n">you</span> <span class="n">have</span> <span class="n">a</span> <span class="n">newer</span> <span class="n">version</span> <span class="n">of</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">you</span> <span class="n">put</span> <span class="n">that</span> <span class="ow">in</span> <span class="n">instead</span> <span class="n">of</span> <span class="mf">1.0.2</span><span class="o">.</span>
</pre></div>
</div>
<p>Final part is the actual program. For this we create a python file, also in the “service” folder, named “DemoMicroservice.py” with the following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">jsonify</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">orders</span> <span class="o">=</span> <span class="p">[</span>
<span class="p">{</span>
    <span class="s1">'id'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'Username'</span><span class="p">:</span> <span class="sa">u</span><span class="s1">'Unjudosely'</span><span class="p">,</span>
    <span class="s1">'Orders'</span><span class="p">:</span> <span class="sa">u</span><span class="s1">'Thinkpad'</span><span class="p">,</span>
    <span class="s1">'TotalSum'</span><span class="p">:</span> <span class="mi">8000</span>
    <span class="p">},</span>
    <span class="p">{</span>
    <span class="s1">'id'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">'Username'</span><span class="p">:</span> <span class="sa">u</span><span class="s1">'Wimen1979'</span><span class="p">,</span>
    <span class="s1">'Orders'</span><span class="p">:</span> <span class="sa">u</span><span class="s1">'MacbookPro'</span><span class="p">,</span>
    <span class="s1">'TotalSum'</span><span class="p">:</span> <span class="mi">12000</span>
    <span class="p">},</span>
    <span class="p">{</span> <span class="s1">'id'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s1">'Username'</span><span class="p">:</span> <span class="sa">u</span><span class="s1">'Gotin1984'</span><span class="p">,</span>
    <span class="s1">'Orders'</span><span class="p">:</span> <span class="sa">u</span><span class="s1">'Chormebook'</span><span class="p">,</span>
    <span class="s1">'TotalSum'</span><span class="p">:</span> <span class="mi">10000</span>
    <span class="p">}</span>

<span class="p">]</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/api/orders'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">'GET'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_orders</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">'orders'</span><span class="p">:</span> <span class="n">orders</span><span class="p">})</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">'0.0.0.0'</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/DemoService.png"><img alt="Generic pipe concept" class="align-center" src="_images/DemoService.png" style="width: 800px;"/></a>
<p>Create an image of the microservice in PyCharm’s terminal window or any other CLI that you prefer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">build</span> <span class="o">-</span><span class="n">t</span> <span class="o">&lt;</span><span class="n">docker_username</span><span class="o">&gt;/&lt;</span><span class="n">your_repository_name</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">tagname</span><span class="o">&gt;</span> <span class="o">.</span>
</pre></div>
</div>
<p>To check that the you have created image run the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">images</span>
</pre></div>
</div>
<div class="section" id="testing">
<h4>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">#</a></h4>
<p>To test that you can run a container from your image locally you can run it directly in the terminal. First we need to login to Docker. Run the command docker login and enter your Docker Hub <strong>username</strong> and <strong>password</strong> when prompted.</p>
<p>Next we’ll need to run the image to create the container.</p>
<p>To check that you have created the image run the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">p</span> <span class="o">&lt;</span><span class="n">local_port</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">container_port</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">docker_username</span><span class="o">&gt;/&lt;</span><span class="n">your_repository_name</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">tagname</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Set <strong>local_port</strong> to 5000 and the container_port to the same as the one you specified in the Dockerfile.</p>
<p>Now you can either go to the url in the browser or do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">5000</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">orders</span>
</pre></div>
</div>
<p>in terminal to see if the the container runs.</p>
<p>To stop the container running locally you can run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">stop</span> <span class="o">&lt;</span><span class="n">container</span> <span class="n">name</span><span class="o">&gt;</span> <span class="ow">or</span> <span class="n">docker</span> <span class="n">stop</span> <span class="o">&lt;</span><span class="n">container_id</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="push-to-docker-hub">
<h4>Push to Docker Hub<a class="headerlink" href="#push-to-docker-hub" title="Permalink to this headline">#</a></h4>
<p>Now we need to push the image to the repository:</p>
<p>To check that the you have created image run the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">push</span> <span class="o">&lt;</span><span class="n">docker_username</span><span class="o">&gt;/&lt;</span><span class="n">your_repository_name</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">tagname</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Go to hub.docker.com and check that you can see the tagname in you repository.</p>
<a class="reference internal image-reference" href="_images/docker-push.png"><img alt="Generic pipe concept" class="align-center" src="_images/docker-push.png" style="width: 800px;"/></a>
</div>
<div class="section" id="import-to-sesam-node">
<h4>Import to Sesam node<a class="headerlink" href="#import-to-sesam-node" title="Permalink to this headline">#</a></h4>
<p>Now that the Docker image has been pushed to our Docker platform we need to spin up the container in our Sesam node.</p>
<p>Create a new system in your node. Choose <strong>microservice prototype</strong> as template. Give it a proper name. Inside the <strong>“docker”</strong> parameter write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"docker"</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">"image"</span><span class="p">:</span> <span class="s2">"&lt;docker_username&gt;/&lt;your_repository_name&gt;:&lt;tagname&gt;"</span><span class="p">,</span>
   <span class="s2">"port"</span><span class="p">:</span><span class="mi">5000</span>
<span class="p">}</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/systemconfigms.png"><img alt="Generic pipe concept" class="align-center" src="_images/systemconfigms.png" style="width: 800px;"/></a>
<p>Save it and click on <strong>Status</strong>. Click <strong>Pull</strong> and <strong>restart</strong>, then <strong>Refresh</strong> and <strong>Check health</strong>. You can also hit <strong>Refresh</strong> in the log so you see that it’s running as it should.</p>
<a class="reference internal image-reference" href="_images/system-microservice.gif"><img alt="Generic pipe concept" class="align-center" src="_images/system-microservice.gif" style="width: 800px;"/></a>
<p>The final step is to create an inbound pipe to get all the data from our microservice into Sesam datahub. Because our dataset does not have an <strong>“_id”</strong> property we need to add that. We could just use a normal <strong>[“add”]</strong> function, but as you can see from the microservice, we’ve actually just created one property as a dictionary. We really want these as three entities and that reason we use this function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">"create"</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">"apply"</span><span class="p">,</span> <span class="s2">"create-entity"</span><span class="p">,</span> <span class="s2">"_S.orders"</span><span class="p">]]</span>
</pre></div>
</div>
<p>This creates a new rule where we can add the <strong>“_id”</strong>. Since the <strong>“id”</strong> in the microservice is an integer and Sesam only accepts string values for the <strong>“_id”</strong> we convert it with the <strong>[“string”]</strong> function.</p>
<a class="reference internal image-reference" href="_images/remade-pipe.png"><img alt="Generic pipe concept" class="align-center" src="_images/remade-pipe.png" style="width: 800px;"/></a>
<a class="reference internal image-reference" href="_images/pipe-orders-ms-output.png"><img alt="Generic pipe concept" class="align-center" src="_images/pipe-orders-ms-output.png" style="width: 800px;"/></a>
</div>
</div>
<div class="section" id="rest-apis">
<span id="getting-started-microservices-restapi"></span><h3>REST APIs<a class="headerlink" href="#rest-apis" title="Permalink to this headline">#</a></h3>
<p>Sometimes we have to connect to a websites API to extract data for our pipe. A website’s API is a code that allows our program to communicate with the website, to either extract information, or to post information. A REST (Representational State Transfer), or RESTful, API is an API which uses HTTP requests to POST, GET PUT and DELETE data.</p>
<p>We will be using the <a class="reference external" href="https://flask.palletsprojects.com/en/1.1.x/">flask</a> library as well as the <a class="reference external" href="https://2.python-requests.org/en/master/">requests</a> library in Python to display how we might communicate with a websites API.</p>
<div class="section" id="authentication">
<span id="getting-started-microservices-restapi-authentication"></span><h4>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">#</a></h4>
<p>Often when we wish to communicate with an API, we need to establish who we are, and what we are allowed to do. There as many different ways of doing this, and the way forward depends on the API you wish to communicate with. Most APIs have easily accessible documentation which explain how to authenticate and authorize for that specific API. For these specific websites, you can access the information only after you have authenticated yourself.</p>
</div>
<div class="section" id="json-web-tokens">
<span id="getting-started-microservices-restapi-jwt"></span><h4>JSON Web Tokens<a class="headerlink" href="#json-web-tokens" title="Permalink to this headline">#</a></h4>
<p>When we authenticate ourselves to a server, we often utilize something called a <strong>JSON Web Token</strong> (<strong>JWT</strong>). A JWT is a string that consists of a <strong>header</strong>, a <strong>payload</strong> and a <strong>signature</strong> to form the string <strong>header.payload.signature</strong>.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Header</strong>: The header describes what sort of object it is, in this case a JWT. It also describes the specific algorithm needed to create the JWT signature component.</p></li>
<li><p><strong>Payload</strong>: The payload contains the user information, such as the user ID and the rights of the user.</p></li>
<li><p><strong>Signature</strong>: The signature makes sure the JWT is securure during transport. The signature is the hashed version of the header and the payload, combined with a secret. The secret uses the algorithm specified in the header to hash the data.</p></li>
</ul>
</div></blockquote>
<p>A JWT is used when we need to make sure that the sent data actually originates from an authentic source, to make sure no secondhand party has tempered with the data. When we sign into an app, i.e. google we first communicate with the app’s authentication server. This server sends us a JWT back which we can use to communicate with the app’s API.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/JWT.png"><img alt="_images/JWT.png" src="_images/JWT.png" style="width: 800px;"/></a>
</div>
</div>
<div class="section" id="requests-methods">
<span id="getting-started-microservices-restapi-requests"></span><h4>Requests methods<a class="headerlink" href="#requests-methods" title="Permalink to this headline">#</a></h4>
<p>When communicating with the API we use requests methods such as <strong>GET</strong>, <strong>POST</strong>. For more request methods read <a class="reference external" href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods">this</a>.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>GET</strong>: The GET method request a representation of the data from a web resource, i.e. it reads data.</p></li>
<li><p><strong>POST</strong>: The POST method request that the web resource accepts the data in the request, i.e. it writes data.</p></li>
</ul>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="labs">
<span id="getting-started-labs"></span><h2>Labs<a class="headerlink" href="#labs" title="Permalink to this headline">#</a></h2>
<p>To do these labs you will need to have a Sesam node set up with the <a class="reference download internal" download="" href="_downloads/47628582f05c9664e8750bb478a53fdc/getting-started-config.json"><code class="xref download docutils literal notranslate"><span class="pre">getting-started-config.json</span></code></a> configuration. If you have set up your datahub following the <a class="reference internal" href="#getting-started-upload-config"><span class="std std-ref">guide</span></a> you are ready to do these labs. At the end of the labs section you will find <a class="reference internal" href="#getting-started-labs-solution-examples"><span class="std std-ref">solution examples</span></a> for each lab.</p>
<div class="line-block">
<div class="line"><strong>Naming pipes</strong></div>
<div class="line">As explained in this guide and our <a class="reference internal" href="data-modelling.html#best-practice-naming-conventions"><span class="std std-ref">Best Practice documentation</span></a> we encourage creating pipe names from <strong>the type of object the pipe contains</strong> and <strong>the external system</strong> the data is imported from or to be exported to, i.e. “salesforce-user” or “event-bigquery”. For some of the pipes we will create in these labs it can be difficult to give proper names as the pipes can be arbitrary and have no target system. In these cases it is OK to use the topic of the task as the pipe’s object and simply “labs” as the target system when naming the pipe, i.e. “string-logic-labs”.</div>
</div>
<div class="line-block">
<div class="line"><strong>Developer Guide</strong></div>
<div class="line"><a class="reference external" href="https://docs.sesam.io/developer-guide.html">The Developer Guide</a> section of the documentation will be an important resource when doing these labs, the three first sub-sections of <strong>Service Configuration</strong>, <strong>Entity Data Model</strong> and <strong>Data Transformation Language</strong> in particular.</div>
</div>
<div class="section" id="basics">
<span id="getting-started-labs-basics"></span><h3>Basics<a class="headerlink" href="#basics" title="Permalink to this headline">#</a></h3>
<div class="section" id="lab-1">
<span id="getting-started-labs-1"></span><h4>Lab 1<a class="headerlink" href="#lab-1" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Copying from source</strong></p></li>
</ul>
<p>If a pipe has no transform config it will copy all the attributes of an the entity from the source. But if the pipe has a transform config then that config must specify which attributes to copy from the source. In many cases we want to keep all attributes from the source entity. Other times we might want a subset of the attributes or we want to make some changes to the attributes before we add them to the target entity. In most cases we want to keep the entity ID from the source dataset, so we also copy the <code class="docutils literal notranslate"><span class="pre">_id</span></code> system attribute. We can choose not to copy the <code class="docutils literal notranslate"><span class="pre">_id</span></code> if we want to handle entity ID in a different way, but all entities must have an <code class="docutils literal notranslate"><span class="pre">_id</span></code> of type string.</p>
<div class="section" id="task">
<h5>Task<a class="headerlink" href="#task" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a pipe with <code class="docutils literal notranslate"><span class="pre">"_id":</span> <span class="pre">"order-anonymized-labs"</span></code>.</p></li>
<li><p>Set source to be of type “dataset” and the dataset to “webshop-order”.</p></li>
<li><p>In the transform section, copy all properties from source except the <code class="docutils literal notranslate"><span class="pre">customerId</span></code> and <code class="docutils literal notranslate"><span class="pre">customerId-ni</span></code> attributes.</p></li>
<li><p>Start the pipe and check the results in the “Output”-tab of the pipe.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>You can create a downstream pipe (a pipe that uses the dataset of the pipe you’re currently viewing as its source) from the pipe menu. Click the three dots to the right of the pipe name to open the menu.</p></li>
<li><p>The templates available on the pipe’s “Config”-tab can help ease and speed up config creation. Add a transform config with the “Add DTL transform” button.</p></li>
<li><p>You can look up how the <code class="docutils literal notranslate"><span class="pre">copy</span></code> transform function in DTL works in the <a class="reference internal" href="DTLReferenceGuide.html#dtl-transforms"><span class="std std-ref">documentation</span></a>. You’ll notice that like many other DTL functions it is more flexible than it looks:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">["copy",</span> <span class="pre">"foo"]</span></code> will copy the “foo” attribute.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">["copy",</span> <span class="pre">"*"]</span></code> will copy all attributes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">["copy",</span> <span class="pre">"*",</span> <span class="pre">"foo"]</span></code> will copy all attributes except “foo”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">["copy",</span> <span class="pre">["list",</span> <span class="pre">"foo",</span> <span class="pre">"bar"]]</span></code> will copy only the “foo” and “bar” attributes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">["copy",</span> <span class="pre">"*",</span> <span class="pre">["list",</span> <span class="pre">"foo",</span> <span class="pre">"bar"]]</span></code> will copy all attributes except “foo” and “bar”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">["copy",</span> <span class="pre">"foo*"]</span></code> will copy all attributes that have “foo” at the start of their name.</p></li>
</ul>
</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-2">
<span id="getting-started-labs-2"></span><h4>Lab 2<a class="headerlink" href="#lab-2" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Adding and removing attributes</strong></p></li>
<li><p><strong>Variables _S and _T</strong></p></li>
<li><p><strong>Sequential execution</strong></p></li>
</ul>
<p>In the transform config part of the pipe config, we can create new attributes in our resulting (target) entities with the <code class="docutils literal notranslate"><span class="pre">add</span></code> transform function and remove attributes with  the <code class="docutils literal notranslate"><span class="pre">remove</span></code> transform function. To refer to attributes on the source or target entity, we can prefix the attribute with <code class="docutils literal notranslate"><span class="pre">_S.</span></code> or <code class="docutils literal notranslate"><span class="pre">_T.</span></code> respectively. Let’s say we wanted to add the value from an attribute named <code class="docutils literal notranslate"><span class="pre">foo</span></code> on the source entity as <code class="docutils literal notranslate"><span class="pre">bar</span></code> on the resulting entity. We could do that by referring to the attribute on the source in an <code class="docutils literal notranslate"><span class="pre">add</span></code> like this: <code class="docutils literal notranslate"><span class="pre">["add",</span> <span class="pre">"bar",</span> <span class="pre">"_S.foo"]</span></code>.</p>
<div class="section" id="id5">
<h5>Task<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a pipe downstream from <strong>crm-person</strong> and copy only the <code class="docutils literal notranslate"><span class="pre">_id</span></code> from the source entity.</p></li>
<li><p>Add an attribute named <code class="docutils literal notranslate"><span class="pre">address-from-source</span></code> and populate it with the address found in <strong>crm-person</strong> using the <code class="docutils literal notranslate"><span class="pre">_S.</span></code> variable.</p></li>
<li><p>Then add <code class="docutils literal notranslate"><span class="pre">address-from-target</span></code> using the <code class="docutils literal notranslate"><span class="pre">_T.</span></code> variable to refer to the address attribute you just made.</p></li>
<li><p>Finally remove the <code class="docutils literal notranslate"><span class="pre">address-from-source</span></code> attribute.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>You can preview how a transform config will affect an entity using <code class="docutils literal notranslate"><span class="pre">CTRL</span></code> + <code class="docutils literal notranslate"><span class="pre">Enter</span></code> when in the editor of the “Config”-tab. Use the arrow buttons to navigate to a fitting entity, or enter its <code class="docutils literal notranslate"><span class="pre">_id</span></code> in the “Search ID” textbox.</p></li>
<li><p>There are other variables than the commonly used <code class="docutils literal notranslate"><span class="pre">_S</span></code> and <code class="docutils literal notranslate"><span class="pre">_T</span></code> variables. These can be looked up in the <a class="reference internal" href="DTLReferenceGuide.html#variables"><span class="std std-ref">documentation</span></a>.</p></li>
</ul>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="import-data">
<h3>Import data<a class="headerlink" href="#import-data" title="Permalink to this headline">#</a></h3>
<div class="section" id="lab-3">
<span id="getting-started-labs-3"></span><h4>Lab 3<a class="headerlink" href="#lab-3" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Creating a system</strong></p></li>
</ul>
<p>A system in Sesam represents a computer system that can provide or receive data entities. Its task is to provide common properties and services that can be used by several data sources, such as connection pooling, authentication settings, communication protocol settings and so on. There are many different types of systems available in Sesam. And if we need a more customized system we can use a microservice from <a class="reference external" href="https://github.com/sesam-community">https://github.com/sesam-community</a> or create a new one to run as a custom microservice system.</p>
<p>We are going to import data containing county and municipality information for Norway from an API (<code class="docutils literal notranslate"><span class="pre">https://ws.geonorge.no/kommuneinfo/v1/fylkerkommuner</span></code>) using a URL system in our Sesam node.</p>
<div class="section" id="id6">
<h5>Task<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a URL-system that connects to geonorge with the base URL <code class="docutils literal notranslate"><span class="pre">https://ws.geonorge.no/</span></code> as its <code class="docutils literal notranslate"><span class="pre">url_pattern</span></code>.</p></li>
<li><p>Name the system “geonorge”.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>All systems are <a class="reference internal" href="configuration.html#system-section"><span class="std std-ref">documented</span></a>.</p></li>
<li><p>You can select the “url prototype” system type template when creating the system config to help populate it.</p></li>
<li><p>The rest of the URL will be appended at the end of the <code class="docutils literal notranslate"><span class="pre">url_pattern</span></code> from an <code class="docutils literal notranslate"><span class="pre">url</span></code> parameter in the source of the input pipe.</p></li>
<li><p>You can see whether the system is able to connect to the target on the “Status”-tab.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-4">
<span id="getting-started-labs-4"></span><h4>Lab 4<a class="headerlink" href="#lab-4" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Environment variables and secrets</strong></p></li>
</ul>
<p>We can store environment variables and secrets in the hub through the ‘Variables’-tab on the Datahub settings page. Variables and secrets stored there are globally accessible with syntax <code class="docutils literal notranslate"><span class="pre">"$ENV(variable-name)"</span></code> and <code class="docutils literal notranslate"><span class="pre">"$SECRET(secret-name)"</span></code>. We can also store secrets that are exclusively accessible to a specific systen in that system’s ‘Secrets’-tab.</p>
<div class="section" id="id7">
<h5>Task<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Save the base URL of the <strong>geonorge</strong>-system as an environment variable in the datahub. Then change the system’s <code class="docutils literal notranslate"><span class="pre">url_pattern</span></code> attribute to refer to that environment variable.</p></li>
</ul>
</div>
</div>
<div class="section" id="lab-5">
<span id="getting-started-labs-5"></span><h4>Lab 5<a class="headerlink" href="#lab-5" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Input pipes</strong></p></li>
</ul>
<p>In an input pipe we specify where to get data from, and through which system. We often have to specify which attribute’s value to use as our internal <code class="docutils literal notranslate"><span class="pre">_id</span></code> system attribute, which has to be a unique string per entity. We also add an attribute named <code class="docutils literal notranslate"><span class="pre">rdf:type</span></code> to each entity describing where the data comes from and what it is, which we use for filtering later downstream. But we will omit the <code class="docutils literal notranslate"><span class="pre">rdf:type</span></code> for now and come back to that later.</p>
<div class="section" id="id8">
<h5>Task<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create an input pipe with <code class="docutils literal notranslate"><span class="pre">_id</span></code> “geonorge-county” that imports county data using the newly made “geonorge”-system.</p></li>
<li><p>Give the pipe a JSON source config and set its <code class="docutils literal notranslate"><span class="pre">url</span></code> to “kommuneinfo/v1/fylkerkommuner”.</p></li>
<li><p>As there is no automatically identifiable ID in the data, you will have to add a transform config in your pipe and in it <code class="docutils literal notranslate"><span class="pre">add</span></code> the <code class="docutils literal notranslate"><span class="pre">_id</span></code> attribute from the source data’s “fylkesnummer” attribute (county number).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">copy</span></code> all attributes from the source.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>You can find the JSON source documented under Service Configuration in the Developer Guide section of the documentation.</p></li>
<li><p>The imported entities can be viewed in the “Output”-tab of the pipe and in the dataset of the same name. There should be 11 counties.</p></li>
<li><p>Check the “Execution Log”-tab to see whether the pipe ran successfully. It contains helpful information if you need to figure out why the pipe run did not yield the expected outcome.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-6">
<span id="getting-started-labs-6"></span><h4>Lab 6<a class="headerlink" href="#lab-6" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Conditional source</strong></p></li>
</ul>
<p>We should be able to use the same exact pipe-configs on Sesam nodes in different environments. To support this in input pipes we use a conditional source with two alternative configs named “prod” and “test”. We refer to the environment variable <code class="docutils literal notranslate"><span class="pre">node-env</span></code> as the condition to determine which source to use, which is set as either “prod” or “test” depending of the environment the node runs in. The source config for test should be an embedded type with a few test entities while the source config for prod refers to the external source system. See the <strong>udir-postalcode</strong> pipe for an example of this. We have set our <code class="docutils literal notranslate"><span class="pre">node-env</span></code> environment varible as “test” as we prepared for these labs.</p>
<div class="section" id="id9">
<h5>Task<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Make the source config for <strong>geonorge-county</strong> conditional and supply a few counties as embedded entities. The entities to embed can be taken from the output of the pipe as it previously ran with the production source, but to save time creating entities that match our person test data from other pipes we have created a <a class="reference download internal" download="" href="_downloads/c58b758736f5086d0e381a430658270c/geonorge-county-test-data.json"><code class="xref download docutils literal notranslate"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">entities</span></code></a> to embed.</p></li>
<li><p>Run the pipe and verify that it now outputs the embedded entities.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>Always make sure to anonymize the test data and replace sensitive information.</p></li>
<li><p>Create embedded entities that will match and connect with test data from other input pipes.</p></li>
<li><p>Try setting the <code class="docutils literal notranslate"><span class="pre">node-env</span></code> environment variable to “prod” and run both <strong>geonorge-county</strong> and <strong>udir-postalcode</strong>. Observe that they now import the full datasets from the external source. Set <code class="docutils literal notranslate"><span class="pre">node-env</span></code> back to “test” and run the pipes again to keep working with just test data.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-7">
<span id="getting-started-labs-7"></span><h4>Lab 7<a class="headerlink" href="#lab-7" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Global datasets</strong></p></li>
</ul>
<p>We want to put all data in the datahub into a fitting global dataset, so there’s a logical place to find it when needed. When placing sematically similar data in the same dataset, we can also combine entities into larger, global entities that contain all the data from its source entities. Entities from some datasets may make sense to combine, while others do not and should be placed in the global dataset as separate entities. This depends on whether the entities actually represent the same object. Merging entities into global entities based on equal attribute values is done in the merge source’s <code class="docutils literal notranslate"><span class="pre">equality</span></code> property.</p>
<p>Our newly imported data represents counties, with their municipalities, and fits well in the <strong>global-location</strong> dataset.</p>
<div class="section" id="id10">
<h5>Task<a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Add the new county data to the <strong>global-location</strong> dataset by adding the county dataset in the global’s source datasets list. Note that the datasets listed need to have an alias as well, i.e. “udir-postalcode upc”. Run the global pipe after adding the new dataset in its config.</p></li>
<li><p>Add the <strong>mailerlite-person</strong> dataset in the source of <strong>merged-person</strong>. Merge its entities with <strong>hr-person</strong> based on its SSN-ni attribute.</p></li>
<li><p>Create a new global pipe named <strong>global-transaction</strong>. Use a merge source and put <strong>webshop-order</strong> in its dataset property list. Remember to give the dataset an alias. Add a metadata config to the pipe’s config at root level as <code class="docutils literal notranslate"><span class="pre">"metadata":</span> <span class="pre">{"global":</span> <span class="pre">true}</span></code> to give the pipe a global icon in the “Graph”-tab view.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>Study <strong>global-location</strong> to create <strong>global-transaction</strong>, or even copy its config and change what you need.</p></li>
<li><p>Global pipes that contain hops (joins) to other datasets need to have a dataset source for dependency tracking. Dependency tracking ensures that the output of a pipe is kept up to date when any relevant source data changes. In our setup <strong>global-person</strong> hops to global-location to get a person’s city. Because of this we have a pipe upstream named <strong>merged-person</strong> with a merge source containing all relevant input pipes. All entities from merged-person then flow to <strong>global-person</strong> as it refers to merged-person in its dataset source.</p></li>
</ul>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="data-modelling">
<span id="getting-started-labs-data-modelling"></span><h3>Data Modelling<a class="headerlink" href="#data-modelling" title="Permalink to this headline">#</a></h3>
<div class="section" id="lab-8">
<span id="getting-started-labs-8"></span><h4>Lab 8<a class="headerlink" href="#lab-8" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Filtering entities</strong></p></li>
<li><p><strong>Global dataset as pipe source</strong></p></li>
<li><p><strong>Pipe reset</strong></p></li>
</ul>
<p>As explained in our <a class="reference internal" href="data-modelling.html#best-practice"><span class="std std-ref">Best Practices</span></a>, we want to use a global dataset as our data source when preparing data for export to another system. When we use a global dataset as a pipe’s source, we have to specify what data from that global dataset we want to use. For this we use the DTL transform function <code class="docutils literal notranslate"><span class="pre">filter</span></code>. With it we can select only the entities we want based on the condition we supply. If the condition resolves as <code class="docutils literal notranslate"><span class="pre">false</span></code>, the entity is filtered and will not be written to the pipe’s dataset.</p>
<p>The most common filtering we do is filter on <code class="docutils literal notranslate"><span class="pre">rdf:type</span></code>. That is an attribute we add to entities as they enter Sesam to tag which system it comes from and what it contains. A filter on rdf:type can look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">"filter"</span><span class="p">,</span>
  <span class="p">[</span><span class="s2">"in"</span><span class="p">,</span> <span class="s2">"~:hr:person"</span><span class="p">,</span> <span class="s2">"_S.rdf:type"</span><span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This means an entity will be sent to the sink and written to the dataset only if “~:hr:person” is found in the <code class="docutils literal notranslate"><span class="pre">rdf:type</span></code> list attribute. Entities that do not have “~:hr:person” in the rdf:type will be excluded from our resulting data. This way we can create datasets from only the relevant entities even though the pipe’s source contains a lot more data.</p>
<p>Note that when we change the DTL transform config of a pipe the data previously processed by the pipe will only be reprocessed if the source data changes. If we want all entities to be produced based on the the new config we have to pump all of them through the pipe again. To do that we reset the pipe. The “Restart”-option in the pipe menu conveniently triggers both a “Reset” and a “Start” command on the pipe.</p>
<div class="section" id="id11">
<h5>Task<a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h5>
<ol class="arabic simple">
<li><p>Create a pipe with <strong>global-person</strong> as the source dataset. Do not include a transform section in the pipe.</p></li>
<li><p>Observe that the pipe outputs all the same entities as <strong>global-person</strong> in its “Output”-tab.</p></li>
<li><p>Add a transform to the pipe config with <code class="docutils literal notranslate"><span class="pre">["copy,</span> <span class="pre">"*"]</span></code> and <code class="docutils literal notranslate"><span class="pre">["filter",</span> <span class="pre">["in",</span> <span class="pre">"~:hr:person",</span> <span class="pre">"_S.rdf:type"]]</span></code>.</p></li>
<li><p>Restart the pipe. Observe that there are now only 10 entities in the output, and that they all contain data from “hr-person”.</p></li>
<li><p>Change the filter to keep only entities that have data from the <strong>crm-person</strong> dataset.</p></li>
<li><p>Restart the pipe and observe that you now have 10 entities which all have data from <strong>crm-person</strong>. This should not be the exact same 10 entities as before.</p></li>
</ol>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>The entities you find in the “Output”-tab of the pipe are the same as the entities in the dataset with the same name. The entities in the “Latest” category is the current dataset. In “Latest w/ deleted” you will also find the hr-person entities from the first pipe run. In the “All” category you will find previous versions of all entities as well as the current and deleted entities.</p></li>
<li><p>The number of previous entities to keep in the dataset is two by default and can be changed with a <a class="reference internal" href="configuration.html#pipe-compaction"><span class="std std-ref">compaction</span></a> config.</p></li>
<li><p>When in the config editor use <code class="docutils literal notranslate"><span class="pre">Alt</span></code> + <code class="docutils literal notranslate"><span class="pre">.</span></code> to reformat the config and display it with correct line breaks and whitespace for improved readability.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-9">
<span id="getting-started-labs-9"></span><h4>Lab 9<a class="headerlink" href="#lab-9" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Namespaces</strong></p></li>
</ul>
<p>By default attributes in Sesam have a namespace as a prefix to the attribute name, separated with a colon. This namespace is a string that by default contains the name of the pipe where the attribute was created. For data that we import from external systems this means the name of the input pipe. We can use this namespace to distinguish between attributes with the same name that originate from different sources.</p>
<div class="section" id="id12">
<h5>Task<a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a pipe downstream from <strong>global-person</strong>.</p></li>
<li><p>Copy only the <code class="docutils literal notranslate"><span class="pre">_id</span></code> and <code class="docutils literal notranslate"><span class="pre">hr-person:StreetAddress</span></code>.</p></li>
<li><p>Add one attribute containing <code class="docutils literal notranslate"><span class="pre">StreetAddress</span></code> from <strong>erp-person</strong> and another with <code class="docutils literal notranslate"><span class="pre">Address</span></code> from <strong>crm-person</strong>.</p></li>
<li><p>Note that the namespace of the added attributes refer to the new pipe. This is different from attributes that are copied from the source dataset, which keep their original namespace from the source.</p></li>
</ul>
</div>
</div>
<div class="section" id="lab-10">
<span id="getting-started-labs-10"></span><h4>Lab 10<a class="headerlink" href="#lab-10" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Lists</strong></p></li>
</ul>
<p>Lists are a common collection type to work with in Sesam. Source data can contain lists. Merges can result in joined attributes becoming lists. And we can structure data in lists through DTL to provide as output or to use as input in other DTL-functions.</p>
<div class="section" id="id13">
<h5>Task<a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a pipe with the config provided below.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"list-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"embedded"</span><span class="p">,</span>
    <span class="s2">"entities"</span><span class="p">:</span> <span class="p">[{</span>
      <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"1"</span>
    <span class="p">}]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Give it a transform config and <code class="docutils literal notranslate"><span class="pre">add</span></code> a list containing strings “a”, “b”, “c” and “d” using the <code class="docutils literal notranslate"><span class="pre">list</span></code> function.</p></li>
<li><p>Use this list for the following sub-tasks in which you create new attributes containing:</p>
<ul>
<li><p>the first string element in the list.</p></li>
<li><p>the 3rd string element in the list.</p></li>
<li><p>the number of elements in the list.</p></li>
<li><p>the original list, but with the string “e” inserted as the second element.</p></li>
<li><p>the same list as in the previous sub-task, but sorted alphabetically.</p></li>
</ul>
</li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>All the functions needed for this lab, and many more, are found in the docs’ <a class="reference internal" href="DTLReferenceGuide.html#dtlreferenceguide"><span class="std std-ref">DTL Reference Guide</span></a> under “Values/collections”.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-11">
<span id="getting-started-labs-11"></span><h4>Lab 11<a class="headerlink" href="#lab-11" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Golden records</strong></p></li>
</ul>
<p>In globals we often have data from different sources describing the same characteristic of an object. To avoid having to research which data is most reliable every time we need to use that data, we can create a golden record which is populated with the most reliable version of that data that is available on the object in the global. We can later use that golden record attribute downstream and not have to make the same prioritization each time we need that data.</p>
<div class="section" id="id14">
<h5>Task<a class="headerlink" href="#id14" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a new golden record attribute named <code class="docutils literal notranslate"><span class="pre">email</span></code> in <strong>global-person</strong>. Use the <code class="docutils literal notranslate"><span class="pre">coalesce</span></code> function to rank the data quality of the email address from <strong>mailerlite-person</strong> the highest, <strong>crm-person</strong> the 2nd most, <strong>salesforce-userprofile</strong> the 3rd most and <strong>hr-person</strong> the least.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>Look up the <code class="docutils literal notranslate"><span class="pre">coalesce</span></code> function in the docs or look at its use in <strong>global-person</strong>.</p></li>
<li><p>Restart pipes after making changes to their transform config if you want its dataset to reflect the new config.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-12">
<span id="getting-started-labs-12"></span><h4>Lab 12<a class="headerlink" href="#lab-12" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Casting</strong></p></li>
<li><p><strong>Number logic</strong></p></li>
<li><p><strong>Nested functions</strong></p></li>
</ul>
<p>We can cast an attribute as different types, like integer, string, datetime and others described in the docs.</p>
<p>When working with numbers we have a set of functions and operators that we can apply to the numeric values. These are documented in the DTL Reference Guide under “Math”. Different functions for casting can be found under “Numbers”, “Strings” and other headers regarding data types.</p>
<p>To do successive actions on a value we nest functions within eachother. We use the result of one function as an input parameter of another, like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"foo"</span><span class="p">,</span>
  <span class="p">[</span><span class="s2">"first"</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">"split"</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">,</span> <span class="s2">"bar-bell"</span><span class="p">]</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>To follow a value through complex logic you often read the config from right to left. I.e. we have a string of “bar-bell”. We then split the string at the hyphen to get two strings in a list (<code class="docutils literal notranslate"><span class="pre">["bar",</span> <span class="pre">"bell"]</span></code>). Then we select the first object in the list and add that as <code class="docutils literal notranslate"><span class="pre">foo</span></code> to end up with a key + value pair of <code class="docutils literal notranslate"><span class="pre">"foo":</span> <span class="pre">"bar"</span></code>.</p>
<div class="section" id="id15">
<h5>Task<a class="headerlink" href="#id15" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a pipe with <strong>erp-person</strong> data. Make the pipe downstream from <strong>erp-person</strong> or preferrably downstream from <strong>global-person</strong> and filter the entities that do not contain <strong>erp-person</strong> data (filter on <code class="docutils literal notranslate"><span class="pre">rdf:type</span></code>).</p></li>
<li><p>Imagine a new order has come in for everyone in this dataset, and increase the number of <code class="docutils literal notranslate"><span class="pre">TimesOrdered</span></code> by one. As this attribute is a string in the source data it needs to be cast to integer before we can increase the value. Cast the result back to string and add it to the entity as a new <code class="docutils literal notranslate"><span class="pre">TimesOrdered</span></code> attribute which will get its namespace from the new pipe.</p></li>
</ul>
</div>
</div>
<div class="section" id="lab-13">
<span id="getting-started-labs-13"></span><h4>Lab 13<a class="headerlink" href="#lab-13" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>String logic</strong></p></li>
</ul>
<p>In Sesam’s DTL there are many functions available for working with <a class="reference internal" href="DTLReferenceGuide.html#string-dtl-function"><span class="std std-ref">strings</span></a>. Let’s try working with some of them.</p>
<div class="section" id="id16">
<h5>Task<a class="headerlink" href="#id16" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a pipe with <strong>hr-person</strong> data.</p></li>
<li><p>Create an attribute for each of the subtasks below containing:</p>
<ul>
<li><p>only the prefix of the email address. Look up the <code class="docutils literal notranslate"><span class="pre">split</span></code> and <code class="docutils literal notranslate"><span class="pre">first</span></code> functions.</p></li>
<li><p>the person’s surname in only capital letters. Look up <code class="docutils literal notranslate"><span class="pre">upper</span></code> in the docs.</p></li>
<li><p>the date of birth of the person in the format of “dd.mm.yy” extrapolated from <code class="docutils literal notranslate"><span class="pre">SSN</span></code>. Look up <code class="docutils literal notranslate"><span class="pre">substring</span></code> and <code class="docutils literal notranslate"><span class="pre">concat</span></code> or <code class="docutils literal notranslate"><span class="pre">join</span></code> in the docs.</p></li>
<li><p>the title of the person without any punctuation at the end. Look up the use of the <code class="docutils literal notranslate"><span class="pre">strip</span></code> functions.</p></li>
</ul>
</li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>The first two digits of a SSN represent the day, the next two digits represent the month and then the next two represent the year.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-14">
<span id="getting-started-labs-14"></span><h4>Lab 14<a class="headerlink" href="#lab-14" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Datetime logic</strong></p></li>
</ul>
<p>Sesam provides a toolkit for working with date and time values, just like it does for string and number logic. These DTL-functions can be found in the docs too! With <code class="docutils literal notranslate"><span class="pre">datetime-parse</span></code> we can translate strings to datetime values, while <code class="docutils literal notranslate"><span class="pre">datetime-format</span></code> translates datetime values to strings. <code class="docutils literal notranslate"><span class="pre">datetime-diff</span></code>, <code class="docutils literal notranslate"><span class="pre">datetime-plus</span></code> and <code class="docutils literal notranslate"><span class="pre">datetime-shift</span></code> lets us do calculation and manipulation of datetime values.</p>
<div class="section" id="id17">
<h5>Task<a class="headerlink" href="#id17" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a pipe containing the entities from <strong>webshop-orders</strong>.</p></li>
<li><p>Use datetime logic on the <code class="docutils literal notranslate"><span class="pre">orderPlaced</span></code> attribute from source, to create additional attributes containing</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">orderPlaced</span></code> as a datetime value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">orderPlaced</span></code> as a string containing its date in the “dd.mm.yyyy” format.</p></li>
<li><p>a datetime value of 72 hours after the order was placed.</p></li>
<li><p>the number of days since the order was placed.</p></li>
</ul>
</li>
</ul>
<p>Tip</p>
<blockquote>
<div><ul class="simple">
<li><p>For the last task use the <code class="docutils literal notranslate"><span class="pre">now</span></code> function when calculating how much time has passed.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-15">
<span id="getting-started-labs-15"></span><h4>Lab 15<a class="headerlink" href="#lab-15" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>If</strong></p></li>
<li><p><strong>Comparisons</strong></p></li>
</ul>
<p>With DTL we can perform logic with checks and comparisons as well. Let’s look at the <code class="docutils literal notranslate"><span class="pre">if</span></code> function and the comparison functions we have available.</p>
<div class="section" id="id18">
<h5>Task<a class="headerlink" href="#id18" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a pipe that checks entities from <strong>erp-person</strong> using the <code class="docutils literal notranslate"><span class="pre">if</span></code> function to see if they have a 10 000 or higher spending according to their <code class="docutils literal notranslate"><span class="pre">MoneyUsed</span></code> attribute. Add the attribute <code class="docutils literal notranslate"><span class="pre">big-spender</span></code> as a boolean true or false depending on the result.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>Look up the <code class="docutils literal notranslate"><span class="pre">if</span></code> function and the various comparisons in the <a class="reference internal" href="DTLReferenceGuide.html#eq-dtl-function"><span class="std std-ref">docs</span></a>.</p></li>
<li><p>You will have to cast the <code class="docutils literal notranslate"><span class="pre">MoneyUsed</span></code> value to a numeric type, i.e. integer, to get a correct result from the comparison.</p></li>
<li><p>You can perform more than one action as the result of an <code class="docutils literal notranslate"><span class="pre">if</span></code> by placing them within square brackets to make it a list of actions in the then or else argument of an if. Test it by adding another attribute along with <code class="docutils literal notranslate"><span class="pre">big-spender</span></code>, like <code class="docutils literal notranslate"><span class="pre">"foo":</span> <span class="pre">"bar"</span></code>.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-16">
<span id="getting-started-labs-16"></span><h4>Lab 16<a class="headerlink" href="#lab-16" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Filtering entities</strong></p></li>
</ul>
<p>There are two <code class="docutils literal notranslate"><span class="pre">filter</span></code> functions in Sesam’s DTL. In this task and when we filter entities on <code class="docutils literal notranslate"><span class="pre">rdf:type</span></code> we use the transform function. Transform functions are the functions that can add or remove attributes to the entities, which in this case adds an internal system attribute (<code class="docutils literal notranslate"><span class="pre">"_filtered":</span> <span class="pre">true</span></code>) to the entity. The other filter function is found under Values/Collections in the docs, and it is used to filter values that do not match a certain criteria when we perform logic on data within a transform function.</p>
<p>If we use the <code class="docutils literal notranslate"><span class="pre">filter</span></code> transform function without any input parameter we filter out the entity we’re currently processing unconditionally. We can provide a function as an “unless”-condition, and the entity will only be filtered if that function returns true. We have already used this filter function to filter entities from a global dataset source based on <code class="docutils literal notranslate"><span class="pre">rdf:type</span></code>. <code class="docutils literal notranslate"><span class="pre">["filter",</span> <span class="pre">["in",</span> <span class="pre">"~:hr:person",</span> <span class="pre">"_S.rdf:type"]]</span></code> reads “Filter, unless ‘~:hr:person’ is in the ‘rdf:type’-list”.</p>
<div class="section" id="id19">
<h5>Task<a class="headerlink" href="#id19" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a pipe with <strong>global-person</strong> as its source.</p></li>
<li><p>Use the filter transform function to keep only the females.</p></li>
<li><p>Add another filter, or add another condition in the first filter, that filters out anyone who does not have “dayrep.com” as their email postfix.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>To add a second condition to the first <code class="docutils literal notranslate"><span class="pre">filter</span></code> you will need to place an <code class="docutils literal notranslate"><span class="pre">ànd</span></code> function around the two conditions. There is also an <code class="docutils literal notranslate"><span class="pre">or</span></code> function which can be useful in other scenarios.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">discard</span></code> transform function is similar to the <code class="docutils literal notranslate"><span class="pre">filter</span></code> transform function. But <code class="docutils literal notranslate"><span class="pre">discard</span></code> will drop the entity completely and not send it to the sink at all, while the <code class="docutils literal notranslate"><span class="pre">filter</span></code> function adds <code class="docutils literal notranslate"><span class="pre">_filtered</span></code> as true to the entity and lets the entity pass to the sink. If an entity already exists in the pipe’s dataset from previous runs, but is updated with <code class="docutils literal notranslate"><span class="pre">"_filtered":</span> <span class="pre">true</span></code> it will be deleted from the dataset (receive <code class="docutils literal notranslate"><span class="pre">"_deleted":</span> <span class="pre">true</span></code>). With <code class="docutils literal notranslate"><span class="pre">discard</span></code> that same entity would stay unchanged in the pipe’s dataset. If a filtered entity does not alreay exist in the dataset it will not be written to the dataset by the sink.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-17">
<span id="getting-started-labs-17"></span><h4>Lab 17<a class="headerlink" href="#lab-17" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Apply</strong></p></li>
</ul>
<p>The transform section of a pipe config contains a <code class="docutils literal notranslate"><span class="pre">default</span></code> rule. The logic in this rule will execute on the pipe’s source entity. We can make additional rules and in the default rule select data to pass through those custom rules with an <code class="docutils literal notranslate"><span class="pre">apply</span></code> function. By passing entities or lists through a rule we can achieve a loop-like behavior where the transforms of the rule is applied to each item of the entity or list individually. Additional rules can also help section and organize a large pipe config.</p>
<div class="section" id="id20">
<h5>Task<a class="headerlink" href="#id20" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a pipe with the config provided below.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"apply-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"embedded"</span><span class="p">,</span>
    <span class="s2">"entities"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"1"</span><span class="p">,</span>
      <span class="s2">"list"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"some string"</span><span class="p">,</span> <span class="n">false</span><span class="p">,</span> <span class="s2">"another string"</span><span class="p">,</span> <span class="mi">45678908765</span><span class="p">,</span> <span class="s2">"abcd"</span><span class="p">,</span> <span class="s2">"STRING"</span><span class="p">,</span> <span class="n">true</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="s2">"132456"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Expand the transform config. Use <code class="docutils literal notranslate"><span class="pre">apply</span></code> with a <code class="docutils literal notranslate"><span class="pre">merge-union</span></code> transform function to run the <code class="docutils literal notranslate"><span class="pre">list</span></code> items through another rule.</p></li>
<li><p>Have that rule keep the string-objects and not save anything else. Within that rule the data sent to it is accessible through <code class="docutils literal notranslate"><span class="pre">_S</span></code>. Use <code class="docutils literal notranslate"><span class="pre">if</span></code> to check the object with <code class="docutils literal notranslate"><span class="pre">is-string</span></code>. Keep a string by adding it with <code class="docutils literal notranslate"><span class="pre">["add",</span> <span class="pre">"result",</span> <span class="pre">"_S."]</span></code> if <code class="docutils literal notranslate"><span class="pre">is-string</span></code> returns true. The rule you call with the apply must exist inside the <code class="docutils literal notranslate"><span class="pre">rules</span></code> dictionary of the pipe config, just like the <code class="docutils literal notranslate"><span class="pre">default</span></code> rule does.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>Try swapping <code class="docutils literal notranslate"><span class="pre">merge-union</span></code>  with <code class="docutils literal notranslate"><span class="pre">merge</span></code> or <code class="docutils literal notranslate"><span class="pre">add</span></code> to see the difference in how the resulting data is structured as it is returned and added to the target entity.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-18">
<span id="getting-started-labs-18"></span><h4>Lab 18<a class="headerlink" href="#lab-18" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Create-child</strong></p></li>
<li><p><strong>Emit_children</strong></p></li>
<li><p><strong>Chained transforms</strong></p></li>
</ul>
<p>We can emit new, standalone entities from a set of values on an entity. This can be done either with the <code class="docutils literal notranslate"><span class="pre">create</span></code> or <code class="docutils literal notranslate"><span class="pre">create-child</span></code> transform functions. <code class="docutils literal notranslate"><span class="pre">create</span></code> will emit and send the new standalone entities to the pipe’s sink, while <code class="docutils literal notranslate"><span class="pre">create-child</span></code> will add them in a <code class="docutils literal notranslate"><span class="pre">$children</span></code> attribute on the original entity. We can then pass the original entity through an <code class="docutils literal notranslate"><span class="pre">emit_children</span></code> transform to write them as standalone entities to a dataset. The new entities must have their own valid <code class="docutils literal notranslate"><span class="pre">_id</span></code>.</p>
<p>So far we have only been using a <code class="docutils literal notranslate"><span class="pre">DTL</span></code> transform in our pipes. There are other <a class="reference internal" href="configuration.html#transform-section"><span class="std std-ref">transforms</span></a> that do different things. The emit children transform will produce standalone entities from the contents of a <code class="docutils literal notranslate"><span class="pre">$children</span></code> attribute of an entity. It discards the original entity. The HTTP transform can send the entities to an external HTTP endpoint for transformation and receive data back. You can have a conditional transform just like we have conditional source, and you can chain multiple transforms in one pipe.</p>
<p>The counties we imported from geonorge earlier in these labs each include a list of municipalities. Let’s emit these municipalities as their own entities using <code class="docutils literal notranslate"><span class="pre">create-child</span></code> and an emit children transform that we chain after the DTL transform where we create the <code class="docutils literal notranslate"><span class="pre">$children</span></code>.</p>
<div class="section" id="id21">
<h5>Task<a class="headerlink" href="#id21" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Make a pipe downstream from geonorge-county and name it geonorge-municipality.</p></li>
<li><p>Give it a chained transform with a DTL transform first and an emit children transform second.</p></li>
<li><p>In the DTL transform first add <code class="docutils literal notranslate"><span class="pre">["filter",</span> <span class="pre">["neq",</span> <span class="pre">"_S._deleted",</span> <span class="pre">true]]</span></code> to remove <code class="docutils literal notranslate"><span class="pre">_deleted</span></code> entities, as the emit children transform would also emit children from those.</p></li>
<li><p>As the municipalities listed in the counties do not have an “_id” already, we need to add that before we put them in <code class="docutils literal notranslate"><span class="pre">$children</span></code>. In the DTL transform have a <code class="docutils literal notranslate"><span class="pre">create-child</span></code> transform function take the results of an <code class="docutils literal notranslate"><span class="pre">apply</span></code> as its argument. The <code class="docutils literal notranslate"><span class="pre">apply</span></code> function should pass the list-attribute “_S.kommuner” (municipalities) through a rule in which we build our new entities. In that rule</p>
<ul>
<li><p>copy all attributes that are passed to the rule in the “kommuner” list object with [“copy”, “*”]</p></li>
<li><p>add “_id” from “_S.kommunenummer” (municipality number)</p></li>
<li><p>add “rdf:type” as [“ni”, “geonorge”, “municipality”] to use for filtering downstream when we are to use this data later.</p></li>
</ul>
</li>
<li><p>Run the pipe and confirm that it outputs municipalities.</p></li>
<li><p>Finaly, add the new municipality dataset to <strong>global-location</strong>’s’ source dataset list and run the global pipe.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>We don’t have to chain transforms in one pipe to emit the entities in the <code class="docutils literal notranslate"><span class="pre">$children</span></code> attribute. We do that in this lab to test the functionality of chaining transforms. The <code class="docutils literal notranslate"><span class="pre">emit_children</span></code> transform can be in a pipe downstream from the pipe where <code class="docutils literal notranslate"><span class="pre">$children</span></code> is created.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-19">
<span id="getting-started-labs-19"></span><h4>Lab 19<a class="headerlink" href="#lab-19" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Namespaced Identifiers</strong></p></li>
</ul>
<p>When we know that an attribute on entities in an input pipe is equal to the <code class="docutils literal notranslate"><span class="pre">_id</span></code> of entities in a different dataset, we can add a namespaced identifier based on that attribute. This makes it easier to join data from different datasets, and can be viewed as similar to setting a foreign key in one table that relates to the primary key of another table in an SQL-database. If we make a namespaced identifier (NI) on a <code class="docutils literal notranslate"><span class="pre">customer-id</span></code> attribute of an order entity, it might look like this on our order entity: <code class="docutils literal notranslate"><span class="pre">"customer-id-ni":</span> <span class="pre">"~:crm-customer:123456"</span></code>. We can then use that NI attribute when we join customer and order data in a downstream pipe.</p>
<p>We have seen the NI attribute <code class="docutils literal notranslate"><span class="pre">rdf:type</span></code> on all the entities in our Sesam hub in these labs. This attribute is used to filter entities downstream, like we have been doing.</p>
<p>Look up the <code class="docutils literal notranslate"><span class="pre">ni</span></code> function in the Developer Guide. You can also read more about namespaced identifiers in the <a class="reference internal" href="data-modelling.html#best-practice-namespaced-identifiers"><span class="std std-ref">Best Practice</span></a> section of the docs.</p>
<div class="section" id="id22">
<h5>Task<a class="headerlink" href="#id22" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Add a NI as <code class="docutils literal notranslate"><span class="pre">municipality-ni</span></code> in <strong>udir-postalcode</strong> based on the <code class="docutils literal notranslate"><span class="pre">municipality</span></code> attribute in the postalcode entity. In the <code class="docutils literal notranslate"><span class="pre">ni</span></code> function supply the namespace string “geonorge-municipality” and refer to the <code class="docutils literal notranslate"><span class="pre">municipality</span></code> attribute for the value.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">rdf:type</span></code> using the <code class="docutils literal notranslate"><span class="pre">ni</span></code> function in geonorge-county.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>Once we have made a NI attribute that refers to an entity in another dataset we can look up that entity when browsing its dataset by pasting the NI-attribute value as id to search in the dataset browser (or the “Output”-tab of the dataset’s pipe).</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-20">
<span id="getting-started-labs-20"></span><h4>Lab 20<a class="headerlink" href="#lab-20" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Hops</strong></p></li>
</ul>
<p>With the <code class="docutils literal notranslate"><span class="pre">hops</span></code> function we can reach data outside of the entity we’re currently processing. The function takes a dictionary as its only argument; the hops spec. In that dictionary we specify which datasets to join on which attributes. We can also specify what attribute or expression we want returned from the hops. If not, the whole entity is returned. If a pipe joins data from multiple datasets, Sesam builds an index on the specified properties. You can read more about hops and how joins work in the <a class="reference internal" href="DTLReferenceGuide.html#path-expressions-and-hops"><span class="std std-ref">Developer Guide</span></a>. It is considered good practice to hop to a global dataset when possible, instead of other datasets that contain the data we need.</p>
<div class="section" id="id23">
<h5>Task<a class="headerlink" href="#id23" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a pipe containing the people from <strong>erp-person</strong>.</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">hops</span></code> function to access the <strong>webshop-order</strong> data through the <strong>global-transaction</strong> dataset, and from that add a list of IDs of items the person has ordered. The <code class="docutils literal notranslate"><span class="pre">where</span></code> parameter of the hops spec shoould be an <code class="docutils literal notranslate"><span class="pre">eq</span></code> comparison between <code class="docutils literal notranslate"><span class="pre">$ids</span></code> of the pipe’s source and the <code class="docutils literal notranslate"><span class="pre">customerId-ni</span></code> of the order dataset.</p></li>
<li><p>Specify the item ID attribute of the order in the hops spec’s <code class="docutils literal notranslate"><span class="pre">return</span></code> parameter.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>Look up <code class="docutils literal notranslate"><span class="pre">hops</span></code> in the Developer Guide. The hops spec has many optional parameters, only <code class="docutils literal notranslate"><span class="pre">datasets</span></code> and <code class="docutils literal notranslate"><span class="pre">where</span></code> are required.</p></li>
<li><p>You can see an example of hops in use in the <strong>person-address-csv</strong> pipe in your datahub.</p></li>
<li><p>If you set <strong>erp-person</strong> as the source of your pipe, you can join the datasets on erp-person’s <code class="docutils literal notranslate"><span class="pre">_id</span></code> and webshop-order’s <code class="docutils literal notranslate"><span class="pre">customer-id</span></code>. But if you set <strong>global-person</strong> as your pipe source and used filter to get only the erp-person entities (as is recommended), those entities’ <code class="docutils literal notranslate"><span class="pre">_id</span></code> may not be the <code class="docutils literal notranslate"><span class="pre">_id</span></code> of <strong>erp-person</strong>, and the comparison will fail. However, on the <strong>global-person</strong> entity there is a <code class="docutils literal notranslate"><span class="pre">$ids</span></code> attribute containing all <code class="docutils literal notranslate"><span class="pre">_id</span></code>s of the merged person entities in a list of namespaced identifiers. Base the join expression of the <code class="docutils literal notranslate"><span class="pre">where</span></code> parameter on <code class="docutils literal notranslate"><span class="pre">$ids</span></code> when possible when working with merged entities.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-21">
<span id="getting-started-labs-21"></span><h4>Lab 21<a class="headerlink" href="#lab-21" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Apply-hops</strong></p></li>
</ul>
<p>In some cases we want to apply some transforms to the results of a hops before we return it to our entity. We can use the <code class="docutils literal notranslate"><span class="pre">apply-hops</span></code> function to run the results from the hops through a specified rule before returning. This can be used to traverse a list or entity, for example to filter the elements of the list that are not relevant. Within the rule called by the apply we can also do new hops to join data from other datasets based on the data returned from the initial hops.</p>
<div class="section" id="id24">
<h5>Task<a class="headerlink" href="#id24" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a pipe with <strong>global-person</strong> as its source. Make a <code class="docutils literal notranslate"><span class="pre">merge</span></code> transform function with an <code class="docutils literal notranslate"><span class="pre">apply-hops</span></code> to the <strong>global-location</strong> dataset. Set the join expression <code class="docutils literal notranslate"><span class="pre">eq</span></code> function to compare <code class="docutils literal notranslate"><span class="pre">global-person:zipcode</span></code> and <code class="docutils literal notranslate"><span class="pre">udir-postalcode:postalcode</span></code>.</p></li>
<li><p>In the rule called by the <code class="docutils literal notranslate"><span class="pre">apply-hops</span></code>, add an attribute named “location”. It should be a concatinated string explaining which municipality number the person’s city is located in, i.e. “Oslo is located in municipality number 0301”.</p></li>
<li><p>Inside the newly made custom rule, <code class="docutils literal notranslate"><span class="pre">merge</span></code> another <code class="docutils literal notranslate"><span class="pre">apply-hops</span></code> to the related <strong>geonorge-municipality</strong> entity in <strong>global-location</strong>. Since we have already made <code class="docutils literal notranslate"><span class="pre">municipality-ni</span></code> in <strong>udir-postalcode</strong> we can compare that to the <code class="docutils literal notranslate"><span class="pre">$ids</span></code> of the <strong>global-location</strong> municipalities in the join expression.</p></li>
<li><p>Use the rule related to the last <code class="docutils literal notranslate"><span class="pre">apply-hops</span></code> to check if the municipality is located north of the arctic cirle. This can be done by checking if the latitude value is 66.33 or higher. The latitude of the municipality is represented by the last number in <code class="docutils literal notranslate"><span class="pre">punktIOmrade.coordinates</span></code> (pointInArea.coordinates). Add <code class="docutils literal notranslate"><span class="pre">arctic-municipality</span></code> as true or false depending on the result.</p></li>
</ul>
</div>
</div>
<div class="section" id="lab-22">
<span id="getting-started-labs-22"></span><h4>Lab 22<a class="headerlink" href="#lab-22" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Change-tracking</strong></p></li>
<li><p><strong>Dependency-tracking</strong></p></li>
<li><p><strong>Sequence number</strong></p></li>
<li><p><strong>Last seen / pipe offset</strong></p></li>
</ul>
<p>In lab 8 we learned to restart a pipe if we want all of its entities to be processed with an updated DTL-transform. This is because a Sesam pipe by default only reprocesses entities that have changed in the source, to avoid the inefficiency of reprocessing entire datasets. Similarly, dependency tracking enables the pipe to reprocess only affected entities after changes in datasets connected through hops. Dependency tracking is explained futher in <a class="reference internal" href="#getting-started-dependency-tracking-and-resetting-a-pipe"><span class="std std-ref">Dependency-tracking and resetting a pipe</span></a>.</p>
<div class="section" id="id25">
<h5>Task<a class="headerlink" href="#id25" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Add a new property in the first custom rule of the pipe you made in the previous lab. Assign a hardcoded value.</p>
<ul>
<li><p>Start the pipe, click “Refresh” and look at the output. Note that no entities have changed.</p></li>
<li><p>Reset, start and refresh the pipe. Note that all entities now have the new property.</p></li>
</ul>
</li>
<li><p>Go back to the config and change the value of the property we just added.</p>
<ul>
<li><p>Now go to the “Input”-tab of the pipe. The entities found here are from the source dataset. Pick any entity that is neither at the top or the bottom the list. Find its sequence number in its “_updated” attribute.</p></li>
<li><p>Select “Update last seen” from the pipe menu and supply the sequence number from the entity you chose.</p></li>
<li><p>Then start the pipe and check the results in the “Output”-tab.</p></li>
<li><p>Note that only the entities with a sequence number in the source dataset that is higher than the “last seen” value we set are updated.</p></li>
</ul>
</li>
<li><p>Play around with the “Update last seen”, “Reset”, “Restart” and “Start” options. Feel free to change entities in the source or a dataset that is connected through hops to see the effects on the resulting data.</p></li>
</ul>
</div>
</div>
<div class="section" id="lab-23">
<span id="getting-started-labs-23"></span><h4>Lab 23<a class="headerlink" href="#lab-23" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>CSV endpoint</strong></p></li>
</ul>
<p>First, let’s expose some data in a CSV-endpoint. The .csv file can be downloaded from the output pipe’s “Output”-tab.</p>
<div class="section" id="id26">
<h5>Task<a class="headerlink" href="#id26" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a preparation pipe, a pipe with entities that will be exported or exposed in an output pipe downstream. Populate the preparation pipe with entities of your choosing. Make sure to stick to naming conventions and name it after the type of object it contains and the target system (in this case the system is simply “csv”) i.e. “orders-csv”.</p></li>
<li><p>Create an output pipe downstream with a CSV sink. Name this pipe the same as its preparation pipe, but with an “-endpoint” postfix, i.e. “orders-csv-endpoint”.</p></li>
<li><p>Download the .csv file from the pipe’s “Output”-tab and verify its content.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>You can find the sink config template under the “Target” header in templates. Choose system “system:sesam-node” and sink “csv_endpoint prototype”.</p></li>
<li><p>Note that you can retrieve the entities with the cURL provided in the “Output”-tab. This cURL contains a JWT (JSON Web Token) for authentication. You can also create a shareable link for use without access to the Sesam portal.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-24">
<span id="getting-started-labs-24"></span><h4>Lab 24<a class="headerlink" href="#lab-24" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>HTTP endpoint</strong></p></li>
<li><p><strong>JWT</strong></p></li>
</ul>
<p>Now let’s expose data in a HTTP-endpoint. We will also use a JWT for authentication. The JWT, or JSON Web Token, is a token that can be created on the Subscription page. When creating the JWT, an expiry data and a role must be set. The value of a token is not retrievable after creation. These JWTs can be supplied as bearer tokens for authentication in requests sent to the node.</p>
<div class="section" id="id27">
<h5>Task<a class="headerlink" href="#id27" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>Create a similar data flow as in the previous lab, but this time use an HTTP sink in the output pipe. Stick to naming conventions.</p></li>
<li><p>Create a JWT of your own in the datahub’s subscription page. Using this bearer token as authentication, retrieve the data through a GET-request to the “…/entities”-URL exposed by the http-sink.</p></li>
</ul>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>You can send the GET-request with cURL, Postman (or your favorite alternative), write a microservice that fetches the data or import the data from another service or system capable of sending HTTP-requests that you may be looking to integrate with Sesam.</p></li>
<li><p>The “Output”-tab of the output pipe provides what’s needed to retrieve the data.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-25">
<span id="getting-started-labs-25"></span><h4>Lab 25<a class="headerlink" href="#lab-25" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Write data to a SQL-database</strong></p></li>
</ul>
<p>SQL databases are common target systems for data export from Sesam. There are a few different SQL systems available in sesam, and all of them are used together with the SQL sink when exporting data. For the following task you need an SQL database to write to. If you don’t have one at hand, there are free online database services where you can set up a database using a trial account. <a class="reference external" href="https://www.elephantsql.com/">https://www.elephantsql.com/</a> is one where you can set up a postgresql database.</p>
<div class="section" id="id28">
<h5>Task<a class="headerlink" href="#id28" title="Permalink to this headline">#</a></h5>
<p>Write entities to a table in an SQL database. Follow the steps below:</p>
<ol class="arabic simple">
<li><p>Create an SQL system in Sesam that is of the same type as your database and supply the connection info needed in the template system config. Put passwords or auth tokens for your system in the datahub’s secrets and refer to those in your system config. In many cases it is advisable to store other connection info values as environment variables in the datahub. You can verify that the system is able to connect on its “Status”-tab.</p></li>
<li><p>Create a person table in your database with columns as specified in the SQL query below:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">person</span> <span class="p">(</span>
<span class="n">_id</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="n">PRIMARY</span> <span class="n">KEY</span><span class="p">,</span>
<span class="n">firstname</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="n">lastname</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="n">address</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Create a preparation pipe downstream from <strong>global-person</strong> and have it copy this list of attributes: <code class="docutils literal notranslate"><span class="pre">["list",</span> <span class="pre">"_id",</span> <span class="pre">"global-person:firstname",</span> <span class="pre">"global-person:lastname",</span> <span class="pre">"global-person:address"]</span></code>.</p></li>
<li><p>Create an output pipe downstream from the preparation pipe with an SQL sink that refers to the newly created system and the “person” table. Make sure to add a pump config in which <code class="docutils literal notranslate"><span class="pre">"mode"</span></code> is set to <code class="docutils literal notranslate"><span class="pre">"ENV(pump-mode)"</span></code>, which in turn is set to “manual” in the datahub environment variables.</p></li>
<li><p>Send your data to the database table by starting the output pipe. Check the execution log of the pipe to see how it ran. These logs are the first place to look for clues of what went wrong in a failed run. Verify that the entities have been written to the table in your database. If you need to run a query to view the data in the database, you can run <code class="docutils literal notranslate"><span class="pre">select</span> <span class="pre">*</span> <span class="pre">from</span> <span class="pre">person;</span></code>.</p></li>
</ol>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>The system config will be different depending on what type of database you are connecting to. Selecting a template will help with config creation. The Developer Guide also have full descriptions of the possible parameters of your system config. In many cases copying the “Example config” from the docs or selecting a config template and filling in the values to match your database server and authentication will be sufficient.</p></li>
<li><p>The SQL sink also has a lot of parameters for customizing your SQL operations, like the possibility to define a table’s columns in <code class="docutils literal notranslate"><span class="pre">schema_definition</span></code> and creating the table on a first run (this requires the system user to have the necessary permissions in the database) or a reset of the output pipe. Only the parameters “type”, “system” and “table” are required.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">pump-mode</span></code> environment variable is used to make sure an output pipe in a non-production environment does not export data unless the pipe is started manually. In a production environment <code class="docutils literal notranslate"><span class="pre">pump-mode</span></code> would be set as “scheduled” and the pipe’s pump config would include a “cron-expression” or “schedule_interval” that specifies when to run.</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="lab-26">
<span id="getting-started-labs-26"></span><h4>Lab 26<a class="headerlink" href="#lab-26" title="Permalink to this headline">#</a></h4>
<p>This lab covers:</p>
<ul class="simple">
<li><p><strong>Write data to an API endpoint</strong></p></li>
</ul>
<p>API’s are another common external system type that Sesam integrates with. Let’s try posting some data to jsonplaceholder.typicode.com, which is a API containing test data that we can also post data to. The data will not actually be saved and stored, but the status codes that the API returns are the same as if it did. The operation we want to imitate is described on this page <a class="reference external" href="https://jsonplaceholder.typicode.com/guide/">https://jsonplaceholder.typicode.com/guide/</a> under “Create a resource”.</p>
<div class="section" id="id29">
<h5>Task<a class="headerlink" href="#id29" title="Permalink to this headline">#</a></h5>
<ul class="simple">
<li><p>POST entities to an API. Follow the steps below:</p></li>
</ul>
<ol class="arabic simple">
<li><p>Create a URL system in Sesam named “typicode” with the base url <code class="docutils literal notranslate"><span class="pre">"https://jsonplaceholder.typicode.com/%s"</span></code> as its <code class="docutils literal notranslate"><span class="pre">url_pattern</span></code>. Store the url as an environment variable and refer to that in the system config.</p></li>
<li><p>Create a preparation pipe with some entities. You can for example copy the config of the preparation pipe of the previous task. Just remember to have the newly created system in the pipe name.</p></li>
<li><p>Create an output pipe with a JSON push sink. The sink needs to refer to the <code class="docutils literal notranslate"><span class="pre">"typicode"</span></code> system and have``”posts”`` as the <code class="docutils literal notranslate"><span class="pre">url</span></code> to append to the <code class="docutils literal notranslate"><span class="pre">url_pattern</span></code> of the system. Remember to set the pump’s mode to the <code class="docutils literal notranslate"><span class="pre">pump-mode</span></code> environment variable.</p></li>
<li><p>Run the output pipe and make sure you get a “pump-completed” entry in the execution log of the pipe.</p></li>
</ol>
<p>Tips</p>
<blockquote>
<div><ul class="simple">
<li><p>The URL system has more available parameters than we need for this test, i.e. for authentication. The REST system further expands the ability to customize our integrations with APIs.</p></li>
</ul>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="learn-more">
<h3>Learn more<a class="headerlink" href="#learn-more" title="Permalink to this headline">#</a></h3>
<p>We encourage you to play around and test more imports, transformations, enrichment and exports of data. Here are a few suggestions for what to do next.</p>
<ul class="simple">
<li><p>Get the data you exported back from your SQL database.</p></li>
<li><p>Import some of the test data available at <a class="reference external" href="http://jsonplaceholder.typicode.com">http://jsonplaceholder.typicode.com</a>.</p></li>
<li><p>Create an item dataset related to the webshop-orders in an input pipe with embedded source. Give some of the items IDs that correspond to the webshop-order dataset. Find or create a suitable global dataset to put the items in. Create payloads that combine data from people or orders with data from the item-entities.</p></li>
<li><p>Write data to an external system you have access to and that can be used for testing.</p></li>
<li><p>Try more DTL-functions like</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">case</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">case-eq</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matches</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">intersects/intersection</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">map</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key-values</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">discard</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rename</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make-ni</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ni-is</span> <span class="pre">and</span> <span class="pre">ni-id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">all</span></code> and <code class="docutils literal notranslate"><span class="pre">any</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">and</span></code> and <code class="docutils literal notranslate"><span class="pre">or</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">encrypt</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="solution-examples">
<span id="getting-started-labs-solution-examples"></span><h3>Solution examples<a class="headerlink" href="#solution-examples" title="Permalink to this headline">#</a></h3>
<p>As with most programming there is usually more than one way to reach a certain outcome. Below are suggestions for how to solve the labs in this guide.</p>
<div class="section" id="id30">
<h4>Lab 1<a class="headerlink" href="#id30" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"order-anonymized-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"webshop-order"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">,</span> <span class="s2">"customerId*"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"comment"</span><span class="p">,</span> <span class="s2">"Alternative solutions that produce the same results are shown in the comments below"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"comment"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"customerId"</span><span class="p">,</span> <span class="s2">"customerId-ni"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"comment"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"id"</span><span class="p">,</span> <span class="s2">"itemId"</span><span class="p">,</span> <span class="s2">"orderPlaced"</span><span class="p">,</span> <span class="s2">"quantity"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"comment"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">],</span>
          <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"id"</span><span class="p">],</span>
          <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"itemId"</span><span class="p">],</span>
          <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"orderPlaced"</span><span class="p">],</span>
          <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"quantity"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-copy-from-source.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-copy-from-source.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id31">
<h4>Lab 2<a class="headerlink" href="#id31" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"add-remove-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"crm-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"address-from-source"</span><span class="p">,</span> <span class="s2">"_S.Address"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"address-from-target"</span><span class="p">,</span> <span class="s2">"_T.address-from-source"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"remove"</span><span class="p">,</span> <span class="s2">"address-from-source"</span><span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-add-remove.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-add-remove.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id32">
<h4>Lab 3<a class="headerlink" href="#id32" title="Permalink to this headline">#</a></h4>
<p>System config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"geonorge"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"system:url"</span><span class="p">,</span>
  <span class="s2">"url_pattern"</span><span class="p">:</span> <span class="s2">"https://ws.geonorge.no/</span><span class="si">%s</span><span class="s2">"</span><span class="p">,</span>
  <span class="s2">"verify_ssl"</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id33">
<h4>Lab 4<a class="headerlink" href="#id33" title="Permalink to this headline">#</a></h4>
<p>System config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"geonorge"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"system:url"</span><span class="p">,</span>
  <span class="s2">"url_pattern"</span><span class="p">:</span> <span class="s2">"$ENV(geonorge-baseurl)"</span><span class="p">,</span>
  <span class="s2">"verify_ssl"</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Environment variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"geonorge-baseurl"</span><span class="p">:</span> <span class="s2">"https://ws.geonorge.no/</span><span class="si">%s</span><span class="s2">"</span><span class="p">,</span>
  <span class="s2">"node-env"</span><span class="p">:</span> <span class="s2">"test"</span><span class="p">,</span>
  <span class="s2">"pump-mode"</span><span class="p">:</span> <span class="s2">"manual"</span><span class="p">,</span>
  <span class="s2">"udir-baseurl"</span><span class="p">:</span> <span class="s2">"https://data-nxr-fellestjeneste.udir.no/api/</span><span class="si">%s</span><span class="s2">"</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Effective system config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"geonorge"</span><span class="p">,</span>
  <span class="s2">"connect_timeout"</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
  <span class="s2">"read_timeout"</span><span class="p">:</span> <span class="mi">1800</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"system:url"</span><span class="p">,</span>
  <span class="s2">"url_pattern"</span><span class="p">:</span> <span class="s2">"https://ws.geonorge.no/</span><span class="si">%s</span><span class="s2">"</span><span class="p">,</span>
  <span class="s2">"verify_ssl"</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id34">
<h4>Lab 5<a class="headerlink" href="#id34" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"geonorge-county"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="s2">"system"</span><span class="p">:</span> <span class="s2">"geonorge"</span><span class="p">,</span>
    <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"kommuneinfo/v1/fylkerkommuner"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"_S.fylkesnummer"</span><span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-input-pipe.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-input-pipe.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id35">
<h4>Lab 6<a class="headerlink" href="#id35" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"geonorge-county"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"conditional"</span><span class="p">,</span>
    <span class="s2">"alternatives"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"prod"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
        <span class="s2">"system"</span><span class="p">:</span> <span class="s2">"geonorge"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"kommuneinfo/v1/fylkerkommuner"</span>
      <span class="p">},</span>
      <span class="s2">"test"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"embedded"</span><span class="p">,</span>
        <span class="s2">"entities"</span><span class="p">:</span> <span class="p">[{</span><span class="o">...</span><span class="p">},{</span><span class="o">...</span><span class="p">}]</span>
        <span class="p">}]</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">"condition"</span><span class="p">:</span> <span class="s2">"$ENV(node-env)"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"_S.fylkesnummer"</span><span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The embedded entities are removed in this code snippet for brevity. They are found in the lab task text.</p>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-conditional-source.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-conditional-source.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id36">
<h4>Lab 7<a class="headerlink" href="#id36" title="Permalink to this headline">#</a></h4>
<p>Pipe configs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"global-location"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"merge"</span><span class="p">,</span>
    <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"udir-postalcode upc"</span><span class="p">,</span> <span class="s2">"geonorge-county gnc"</span><span class="p">],</span>
    <span class="s2">"identity"</span><span class="p">:</span> <span class="s2">"first"</span><span class="p">,</span>
    <span class="s2">"version"</span><span class="p">:</span> <span class="mi">2</span>
  <span class="p">},</span>
  <span class="s2">"metadata"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"global"</span><span class="p">:</span> <span class="n">true</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"merged-person"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"merge"</span><span class="p">,</span>
    <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"crm-person cp"</span><span class="p">,</span> <span class="s2">"hr-person hp"</span><span class="p">,</span> <span class="s2">"erp-person ep"</span><span class="p">,</span> <span class="s2">"salesforce-userprofile sup"</span><span class="p">,</span> <span class="s2">"salesforce-consent sc"</span><span class="p">,</span> <span class="s2">"mailerlite-person mp"</span><span class="p">],</span>
    <span class="s2">"equality"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"mp.SSN-ni"</span><span class="p">,</span> <span class="s2">"hp.$ids"</span><span class="p">],</span>
      <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"cp.SSN-ni"</span><span class="p">,</span> <span class="s2">"hp.$ids"</span><span class="p">],</span>
      <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"ep.SSN-ni"</span><span class="p">,</span> <span class="s2">"hp.$ids"</span><span class="p">],</span>
      <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"cp.Username"</span><span class="p">,</span> <span class="s2">"sup.Username"</span><span class="p">],</span>
      <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"sup.Username"</span><span class="p">,</span> <span class="s2">"sc.Username"</span><span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">"identity"</span><span class="p">:</span> <span class="s2">"first"</span><span class="p">,</span>
    <span class="s2">"version"</span><span class="p">:</span> <span class="mi">2</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"global-transaction"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"merge"</span><span class="p">,</span>
    <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"webshop-order wo"</span><span class="p">],</span>
    <span class="s2">"identity"</span><span class="p">:</span> <span class="s2">"first"</span><span class="p">,</span>
    <span class="s2">"version"</span><span class="p">:</span> <span class="mi">2</span>
  <span class="p">},</span>
  <span class="s2">"metadata"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"global"</span><span class="p">:</span> <span class="n">true</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output global-location:</p>
<a class="reference internal image-reference" href="_images/lab-global-location.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-global-location.png" style="width: 800px;"/></a>
<p>Output merged-person:</p>
<a class="reference internal image-reference" href="_images/lab-merged-person.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-merged-person.png" style="width: 800px;"/></a>
<p>Output global-person:</p>
<a class="reference internal image-reference" href="_images/lab-global-person.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-global-person.png" style="width: 800px;"/></a>
<p>Output global-transaction:</p>
<a class="reference internal image-reference" href="_images/lab-global-transaction.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-global-transaction.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id37">
<h4>Lab 8<a class="headerlink" href="#id37" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"filter-entities-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"filter"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"in"</span><span class="p">,</span> <span class="s2">"~:crm:person"</span><span class="p">,</span> <span class="s2">"_S.rdf:type"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-filter-entities.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-filter-entities.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id38">
<h4>Lab 9<a class="headerlink" href="#id38" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"namespace-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"hr-person:StreetAddress"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"erp-address"</span><span class="p">,</span> <span class="s2">"_S.erp-person:StreetAddress"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"crm-address"</span><span class="p">,</span> <span class="s2">"_S.crm-person:Address"</span><span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-namespaces.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-namespaces.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id39">
<h4>Lab 10<a class="headerlink" href="#id39" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"list-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"embedded"</span><span class="p">,</span>
    <span class="s2">"entities"</span><span class="p">:</span> <span class="p">[{</span>
      <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"1"</span>
    <span class="p">}]</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"list"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"first-item"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"first"</span><span class="p">,</span> <span class="s2">"_T.list"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"3rd-item"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"nth"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">"_T.list"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"count"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"count"</span><span class="p">,</span> <span class="s2">"_T.list"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"inserted-item"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"insert"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">"_T.list"</span><span class="p">,</span> <span class="s2">"e"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"sorted"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"sorted"</span><span class="p">,</span> <span class="s2">"_T.inserted-item"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-list.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-list.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id40">
<h4>Lab 11<a class="headerlink" href="#id40" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"global-person"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"merged-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"firstname"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.hr-person:GivenName"</span><span class="p">,</span> <span class="s2">"_S.crm-person:FirstName"</span><span class="p">,</span> <span class="s2">"_S.erp-person:GivenName"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"middle-initial"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.hr-person:MiddleInitial"</span><span class="p">,</span> <span class="s2">"_S.crm-person:MiddleInitial"</span><span class="p">,</span> <span class="s2">"_S.erp-person:MiddleInitial"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"lastname"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.hr-person:Surname"</span><span class="p">,</span> <span class="s2">"_S.crm-person:LastName"</span><span class="p">,</span> <span class="s2">"_S.erp-person:Surname"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"fullname"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"join"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_T.global-person:firstname"</span><span class="p">,</span>
              <span class="p">[</span><span class="s2">"if"</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"is-not-null"</span><span class="p">,</span> <span class="s2">"_T.global-person:middle-initial"</span><span class="p">],</span>
                <span class="p">[</span><span class="s2">"concat"</span><span class="p">,</span> <span class="s2">"_T.global-person:middle-initial"</span><span class="p">,</span> <span class="s2">"."</span><span class="p">]</span>
              <span class="p">],</span> <span class="s2">"_T.global-person:lastname"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"address"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.crm-person:Address"</span><span class="p">,</span> <span class="s2">"_S.hr-person:StreetAddress"</span><span class="p">,</span> <span class="s2">"_S.erp-person:StreetAddress"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.hr-person:ZipCode"</span><span class="p">,</span> <span class="s2">"_S.crm-person:PostalCode"</span><span class="p">,</span> <span class="s2">"_S.erp-person:ZipCode"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"city"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"first"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"hops"</span><span class="p">,</span> <span class="p">{</span>
              <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"global-location gl"</span><span class="p">],</span>
              <span class="s2">"where"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span>
                  <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.hr-person:ZipCode"</span><span class="p">,</span> <span class="s2">"_S.crm-person:PostalCode"</span><span class="p">,</span> <span class="s2">"_S.erp-person:ZipCode"</span><span class="p">]</span>
                  <span class="p">],</span> <span class="s2">"gl.udir-postalcode:postalcode"</span><span class="p">]</span>
              <span class="p">],</span>
              <span class="s2">"return"</span><span class="p">:</span> <span class="s2">"gl.city"</span>
            <span class="p">}]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"country"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.hr-person:Country"</span><span class="p">,</span> <span class="s2">"_S.erp-person:Country"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"gender"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.hr-person:Gender"</span><span class="p">,</span> <span class="s2">"_S.crm-person:Gender"</span><span class="p">,</span> <span class="s2">"_S.erp-person:Gender"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"email"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"coalesce"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_S.mailerlite-person:email"</span><span class="p">,</span> <span class="s2">"_S.crm-person.EmailAddress"</span><span class="p">,</span> <span class="s2">"_S.salesforce-userprofile:EmailAddress"</span><span class="p">,</span> <span class="s2">"_S.hr-person:EmailAddress"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">"metadata"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"global"</span><span class="p">:</span> <span class="n">true</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-golden-record.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-golden-record.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id41">
<h4>Lab 12<a class="headerlink" href="#id41" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"casting-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"filter"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"in"</span><span class="p">,</span> <span class="s2">"~:erp:person"</span><span class="p">,</span> <span class="s2">"_S.rdf:type"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"erp-person:*"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"TimesOrdered"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"string"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"plus"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
              <span class="p">[</span><span class="s2">"integer"</span><span class="p">,</span> <span class="s2">"_S.TimesOrdered"</span><span class="p">]</span>
            <span class="p">]</span>
          <span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-casting.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-casting.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id42">
<h4>Lab 13<a class="headerlink" href="#id42" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"string-logic-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"filter"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"in"</span><span class="p">,</span> <span class="s2">"~:hr:person"</span><span class="p">,</span> <span class="s2">"_S.rdf:type"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"hr-person:*"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"email-prefix"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"first"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"split"</span><span class="p">,</span> <span class="s2">"@"</span><span class="p">,</span> <span class="s2">"_S.hr-person:EmailAddress"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"capital-surname"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"upper"</span><span class="p">,</span> <span class="s2">"_S.hr-person:Surname"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"date-of-birth"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"join"</span><span class="p">,</span> <span class="s2">"."</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span>
              <span class="p">[</span><span class="s2">"substring"</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">"_S.hr-person:SSN"</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">"substring"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">"_S.hr-person:SSN"</span><span class="p">],</span>
              <span class="p">[</span><span class="s2">"substring"</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">"_S.hr-person:SSN"</span><span class="p">]</span>
            <span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"title"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"rstrip"</span><span class="p">,</span> <span class="s2">"."</span><span class="p">,</span> <span class="s2">"_S.hr-person:Title"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-strings.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-strings.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id43">
<h4>Lab 14<a class="headerlink" href="#id43" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"datetime-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-transaction"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"filter"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"in"</span><span class="p">,</span> <span class="s2">"~:webshop:order"</span><span class="p">,</span> <span class="s2">"_S.rdf:type"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"orderPlaced"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"orderPlaced-datetime"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"datetime-parse"</span><span class="p">,</span> <span class="s2">"%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S"</span><span class="p">,</span> <span class="s2">"_S.orderPlaced"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"orderPlaced-date"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"datetime-format"</span><span class="p">,</span> <span class="s2">"</span><span class="si">%d</span><span class="s2">.%m.%Y"</span><span class="p">,</span> <span class="s2">"_T.orderPlaced-datetime"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"orderPlaced-plus72h"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"datetime-plus"</span><span class="p">,</span> <span class="s2">"hour"</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="s2">"_T.orderPlaced-datetime"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"orderPlaced-days-since"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"datetime-diff"</span><span class="p">,</span> <span class="s2">"day"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"now"</span><span class="p">],</span> <span class="s2">"_T.orderPlaced-datetime"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-datetime.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-datetime.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id44">
<h4>Lab 15<a class="headerlink" href="#id44" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"comparison-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"filter"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"in"</span><span class="p">,</span> <span class="s2">"~:erp:person"</span><span class="p">,</span> <span class="s2">"_S.rdf:type"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"erp-person:*"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"if"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"gte"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"integer"</span><span class="p">,</span> <span class="s2">"_S.MoneyUsed"</span><span class="p">],</span> <span class="mi">10000</span><span class="p">],</span>
          <span class="p">[</span>
            <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"big-spender"</span><span class="p">,</span> <span class="n">true</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"foo"</span><span class="p">,</span> <span class="s2">"bar"</span><span class="p">]</span>
          <span class="p">],</span>
          <span class="p">[</span>
            <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"big-spender"</span><span class="p">,</span> <span class="n">false</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"foo"</span><span class="p">,</span> <span class="s2">"bar"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"comment"</span><span class="p">,</span> <span class="s2">"Alternative code below"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"big-spender"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"if"</span><span class="p">,</span>
              <span class="p">[</span><span class="s2">"gte"</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"integer"</span><span class="p">,</span> <span class="s2">"_S.MoneyUsed"</span><span class="p">],</span> <span class="mi">10000</span><span class="p">],</span> <span class="n">true</span><span class="p">,</span> <span class="n">false</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-comparisons.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-comparisons.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id45">
<h4>Lab 16<a class="headerlink" href="#id45" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"filter-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"filter"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"and"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.global-person:gender"</span><span class="p">,</span> <span class="s2">"female"</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span>
              <span class="p">[</span><span class="s2">"last"</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"split"</span><span class="p">,</span> <span class="s2">"@"</span><span class="p">,</span> <span class="s2">"_S.global-person:email"</span><span class="p">]</span>
              <span class="p">],</span> <span class="s2">"dayrep.com"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-filter.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-filter.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id46">
<h4>Lab 17<a class="headerlink" href="#id46" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"apply-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"embedded"</span><span class="p">,</span>
    <span class="s2">"entities"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"1"</span><span class="p">,</span>
      <span class="s2">"list"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"some string"</span><span class="p">,</span> <span class="n">false</span><span class="p">,</span> <span class="s2">"another string"</span><span class="p">,</span> <span class="mi">45678908765</span><span class="p">,</span> <span class="s2">"abcd"</span><span class="p">,</span> <span class="s2">"STRING"</span><span class="p">,</span> <span class="n">true</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="s2">"132456"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"merge-union"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"apply"</span><span class="p">,</span> <span class="s2">"type-check"</span><span class="p">,</span> <span class="s2">"_S.list"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="s2">"type-check"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"if"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"is-string"</span><span class="p">,</span> <span class="s2">"_S."</span><span class="p">],</span>
          <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"result"</span><span class="p">,</span> <span class="s2">"_S."</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-apply.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-apply.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id47">
<h4>Lab 18<a class="headerlink" href="#id47" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"geonorge-municipalities"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"geonorge-county"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"chained"</span><span class="p">,</span>
    <span class="s2">"transforms"</span><span class="p">:</span> <span class="p">[{</span>
      <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
      <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">[</span><span class="s2">"filter"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"neq"</span><span class="p">,</span> <span class="s2">"_S._deleted"</span><span class="p">,</span> <span class="n">true</span><span class="p">]</span>
          <span class="p">],</span>
          <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">],</span>
          <span class="p">[</span><span class="s2">"create-child"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"apply"</span><span class="p">,</span> <span class="s2">"build-municipality"</span><span class="p">,</span> <span class="s2">"_S.kommuner"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="s2">"build-municipality"</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
          <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"_S.kommunenummer"</span><span class="p">],</span>
          <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"rdf:type"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"ni"</span><span class="p">,</span> <span class="s2">"geonorge"</span><span class="p">,</span> <span class="s2">"municipality"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">},</span> <span class="p">{</span>
      <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"emit_children"</span>
    <span class="p">}]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-create-child.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-create-child.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id48">
<h4>Lab 19<a class="headerlink" href="#id48" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"udir-postalcode"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"conditional"</span><span class="p">,</span>
    <span class="s2">"alternatives"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"prod"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
        <span class="s2">"system"</span><span class="p">:</span> <span class="s2">"udir"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"v1/postnummerdata"</span>
      <span class="p">},</span>
      <span class="s2">"test"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"embedded"</span><span class="p">,</span>
        <span class="s2">"entities"</span><span class="p">:</span> <span class="p">[{</span><span class="o">...</span><span class="p">},{</span><span class="o">...</span><span class="p">}]</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">"condition"</span><span class="p">:</span> <span class="s2">"$ENV(node-env)"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"comment"</span><span class="p">,</span> <span class="s2">"The discard and renames in this pipe is done to simplify and translate the dataset for this guide"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"discard"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"and"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"in"</span><span class="p">,</span> <span class="s2">"_S.FylkeNummer"</span><span class="p">,</span>
              <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"03"</span><span class="p">,</span> <span class="s2">"11"</span><span class="p">,</span> <span class="s2">"15"</span><span class="p">,</span> <span class="s2">"18"</span><span class="p">,</span> <span class="s2">"30"</span><span class="p">,</span> <span class="s2">"34"</span><span class="p">,</span> <span class="s2">"38"</span><span class="p">,</span> <span class="s2">"42"</span><span class="p">,</span> <span class="s2">"46"</span><span class="p">,</span> <span class="s2">"50"</span><span class="p">,</span> <span class="s2">"54"</span><span class="p">]</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">"is-null"</span><span class="p">,</span> <span class="s2">"_S.ArvtakerPostnummerDataIdListe"</span><span class="p">]</span>
          <span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"_S.PostNummer"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"rename"</span><span class="p">,</span> <span class="s2">"KommuneNummer"</span><span class="p">,</span> <span class="s2">"municipality"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"rename"</span><span class="p">,</span> <span class="s2">"PostNummer"</span><span class="p">,</span> <span class="s2">"postalcode"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"rename"</span><span class="p">,</span> <span class="s2">"PostSted"</span><span class="p">,</span> <span class="s2">"city"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"rdf:type"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"ni"</span><span class="p">,</span> <span class="s2">"udir"</span><span class="p">,</span> <span class="s2">"postalcode"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"municipality-ni"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"ni"</span><span class="p">,</span> <span class="s2">"geonorge-municipality"</span><span class="p">,</span> <span class="s2">"_T.municipality"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Because the “municipality” attribute is a rename from a differently named attribute in the source we have used the “_T” variable to refer to it. Refering to “_S.KommuneNummer” would yield the same result. The embedded entities are removed in this code snippet for brevity. They are found in the lab task text.</p>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-municipality-ni.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-municipality-ni.png" style="width: 800px;"/></a>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"geonorge-county"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"conditional"</span><span class="p">,</span>
    <span class="s2">"alternatives"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"prod"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
        <span class="s2">"system"</span><span class="p">:</span> <span class="s2">"geonorge"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"kommuneinfo/v1/fylkerkommuner"</span>
      <span class="p">},</span>
      <span class="s2">"test"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"embedded"</span><span class="p">,</span>
        <span class="s2">"entities"</span><span class="p">:</span> <span class="p">[{</span><span class="o">...</span><span class="p">},{</span><span class="o">...</span><span class="p">}]</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">"condition"</span><span class="p">:</span> <span class="s2">"$ENV(node-env)"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"_S.fylkesnummer"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"rdf:type"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"ni"</span><span class="p">,</span> <span class="s2">"geonorge"</span><span class="p">,</span> <span class="s2">"county"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The embedded entities are removed in this code snippet for brevity. They are found in the lab task text.</p>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-rdf:type.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-rdf:type.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id49">
<h4>Lab 20<a class="headerlink" href="#id49" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"hops-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"filter"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"in"</span><span class="p">,</span> <span class="s2">"~:erp:person"</span><span class="p">,</span> <span class="s2">"_S.rdf:type"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"global-person:fullname"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"items"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"hops"</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"global-transaction gt"</span><span class="p">],</span>
            <span class="s2">"where"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.$ids"</span><span class="p">,</span> <span class="s2">"gt.webshop-order:customerId-ni"</span><span class="p">],</span>
            <span class="s2">"return"</span><span class="p">:</span> <span class="s2">"gt.webshop-order:itemId"</span>
          <span class="p">}]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-hops.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-hops.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id50">
<h4>Lab 21<a class="headerlink" href="#id50" title="Permalink to this headline">#</a></h4>
<p>Pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"apply-hops-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"comment"</span><span class="p">,</span> <span class="s2">"Copying the zipcode is not needed. We have done it in this example to display which postalcode the data is from."</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"global-person:zipcode"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"merge"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"apply-hops"</span><span class="p">,</span> <span class="s2">"city-location"</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"global-location gl"</span><span class="p">],</span>
            <span class="s2">"where"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.global-person:zipcode"</span><span class="p">,</span> <span class="s2">"gl.udir-postalcode:postalcode"</span><span class="p">]</span>
          <span class="p">}]</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="s2">"city-location"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"location"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"concat"</span><span class="p">,</span> <span class="s2">"_S.city"</span><span class="p">,</span> <span class="s2">" is located in municipality number "</span><span class="p">,</span> <span class="s2">"_S.municipality"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"merge"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"apply-hops"</span><span class="p">,</span> <span class="s2">"latitude-check"</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"global-location gl"</span><span class="p">],</span>
            <span class="s2">"where"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.municipality-ni"</span><span class="p">,</span> <span class="s2">"gl.$ids"</span><span class="p">]</span>
          <span class="p">}]</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="s2">"latitude-check"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"arctic-municipality"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"if"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"gte"</span><span class="p">,</span>
              <span class="p">[</span><span class="s2">"last"</span><span class="p">,</span> <span class="s2">"_S.punktIOmrade.coordinates"</span><span class="p">],</span> <span class="s2">"~f66.33"</span><span class="p">],</span> <span class="n">true</span><span class="p">,</span> <span class="n">false</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<a class="reference internal image-reference" href="_images/lab-apply-hops.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-apply-hops.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id51">
<h4>Lab 22<a class="headerlink" href="#id51" title="Permalink to this headline">#</a></h4>
<p>Config from pipe in previous lab with added property “foo”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"apply-hops-labs"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"comment"</span><span class="p">,</span> <span class="s2">"Copying the zipcode is not needed. We have done it in this example to display which postalcode the data is from."</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"global-person:zipcode"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"merge"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"apply-hops"</span><span class="p">,</span> <span class="s2">"city-location"</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"global-location gl"</span><span class="p">],</span>
            <span class="s2">"where"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.global-person:zipcode"</span><span class="p">,</span> <span class="s2">"gl.udir-postalcode:postalcode"</span><span class="p">]</span>
          <span class="p">}]</span>
        <span class="p">]</span>
      <span class="p">],</span>
      <span class="s2">"city-location"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"location"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"concat"</span><span class="p">,</span> <span class="s2">"_S.city"</span><span class="p">,</span> <span class="s2">" is located in municipality number "</span><span class="p">,</span> <span class="s2">"_S.municipality"</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"merge"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"apply-hops"</span><span class="p">,</span> <span class="s2">"latitude-check"</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">"datasets"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"global-location gl"</span><span class="p">],</span>
            <span class="s2">"where"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"eq"</span><span class="p">,</span> <span class="s2">"_S.municipality-ni"</span><span class="p">,</span> <span class="s2">"gl.$ids"</span><span class="p">]</span>
          <span class="p">}]</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"foo"</span><span class="p">,</span> <span class="s2">"bar"</span><span class="p">]</span>
      <span class="p">],</span>
      <span class="s2">"latitude-check"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"arctic-municipality"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"if"</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"gte"</span><span class="p">,</span>
              <span class="p">[</span><span class="s2">"last"</span><span class="p">,</span> <span class="s2">"_S.punktIOmrade.coordinates"</span><span class="p">],</span> <span class="s2">"~f66.33"</span><span class="p">],</span> <span class="n">true</span><span class="p">,</span> <span class="n">false</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output after pipe run without reset:</p>
<a class="reference internal image-reference" href="_images/lab-apply-hops.png"><img alt="No changes to entities output by the pipe" class="align-center" src="_images/lab-apply-hops.png" style="width: 800px;"/></a>
<p>Output after pipe is reset and run:</p>
<a class="reference internal image-reference" href="_images/lab-change-tracking-reset-result.png"><img alt="All entities are updated with the new property" class="align-center" src="_images/lab-change-tracking-reset-result.png" style="width: 800px;"/></a>
<p>Change to the new property’s value in the config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">"add"</span><span class="p">,</span> <span class="s2">"foo"</span><span class="p">,</span> <span class="s2">"a different value"</span><span class="p">]</span>
</pre></div>
</div>
<p>Locate the sequence number of an entity in the source dataset:</p>
<a class="reference internal image-reference" href="_images/lab-change-tracking-sequence-number.png"><img alt="Locate the sequence number of entities in the source" class="align-center" src="_images/lab-change-tracking-sequence-number.png" style="width: 800px;"/></a>
<p>Input the sequence number of the source entity as the pipe’s “last seen” value:</p>
<a class="reference internal image-reference" href="_images/lab-change-tracking-last-seen.png"><img alt='Input the sequence number as "last seen"' class="align-center" src="_images/lab-change-tracking-last-seen.png" style="width: 800px;"/></a>
<p>Results after running the pipe from the new pipe offset:</p>
<a class="reference internal image-reference" href="_images/lab-change-tracking-lastseen-result.png"><img alt="Only the three latest entities are updated" class="align-center" src="_images/lab-change-tracking-lastseen-result.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id52">
<h4>Lab 23<a class="headerlink" href="#id52" title="Permalink to this headline">#</a></h4>
<p>preparation pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"person-csv"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"global-person:*"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"firstname"</span><span class="p">,</span> <span class="s2">"middle-initial"</span><span class="p">,</span> <span class="s2">"lastname"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"person-csv-endpoint"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"person-csv"</span>
  <span class="p">},</span>
  <span class="s2">"sink"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"csv_endpoint"</span><span class="p">,</span>
    <span class="s2">"columns"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"address"</span><span class="p">,</span> <span class="s2">"country"</span><span class="p">,</span> <span class="s2">"email"</span><span class="p">,</span> <span class="s2">"fullname"</span><span class="p">,</span> <span class="s2">"gender"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">address</span><span class="p">,</span><span class="n">country</span><span class="p">,</span><span class="n">email</span><span class="p">,</span><span class="n">fullname</span><span class="p">,</span><span class="n">gender</span><span class="p">,</span><span class="n">zipcode</span>
<span class="n">Helmers</span> <span class="n">vei</span> <span class="mi">242</span><span class="p">,</span><span class="n">NO</span><span class="p">,</span><span class="n">torjus</span><span class="nd">@gmail</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">Torjus</span> <span class="n">M</span><span class="o">.</span> <span class="n">Sand</span><span class="p">,</span><span class="n">male</span><span class="p">,</span><span class="mi">5031</span>
<span class="n">Frognerveien</span> <span class="mi">60</span><span class="p">,</span><span class="n">NO</span><span class="p">,</span><span class="n">larsevjen</span><span class="nd">@rhyta</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">Lars</span> <span class="n">Evjen</span><span class="p">,</span><span class="n">male</span><span class="p">,</span><span class="mi">3121</span>
<span class="n">Gydas</span> <span class="n">gate</span> <span class="mi">227</span><span class="p">,</span><span class="n">NO</span><span class="p">,</span><span class="n">siri</span><span class="nd">@me</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">Siri</span> <span class="n">Olsen</span><span class="p">,</span><span class="n">female</span><span class="p">,</span><span class="mi">3733</span>
<span class="n">Nadderudåsen</span> <span class="mi">186</span><span class="p">,</span><span class="n">NO</span><span class="p">,</span><span class="n">isakeikeland</span><span class="nd">@teleworm</span><span class="o">.</span><span class="n">us</span><span class="p">,</span><span class="n">Isak</span> <span class="n">E</span><span class="o">.</span> <span class="n">Eikeland</span><span class="p">,</span><span class="n">male</span><span class="p">,</span><span class="mi">9325</span>
<span class="n">Sommerfjøsvegen</span> <span class="mi">143</span><span class="p">,</span><span class="n">NO</span><span class="p">,</span><span class="n">sebastianskjold</span><span class="nd">@dayrep</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">Sebastian</span> <span class="n">T</span><span class="o">.</span> <span class="n">Skjold</span><span class="p">,</span><span class="n">male</span><span class="p">,</span><span class="mi">7080</span>
<span class="n">Kongens</span> <span class="n">gate</span> <span class="mi">69</span><span class="p">,</span><span class="n">NO</span><span class="p">,</span><span class="n">caspiannygard</span><span class="nd">@einrot</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">Caspian</span> <span class="n">I</span><span class="o">.</span> <span class="n">Nygård</span><span class="p">,</span><span class="n">male</span><span class="p">,</span><span class="mi">0153</span>
<span class="n">Åsmostubben</span> <span class="mi">19</span><span class="p">,</span><span class="n">NO</span><span class="p">,</span><span class="n">davidberntsen</span><span class="nd">@superrito</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">David</span> <span class="n">M</span><span class="o">.</span> <span class="n">Berntsen</span><span class="p">,</span><span class="n">male</span><span class="p">,</span><span class="mi">9011</span>
<span class="n">Fagerliveien</span> <span class="mi">108</span><span class="p">,</span><span class="n">NO</span><span class="p">,</span><span class="n">lucaslie</span><span class="nd">@cuvox</span><span class="o">.</span><span class="n">de</span><span class="p">,</span><span class="n">Lucas</span> <span class="n">T</span><span class="o">.</span> <span class="n">Lie</span><span class="p">,</span><span class="n">male</span><span class="p">,</span><span class="mi">1605</span>
<span class="n">Zetlitzveien</span> <span class="mi">241</span><span class="p">,,</span><span class="n">julieandersen</span><span class="nd">@superrito</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">Julie</span> <span class="n">I</span><span class="o">.</span> <span class="n">Andersen</span><span class="p">,</span><span class="n">female</span><span class="p">,</span><span class="mi">4017</span>
<span class="n">Kong</span> <span class="n">Trygves</span> <span class="n">vei</span> <span class="mi">32</span><span class="p">,</span><span class="n">NO</span><span class="p">,</span><span class="n">camillawilhelmsen</span><span class="nd">@dayrep</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">Camilla</span> <span class="n">M</span><span class="o">.</span> <span class="n">Wilhelmsen</span><span class="p">,</span><span class="n">female</span><span class="p">,</span><span class="mi">3125</span>
<span class="n">Norderhovsgata</span> <span class="mi">63</span><span class="p">,</span><span class="n">NO</span><span class="p">,</span><span class="n">RuneWold</span><span class="nd">@armyspy</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">Rune</span> <span class="n">E</span><span class="o">.</span> <span class="n">Wold</span><span class="p">,</span><span class="n">male</span><span class="p">,</span><span class="mi">3501</span>
<span class="n">Bøkleva</span> <span class="mi">141</span><span class="p">,</span><span class="n">NO</span><span class="p">,</span><span class="n">WilliamFauske</span><span class="nd">@jourrapide</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">William</span> <span class="n">H</span><span class="o">.</span> <span class="n">Fauske</span><span class="p">,</span><span class="n">male</span><span class="p">,</span><span class="mi">1766</span>
<span class="n">Drengs</span> <span class="mi">36</span><span class="p">,</span><span class="n">NO</span><span class="p">,,</span><span class="n">Aleksander</span> <span class="n">M</span><span class="o">.</span> <span class="n">Ommundsen</span><span class="p">,</span><span class="n">male</span><span class="p">,</span><span class="mi">1390</span>
<span class="n">Tiurvegen</span> <span class="n">vei</span><span class="p">,</span><span class="n">NO</span><span class="p">,,</span><span class="n">Erika</span> <span class="n">L</span><span class="o">.</span> <span class="n">Olsen</span><span class="p">,</span><span class="n">female</span><span class="p">,</span><span class="mi">8657</span>
</pre></div>
</div>
</div>
<div class="section" id="id53">
<h4>Lab 24<a class="headerlink" href="#id53" title="Permalink to this headline">#</a></h4>
<p>preparation pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"person-http"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span> <span class="s2">"global-person:*"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"firstname"</span><span class="p">,</span> <span class="s2">"middle-initial"</span><span class="p">,</span> <span class="s2">"lastname"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Output pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"person-http-endpoint"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"person-http"</span>
  <span class="p">},</span>
  <span class="s2">"sink"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"http_endpoint"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Creating JWT:</p>
<a class="reference internal image-reference" href="_images/lab-jwt.png"><img alt="JWT creation on Subscription settings page" class="align-center" src="_images/lab-jwt.png" style="width: 800px;"/></a>
<p>cURL command with newly created JWT:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -H "Authorization: bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOjE1OTcyNjcyMzYuOTEwNTA2NywiZXhwIjoxNTk3NjEyMzgwLCJ1c2VyX2lkIjoiY2VlNDUxZDQtMDYwMC00NDk5LThkN2QtYjk3NGI4YTRlOTA1IiwidXNlcl9wcm9maWxlIjp7ImVtYWlsIjoicGFsLmFuZHJlYXNzZW5Ac2VzYW0uaW8iLCJuYW1lIjoiUFx1MDBlNWwgQW5kcmVhc3NlbiIsInBpY3R1cmUiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20vdjEuMC9tZS9waG90by8kdmFsdWUifSwidXNlcl9wcmluY2lwYWwiOiJncm91cDpFdmVyeW9uZSIsInByaW5jaXBhbHMiOnsiMTE3ZGNlYWEtZDY1OC00OTg2LTg5ZjktZDczOGIxMmMxNjlkIjpbImdyb3VwOkFkbWluIl19LCJhcGlfdG9rZW5faWQiOiIxOGEyNGQ0Mi0yOGVmLTQ0NGYtODM4NC1hOGVjMjEzM2FhOGQifQ.VT0PCDnEBraFk1pCSlO7d92zkD3MOhOvfdiLy7J6oAy6M77h1YbYKZRumzYUyg_XK8NXaginrK_pH563875S4nUZqINKiAnDJ0HYI9gQmABT2U8XQxeF-LlePpcxCI-UZarRiW_f2yQNYWqV_bJ3PmltodX2SUHjOmTcpqwVJvCqMSTqmCVqy6gPyQw6MTvzffP78MvmSb8fy8KcFP8H1rS4MilI9OnVWs9K3YaaXLs1SIxhAQrvjH2XlgwzMoCh05TpWPuiO1ph09fVI1U85uC59Q4e45bEpxMJmRuJ7RqEUdFR5RbSovqorB4Wxf8Cs0gFKMZxzj74eenMGjDJPg" https://datahub-117dceaa.sesam.cloud/api/publishers/person-http-endpoint/entities?limit=15
</pre></div>
</div>
<p>Exposed data in the HTTP-endpoint:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s2">"address"</span><span class="p">:</span> <span class="s2">"Helmers vei 242"</span><span class="p">,</span> <span class="s2">"country"</span><span class="p">:</span> <span class="s2">"NO"</span><span class="p">,</span> <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"torjus@gmail.com"</span><span class="p">,</span> <span class="s2">"fullname"</span><span class="p">:</span> <span class="s2">"Torjus M. Sand"</span><span class="p">,</span> <span class="s2">"gender"</span><span class="p">:</span> <span class="s2">"male"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">:</span> <span class="s2">"5031"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"1"</span><span class="p">,</span> <span class="s2">"_deleted"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="s2">"_updated"</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">"_previous"</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">"_ts"</span><span class="p">:</span> <span class="mi">1597266361399643</span><span class="p">,</span> <span class="s2">"_hash"</span><span class="p">:</span> <span class="s2">"8a70306f3bcdb13714b62fa0dd5e8045"</span><span class="p">},{</span><span class="s2">"address"</span><span class="p">:</span> <span class="s2">"Frognerveien 60"</span><span class="p">,</span> <span class="s2">"country"</span><span class="p">:</span> <span class="s2">"NO"</span><span class="p">,</span> <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"larsevjen@rhyta.com"</span><span class="p">,</span> <span class="s2">"fullname"</span><span class="p">:</span> <span class="s2">"Lars Evjen"</span><span class="p">,</span> <span class="s2">"gender"</span><span class="p">:</span> <span class="s2">"male"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">:</span> <span class="s2">"3121"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"2"</span><span class="p">,</span> <span class="s2">"_deleted"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="s2">"_updated"</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">"_previous"</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">"_ts"</span><span class="p">:</span> <span class="mi">1597266361399655</span><span class="p">,</span> <span class="s2">"_hash"</span><span class="p">:</span> <span class="s2">"821a5f4092874ae9d2b4e72819520ec5"</span><span class="p">},{</span><span class="s2">"address"</span><span class="p">:</span> <span class="s2">"Gydas gate 227"</span><span class="p">,</span> <span class="s2">"country"</span><span class="p">:</span> <span class="s2">"NO"</span><span class="p">,</span> <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"siri@me.com"</span><span class="p">,</span> <span class="s2">"fullname"</span><span class="p">:</span> <span class="s2">"Siri Olsen"</span><span class="p">,</span> <span class="s2">"gender"</span><span class="p">:</span> <span class="s2">"female"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">:</span> <span class="s2">"3733"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"3"</span><span class="p">,</span> <span class="s2">"_deleted"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="s2">"_updated"</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">"_previous"</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">"_ts"</span><span class="p">:</span> <span class="mi">1597266361399666</span><span class="p">,</span> <span class="s2">"_hash"</span><span class="p">:</span> <span class="s2">"f8a5460cc0b8f25654e0581396fe9a8e"</span><span class="p">},{</span><span class="s2">"address"</span><span class="p">:</span> <span class="s2">"Nadderudåsen 186"</span><span class="p">,</span> <span class="s2">"country"</span><span class="p">:</span> <span class="s2">"NO"</span><span class="p">,</span> <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"isakeikeland@teleworm.us"</span><span class="p">,</span> <span class="s2">"fullname"</span><span class="p">:</span> <span class="s2">"Isak E. Eikeland"</span><span class="p">,</span> <span class="s2">"gender"</span><span class="p">:</span> <span class="s2">"male"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">:</span> <span class="s2">"9325"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"100"</span><span class="p">,</span> <span class="s2">"_deleted"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="s2">"_updated"</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">"_previous"</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">"_ts"</span><span class="p">:</span> <span class="mi">1597266361399677</span><span class="p">,</span> <span class="s2">"_hash"</span><span class="p">:</span> <span class="s2">"f8a2aa8ef24b41ed18cbb9462790fa38"</span><span class="p">},{</span><span class="s2">"address"</span><span class="p">:</span> <span class="s2">"Sommerfjøsvegen 143"</span><span class="p">,</span> <span class="s2">"country"</span><span class="p">:</span> <span class="s2">"NO"</span><span class="p">,</span> <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"sebastianskjold@dayrep.com"</span><span class="p">,</span> <span class="s2">"fullname"</span><span class="p">:</span> <span class="s2">"Sebastian T. Skjold"</span><span class="p">,</span> <span class="s2">"gender"</span><span class="p">:</span> <span class="s2">"male"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">:</span> <span class="s2">"7080"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"99"</span><span class="p">,</span> <span class="s2">"_deleted"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="s2">"_updated"</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">"_previous"</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">"_ts"</span><span class="p">:</span> <span class="mi">1597266361399689</span><span class="p">,</span> <span class="s2">"_hash"</span><span class="p">:</span> <span class="s2">"f576c6956daa30c4ab05192440117a4f"</span><span class="p">},{</span><span class="s2">"address"</span><span class="p">:</span> <span class="s2">"Kongens gate 69"</span><span class="p">,</span> <span class="s2">"country"</span><span class="p">:</span> <span class="s2">"NO"</span><span class="p">,</span> <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"caspiannygard@einrot.com"</span><span class="p">,</span> <span class="s2">"fullname"</span><span class="p">:</span> <span class="s2">"Caspian I. Nygård"</span><span class="p">,</span> <span class="s2">"gender"</span><span class="p">:</span> <span class="s2">"male"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">:</span> <span class="s2">"0153"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"93"</span><span class="p">,</span> <span class="s2">"_deleted"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="s2">"_updated"</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">"_previous"</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">"_ts"</span><span class="p">:</span> <span class="mi">1597266361399701</span><span class="p">,</span> <span class="s2">"_hash"</span><span class="p">:</span> <span class="s2">"367cee1c0315ac189d0caccd76ab1a14"</span><span class="p">},{</span><span class="s2">"address"</span><span class="p">:</span> <span class="s2">"Åsmostubben 19"</span><span class="p">,</span> <span class="s2">"country"</span><span class="p">:</span> <span class="s2">"NO"</span><span class="p">,</span> <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"davidberntsen@superrito.com"</span><span class="p">,</span> <span class="s2">"fullname"</span><span class="p">:</span> <span class="s2">"David M. Berntsen"</span><span class="p">,</span> <span class="s2">"gender"</span><span class="p">:</span> <span class="s2">"male"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">:</span> <span class="s2">"9011"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"91"</span><span class="p">,</span> <span class="s2">"_deleted"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="s2">"_updated"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">"_previous"</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">"_ts"</span><span class="p">:</span> <span class="mi">1597266361399712</span><span class="p">,</span> <span class="s2">"_hash"</span><span class="p">:</span> <span class="s2">"b21ffc16fdfd6382d62a8b71d055d0d8"</span><span class="p">},{</span><span class="s2">"address"</span><span class="p">:</span> <span class="s2">"Fagerliveien 108"</span><span class="p">,</span> <span class="s2">"country"</span><span class="p">:</span> <span class="s2">"NO"</span><span class="p">,</span> <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"lucaslie@cuvox.de"</span><span class="p">,</span> <span class="s2">"fullname"</span><span class="p">:</span> <span class="s2">"Lucas T. Lie"</span><span class="p">,</span> <span class="s2">"gender"</span><span class="p">:</span> <span class="s2">"male"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">:</span> <span class="s2">"1605"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"90"</span><span class="p">,</span> <span class="s2">"_deleted"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="s2">"_updated"</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">"_previous"</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">"_ts"</span><span class="p">:</span> <span class="mi">1597266361399724</span><span class="p">,</span> <span class="s2">"_hash"</span><span class="p">:</span> <span class="s2">"51266239e58e092fb537a0a0210242e6"</span><span class="p">},{</span><span class="s2">"address"</span><span class="p">:</span> <span class="s2">"Zetlitzveien 241"</span><span class="p">,</span> <span class="s2">"country"</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"julieandersen@superrito.com"</span><span class="p">,</span> <span class="s2">"fullname"</span><span class="p">:</span> <span class="s2">"Julie I. Andersen"</span><span class="p">,</span> <span class="s2">"gender"</span><span class="p">:</span> <span class="s2">"female"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">:</span> <span class="s2">"4017"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"80"</span><span class="p">,</span> <span class="s2">"_deleted"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="s2">"_updated"</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">"_previous"</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">"_ts"</span><span class="p">:</span> <span class="mi">1597266361399735</span><span class="p">,</span> <span class="s2">"_hash"</span><span class="p">:</span> <span class="s2">"109324caa77563a1f1a465ecc19f20fc"</span><span class="p">},{</span><span class="s2">"address"</span><span class="p">:</span> <span class="s2">"Kong Trygves vei 32"</span><span class="p">,</span> <span class="s2">"country"</span><span class="p">:</span> <span class="s2">"NO"</span><span class="p">,</span> <span class="s2">"email"</span><span class="p">:</span> <span class="s2">"camillawilhelmsen@dayrep.com"</span><span class="p">,</span> <span class="s2">"fullname"</span><span class="p">:</span> <span class="s2">"Camilla M. Wilhelmsen"</span><span class="p">,</span> <span class="s2">"gender"</span><span class="p">:</span> <span class="s2">"female"</span><span class="p">,</span> <span class="s2">"zipcode"</span><span class="p">:</span> <span class="s2">"3125"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"81"</span><span class="p">,</span> <span class="s2">"_deleted"</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="s2">"_updated"</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span> <span class="s2">"_previous"</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">"_ts"</span><span class="p">:</span> <span class="mi">1597266361399747</span><span class="p">,</span> <span class="s2">"_hash"</span><span class="p">:</span> <span class="s2">"8b5942cbc58a4f5dedc114234de95327"</span><span class="p">}]</span>
</pre></div>
</div>
</div>
<div class="section" id="id54">
<h4>Lab 25<a class="headerlink" href="#id54" title="Permalink to this headline">#</a></h4>
<p>Postgres database connection info:</p>
<a class="reference internal image-reference" href="_images/lab-db-info.png"><img alt="The connection info to an example online database for used in this lab example solution" class="align-center" src="_images/lab-db-info.png" style="width: 500px;"/></a>
<p>System config:</p>
<a class="reference internal image-reference" href="_images/lab-db-system.png"><img alt="A system config matching the connection info to the database in the previous image" class="align-center" src="_images/lab-db-system.png" style="width: 800px;"/></a>
<p>preparation pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"person-elephantdb"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"global-person:firstname"</span><span class="p">,</span> <span class="s2">"global-person:lastname"</span><span class="p">,</span> <span class="s2">"global-person:address"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>preparation pipe output:</p>
<a class="reference internal image-reference" href="_images/lab-db-prep-pipe.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-db-prep-pipe.png" style="width: 800px;"/></a>
<p>Output pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"person-elephantdb-endpoint"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"person-elephantdb"</span>
  <span class="p">},</span>
  <span class="s2">"sink"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"sql"</span><span class="p">,</span>
    <span class="s2">"system"</span><span class="p">:</span> <span class="s2">"elephantdb"</span><span class="p">,</span>
    <span class="s2">"table"</span><span class="p">:</span> <span class="s2">"person"</span>
  <span class="p">},</span>
  <span class="s2">"pump"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"mode"</span><span class="p">:</span> <span class="s2">"$ENV(pump-mode)"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Resulting data in database:</p>
<a class="reference internal image-reference" href="_images/lab-db-entries.png"><img alt="The person entities shown in the database browser after export" class="align-center" src="_images/lab-db-entries.png" style="width: 800px;"/></a>
</div>
<div class="section" id="id55">
<h4>Lab 26<a class="headerlink" href="#id55" title="Permalink to this headline">#</a></h4>
<p>System config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"typicode"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"system:url"</span><span class="p">,</span>
  <span class="s2">"url_pattern"</span><span class="p">:</span> <span class="s2">"$ENV(typicode-baseurl)"</span><span class="p">,</span>
  <span class="s2">"verify_ssl"</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>preparation pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"person-typicode"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"global-person"</span>
  <span class="p">},</span>
  <span class="s2">"transform"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dtl"</span><span class="p">,</span>
    <span class="s2">"rules"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"default"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">"copy"</span><span class="p">,</span>
          <span class="p">[</span><span class="s2">"list"</span><span class="p">,</span> <span class="s2">"_id"</span><span class="p">,</span> <span class="s2">"global-person:firstname"</span><span class="p">,</span> <span class="s2">"global-person:lastname"</span><span class="p">,</span> <span class="s2">"global-person:address"</span><span class="p">]</span>
        <span class="p">]</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>preparation pipe output:</p>
<a class="reference internal image-reference" href="_images/lab-api-prep-pipe.png"><img alt="Entity resulting from lab task as seen in the pipe's &quot;Output&quot;-tab" class="align-center" src="_images/lab-api-prep-pipe.png" style="width: 800px;"/></a>
<p>Output pipe config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"_id"</span><span class="p">:</span> <span class="s2">"person-typicode-endpoint"</span><span class="p">,</span>
  <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"pipe"</span><span class="p">,</span>
  <span class="s2">"source"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"dataset"</span><span class="p">,</span>
    <span class="s2">"dataset"</span><span class="p">:</span> <span class="s2">"person-typicode"</span>
  <span class="p">},</span>
  <span class="s2">"sink"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="s2">"system"</span><span class="p">:</span> <span class="s2">"typicode"</span><span class="p">,</span>
    <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"posts"</span>
  <span class="p">},</span>
  <span class="s2">"pump"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"mode"</span><span class="p">:</span> <span class="s2">"$ENV(pump-mode)"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Execution log “pump-completed” log entry:</p>
<a class="reference internal image-reference" href="_images/lab-api-exec-log.png"><img alt="A &quot;pump-completed&quot; entry in the output pipe's execution log" class="align-center" src="_images/lab-api-exec-log.png" style="width: 800px;"/></a>
</div>
</div>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="quick-reference.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Quick Reference</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="sharing-data.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Sharing data</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022 Sesam.io AS
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Getting started</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#setting-up-our-sesam-instance">Setting up our Sesam instance</a><ul>
<li><a class="reference internal" href="#sign-up">Sign up</a></li>
<li><a class="reference internal" href="#upload-config">Upload config</a><ul>
<li><a class="reference internal" href="#config-contents">Config contents</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#sesam-overview">Sesam overview</a><ul>
<li><a class="reference internal" href="#glossary">Glossary</a></li>
<li><a class="reference internal" href="#naming-conventions">Naming conventions</a><ul>
<li><a class="reference internal" href="#general-rules">General rules</a></li>
<li><a class="reference internal" href="#systems">Systems</a></li>
<li><a class="reference internal" href="#pipes">Pipes</a></li>
<li><a class="reference internal" href="#datasets">Datasets</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#getting-started-pipes">Pipes</a><ul>
<li><a class="reference internal" href="#basic-dtl-and-functions">Basic DTL and functions</a></li>
<li><a class="reference internal" href="#lab-time">Lab time</a></li>
<li><a class="reference internal" href="#transformations">Transformations</a><ul>
<li><a class="reference internal" href="#rules">Rules</a></li>
<li><a class="reference internal" href="#merging-sources">Merging sources</a></li>
<li><a class="reference internal" href="#coalesce-list-and-other-useful-dtl-functions">Coalesce, list and other useful DTL functions</a></li>
<li><a class="reference internal" href="#global-datasets">Global datasets</a></li>
<li><a class="reference internal" href="#namespace-identifiers">Namespace identifiers</a></li>
<li><a class="reference internal" href="#merging-with-dtl">Merging with DTL</a></li>
<li><a class="reference internal" href="#apply">Apply</a></li>
<li><a class="reference internal" href="#hops">Hops</a></li>
<li><a class="reference internal" href="#apply-hops">Apply-hops</a></li>
<li><a class="reference internal" href="#should-i-add-or-merge-an-apply-hops">Should I “add” or “merge” an apply-hops?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#getting-started-labtime-2">Lab time</a></li>
<li><a class="reference internal" href="#dependency-tracking-and-resetting-a-pipe">Dependency-tracking and resetting a pipe</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sinks">Sinks</a><ul>
<li><a class="reference internal" href="#csv-endpoint-sink">CSV endpoint sink</a></li>
<li><a class="reference internal" href="#sql-database-to-csv-file-output-step-by-step">SQL database to CSV file output step by step</a><ul>
<li><a class="reference internal" href="#using-secrets">Using secrets</a></li>
<li><a class="reference internal" href="#creating-a-table-in-the-database">Creating a table in the database</a></li>
<li><a class="reference internal" href="#creating-our-csv-sink">Creating our CSV sink</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sql-sink-example-configuration">SQL sink example configuration</a><ul>
<li><a class="reference internal" href="#http-endpoint-and-retrieving-data">HTTP-endpoint and retrieving data</a></li>
<li><a class="reference internal" href="#exposing-datasets-with-http-endpoint">Exposing datasets with HTTP-endpoint</a></li>
<li><a class="reference internal" href="#fetch-data">Fetch data</a></li>
<li><a class="reference internal" href="#writing-data-to-external-systems">Writing data to external systems</a></li>
</ul>
</li>
<li><a class="reference internal" href="#getting-started-labtime-3">Lab time</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pumps">Pumps</a><ul>
<li><a class="reference internal" href="#dead-letters">Dead letters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#microservices">Microservices</a><ul>
<li><a class="reference internal" href="#workflow">Workflow</a></li>
<li><a class="reference internal" href="#microservices-with-docker">Microservices with Docker</a><ul>
<li><a class="reference internal" href="#testing">Testing</a></li>
<li><a class="reference internal" href="#push-to-docker-hub">Push to Docker Hub</a></li>
<li><a class="reference internal" href="#import-to-sesam-node">Import to Sesam node</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rest-apis">REST APIs</a><ul>
<li><a class="reference internal" href="#authentication">Authentication</a></li>
<li><a class="reference internal" href="#json-web-tokens">JSON Web Tokens</a></li>
<li><a class="reference internal" href="#requests-methods">Requests methods</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#labs">Labs</a><ul>
<li><a class="reference internal" href="#basics">Basics</a><ul>
<li><a class="reference internal" href="#lab-1">Lab 1</a><ul>
<li><a class="reference internal" href="#task">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-2">Lab 2</a><ul>
<li><a class="reference internal" href="#id5">Task</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#import-data">Import data</a><ul>
<li><a class="reference internal" href="#lab-3">Lab 3</a><ul>
<li><a class="reference internal" href="#id6">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-4">Lab 4</a><ul>
<li><a class="reference internal" href="#id7">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-5">Lab 5</a><ul>
<li><a class="reference internal" href="#id8">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-6">Lab 6</a><ul>
<li><a class="reference internal" href="#id9">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-7">Lab 7</a><ul>
<li><a class="reference internal" href="#id10">Task</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#data-modelling">Data Modelling</a><ul>
<li><a class="reference internal" href="#lab-8">Lab 8</a><ul>
<li><a class="reference internal" href="#id11">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-9">Lab 9</a><ul>
<li><a class="reference internal" href="#id12">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-10">Lab 10</a><ul>
<li><a class="reference internal" href="#id13">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-11">Lab 11</a><ul>
<li><a class="reference internal" href="#id14">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-12">Lab 12</a><ul>
<li><a class="reference internal" href="#id15">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-13">Lab 13</a><ul>
<li><a class="reference internal" href="#id16">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-14">Lab 14</a><ul>
<li><a class="reference internal" href="#id17">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-15">Lab 15</a><ul>
<li><a class="reference internal" href="#id18">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-16">Lab 16</a><ul>
<li><a class="reference internal" href="#id19">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-17">Lab 17</a><ul>
<li><a class="reference internal" href="#id20">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-18">Lab 18</a><ul>
<li><a class="reference internal" href="#id21">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-19">Lab 19</a><ul>
<li><a class="reference internal" href="#id22">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-20">Lab 20</a><ul>
<li><a class="reference internal" href="#id23">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-21">Lab 21</a><ul>
<li><a class="reference internal" href="#id24">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-22">Lab 22</a><ul>
<li><a class="reference internal" href="#id25">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-23">Lab 23</a><ul>
<li><a class="reference internal" href="#id26">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-24">Lab 24</a><ul>
<li><a class="reference internal" href="#id27">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-25">Lab 25</a><ul>
<li><a class="reference internal" href="#id28">Task</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lab-26">Lab 26</a><ul>
<li><a class="reference internal" href="#id29">Task</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#learn-more">Learn more</a></li>
<li><a class="reference internal" href="#solution-examples">Solution examples</a><ul>
<li><a class="reference internal" href="#id30">Lab 1</a></li>
<li><a class="reference internal" href="#id31">Lab 2</a></li>
<li><a class="reference internal" href="#id32">Lab 3</a></li>
<li><a class="reference internal" href="#id33">Lab 4</a></li>
<li><a class="reference internal" href="#id34">Lab 5</a></li>
<li><a class="reference internal" href="#id35">Lab 6</a></li>
<li><a class="reference internal" href="#id36">Lab 7</a></li>
<li><a class="reference internal" href="#id37">Lab 8</a></li>
<li><a class="reference internal" href="#id38">Lab 9</a></li>
<li><a class="reference internal" href="#id39">Lab 10</a></li>
<li><a class="reference internal" href="#id40">Lab 11</a></li>
<li><a class="reference internal" href="#id41">Lab 12</a></li>
<li><a class="reference internal" href="#id42">Lab 13</a></li>
<li><a class="reference internal" href="#id43">Lab 14</a></li>
<li><a class="reference internal" href="#id44">Lab 15</a></li>
<li><a class="reference internal" href="#id45">Lab 16</a></li>
<li><a class="reference internal" href="#id46">Lab 17</a></li>
<li><a class="reference internal" href="#id47">Lab 18</a></li>
<li><a class="reference internal" href="#id48">Lab 19</a></li>
<li><a class="reference internal" href="#id49">Lab 20</a></li>
<li><a class="reference internal" href="#id50">Lab 21</a></li>
<li><a class="reference internal" href="#id51">Lab 22</a></li>
<li><a class="reference internal" href="#id52">Lab 23</a></li>
<li><a class="reference internal" href="#id53">Lab 24</a></li>
<li><a class="reference internal" href="#id54">Lab 25</a></li>
<li><a class="reference internal" href="#id55">Lab 26</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>