<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Data modelling in Sesam" href="data-modelling.html" /><link rel="prev" title="Source datatype mappings" href="source-datatype-mapping.html" />

    <meta name="generator" content="sphinx-4.4.0, furo 2022.02.14.1"/>
        <title>Self-hosted service - Docs</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=a8f031f701c6af50c9919b48f173a5785af06fac" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=25ceb02ed1c46dc30f2321ff83e92799f69dfdb9" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="announcement">
  <aside class="announcement-content">
     This is a preview of the restructured Sesam Documenantation site. For production go to <a href="https://docs.sesam.io">docs.sesam.io</a> 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Docs</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/sesamlogo.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="core-principles.html">Core principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Key features</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Concepts</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="best-practices.html">Best Practices</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="pre-planning.html">Planning a Sesam project</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup-environment.html">Setting up a Sesam environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="collecting_data.html">Collect</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-enrichment.html">Enrichment</a></li>
<li class="toctree-l2"><a class="reference internal" href="connecting-data.html">Connect</a></li>
<li class="toctree-l2"><a class="reference internal" href="transform-data.html">Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="sharing-data.html">Sharing data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick-reference.html">Quick Reference</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="developer-guide.html">Developer Guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Service Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="entitymodel.html">Entity Data Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="DTLReferenceGuide.html">Data Transformation Language (DTL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html">Service API</a></li>
<li class="toctree-l2"><a class="reference internal" href="extension-points.html">Developer Extension Points</a></li>
<li class="toctree-l2"><a class="reference internal" href="json-pull.html">JSON Pull Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="json-push.html">JSON Push Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="pump-execution.html">Pump Execution Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="cron-expressions.html">Cron Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="rdf-support.html">RDF support</a></li>
<li class="toctree-l2"><a class="reference internal" href="idempotency.html">Non-idempotency</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="notifications.html">Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="low-level-debugging.html">Low-level debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="source-datatype-mapping.html">Source datatype mapping</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Self-hosted service</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-modelling.html">Data modelling in Sesam</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="project-workflow.html">Working on a Sesam project</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="version-control-system.html">Using Sesam with a version control system</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing-locally.html">Testing a Sesam configuration locally</a></li>
<li class="toctree-l3"><a class="reference internal" href="continuous-integration.html">Continuous integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="automatic-deployment.html">Automatic deployment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="azure.html">Sesam in Microsoft Azure</a></li>
<li class="toctree-l2"><a class="reference internal" href="deprecations.html">Deprecated features</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tools.html">Tools</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="management-studio.html">Management Studio</a></li>
<li class="toctree-l2"><a class="reference internal" href="sesam-client.html">Sesam Client</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="databrowser.html">Databrowser</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="databrowser-guide.html">Databrowser Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="databrowser-auth.html">Authentication and authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="databrowser-api.html">Configuration file API</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="gdpr-platform.html">GDPR platform</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="gdpr-platform-configuration.html">Platform configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="gdpr-data-types-purposes-configuration.html">Datatypes and purposes configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="gdpr-data-access-portal.html">The GDPR data access portal</a></li>
<li class="toctree-l3"><a class="reference internal" href="gdpr-platform-developer-docs.html">Developer documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="gdpr-getting-started.html">Getting started</a></li>
<li class="toctree-l3"><a class="reference internal" href="gdpr-changelog.html">Changelog</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="behind-the-scenes.html">Behind the scenes</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="legal.html">Legal</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="terms.html">Terms of Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="legal-service.html">Description of the Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="pricing.html">Subscription Fee, payment terms</a></li>
<li class="toctree-l2"><a class="reference internal" href="legal-dap.html">Data Process Agreement</a></li>
<li class="toctree-l2"><a class="reference internal" href="partner-agreement.html">Partner Agreement</a></li>
<li class="toctree-l2"><a class="reference internal" href="privacy-policy.html">Privacy Policy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="self-hosted-service">
<span id="self-hosted"></span><h1>Self-hosted service<a class="headerlink" href="#self-hosted-service" title="Permalink to this headline">#</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>Sesam is offered as service that is either hosted for you in the cloud or you host it yourself. We generally recommend the former, but there are scenarios where you would want to host it yourself. This document explains the requirements and the installation steps necessary to get the single-machine Sesam service running in a self-hosted environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Self hosted subscriptions are required to run the latest image of their chosen <a class="reference external" href="https://docs.sesam.io/concepts.html#software-channels">software channel</a>.</p>
</div>
</div>
<div class="section" id="hardware-requirements">
<h2>Hardware requirements<a class="headerlink" href="#hardware-requirements" title="Permalink to this headline">#</a></h2>
<p>We recommend setting up at least a machine with 4 CPUs, 16GB RAM and a 350GB data partition with fast storage depending on what needs you have.</p>
</div>
<div class="section" id="software-requirements">
<h2>Software requirements<a class="headerlink" href="#software-requirements" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Ubuntu &gt;= 18.04 or RHEL &gt;= 7. We prefer running Ubuntu if possible.</p></li>
<li><p>Python3</p></li>
<li><p>Sesam will install the <em>sesam-agent</em> which in turn will setup and configure docker.</p></li>
</ul>
</div>
<div class="section" id="firewall-requirements">
<h2>Firewall requirements<a class="headerlink" href="#firewall-requirements" title="Permalink to this headline">#</a></h2>
<p>In general it is hard to be specific on IP addresses since most of these services are hosted on Content Delivery Networks (CDNs), which basically means that you have no guarantee that the IPs don’t change. If you don’t have a firewall that support wildcards and/or use of domain names, an option is to allow this access through a proxy.</p>
<div class="section" id="inbound-firewall-rules">
<span id="id1"></span><h3>Inbound firewall rules<a class="headerlink" href="#inbound-firewall-rules" title="Permalink to this headline">#</a></h3>
<div class="table-wrapper"><table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 15%"/>
<col style="width: 10%"/>
<col style="width: 65%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Port</p></th>
<th class="head"><p>Source</p></th>
<th class="head"><p>Destination</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>80/HTTP</p></td>
<td><p>ANY (Public)</p></td>
<td><p>Sesam IP</p></td>
<td><p>Sesam uses <a class="reference external" href="https://letsencrypt.org/">Let’s Encrypt</a> for SSL certificates. Letsencrypt requires port 80 to be open for incoming traffic from ANY (they don’t provide a list of src IPs)  to support renewal of certificates. If you want to bring your own certificate or use a self-signed this port opening can be skipped.</p></td>
</tr>
<tr class="row-odd"><td><p>443/HTTPS</p></td>
<td><p>Clients</p></td>
<td><p>Sesam IP</p></td>
<td><p>Any client that needs to connect to the sesam node api needs to have access to port 443 on the sesam-node IP. This does not need to happen over the internet and can be access given through local network/VPN or similar.</p></td>
</tr>
</tbody>
</table></div>
</div>
<div class="section" id="outbound-firewall-rules">
<span id="self-hosted-outbound-firewall-rules"></span><h3>Outbound firewall rules<a class="headerlink" href="#outbound-firewall-rules" title="Permalink to this headline">#</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>These outbound firewall rules must be active for the service to operate fully. Not opening the ports for the specified domains may violate the terms of service.</p>
</div>
<div class="table-wrapper"><table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 15%"/>
<col style="width: 10%"/>
<col style="width: 65%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Port</p></th>
<th class="head"><p>Source</p></th>
<th class="head"><p>Destination</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>443/HTTPS</p></td>
<td><p>Sesam IP</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">*.docker.com</span></code>, <code class="docutils literal notranslate"><span class="pre">*.docker.io</span></code></p></td>
<td><p>The sesam-node needs access to docker HUB to pull and update images used by the sesam-node and microservices.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the outbound firewall is not open the service will not be able to self-update.</p>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>443/HTTPS</p></td>
<td><p>Sesam IP</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">*.letsencrypt.org</span></code></p></td>
<td><p>Only needed if certificates are managed by <a class="reference external" href="https://certbot.eff.org/">Certbot</a> / <a class="reference external" href="https://letsencrypt.org/">Let’s Encrypt</a> (see description on <a class="reference internal" href="#inbound-firewall-rules"><span class="std std-ref">inbound port 80</span></a>)</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the outbound firewall is not open the service will not be able to update its Let’s Encrypt TLS certificates.</p>
</div>
</td>
</tr>
<tr class="row-even"><td><p>443/HTTPS</p></td>
<td><p>Sesam IP</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">*.sesam.io</span></code>, <code class="docutils literal notranslate"><span class="pre">*.sesam.cloud</span></code></p></td>
<td><p>The sesam-node needs to communicate with several services hosted on these domains. These services include the sesam portal, log shipping, shipping metrics and sesam-agent updates.</p>
<p>More information on how monitoring works can be found <a class="reference internal" href="behind-the-scenes.html#monitoring"><span class="std std-ref">here</span></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the outbound firewall is not open the service will not be able to retrieve data from the Sesam portal, and it won’t be able to ship logs and metrics to Sesam. This will make notifications not work and it will break billing.</p>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>443/HTTPS</p></td>
<td><p>Sesam IP</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">files.pythonhosted.org</span></code>, <code class="docutils literal notranslate"><span class="pre">pypi.org</span></code></p></td>
<td><p>The sesam-agent is a python program that has some dependencies on software that is hosted on <a class="reference external" href="https://pypi.org/">The Python Package Index (PyPI)</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the outbound firewall is not open the service will not be able to self-update.</p>
</div>
</td>
</tr>
</tbody>
</table></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">*.sesam.io</span></code> and <code class="docutils literal notranslate"><span class="pre">*.sesam.cloud</span></code> can be replaced with IPs <code class="docutils literal notranslate"><span class="pre">137.116.234.60</span></code> and <code class="docutils literal notranslate"><span class="pre">52.142.116.113</span></code>. The former is for downloading and upgrading the agent, and the latter is for log shipping. We do not recommend doing this as these IPs are subject to change at any time.</p>
</div>
</div>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">#</a></h2>
<p>Before starting the setup you will  need:</p>
<ul class="simple">
<li><p>A subscription in the <a class="reference external" href="https://portal.sesam.io">Sesam portal</a></p></li>
<li><p>A license key</p></li>
<li><p>A docker repository login (provided by Sesam support)</p></li>
<li><p>A sesam-agent config (example below)</p></li>
</ul>
<div class="section" id="file-structure">
<span id="self-hosted-file-structure"></span><h3>File structure<a class="headerlink" href="#file-structure" title="Permalink to this headline">#</a></h3>
<p>These steps assume that your datadisk is mounted at /srv/data.
If you want your data stored on the root-disk directly, just create the datafolder /sesam/node-00/data and skip the symbolic link.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">sesam</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="mi">00</span><span class="o">/</span><span class="n">data</span>
<span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">sesam</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="mi">00</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">sesam</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="mi">00</span><span class="o">/</span><span class="n">data</span> <span class="o">/</span><span class="n">sesam</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="mi">00</span><span class="o">/</span><span class="n">data</span>
<span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sesam</span><span class="o">-</span><span class="n">agent</span>
</pre></div>
</div>
</div>
<div class="section" id="license-key">
<h3>License Key<a class="headerlink" href="#license-key" title="Permalink to this headline">#</a></h3>
<p>Sesam requires a valid license to function. Without a valid license the pipes will stop running. Instructions for obtaining a valid license key can be found in the <a class="reference external" href="https://portal.sesam.io/">Sesam Portal</a>. Save the license key to the <code class="docutils literal notranslate"><span class="pre">/srv/data/sesam/node-00/data/license.key</span></code> file.</p>
</div>
<div class="section" id="agent-configuration-file">
<h3>Agent Configuration File<a class="headerlink" href="#agent-configuration-file" title="Permalink to this headline">#</a></h3>
<p>Example config file (must be located at /etc/sesam-agent/config.json)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">"docker_username"</span><span class="p">:</span> <span class="s2">"sesamonprem"</span><span class="p">,</span>
  <span class="s2">"docker_password"</span><span class="p">:</span> <span class="s2">"&lt;TOKEN&gt;"</span><span class="p">,</span>
  <span class="s2">"nginx"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"disable"</span><span class="p">:</span> <span class="n">false</span>
  <span class="p">},</span>
  <span class="s2">"sesam-node"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"args"</span><span class="p">:</span> <span class="s2">"--sesam-portal-url https://portal.sesam.io/ --redirect-portal-gui 1 -b /sesam/data/backup --backup-use-checkpoints "</span><span class="p">,</span>
    <span class="s2">"tag"</span><span class="p">:</span> <span class="s2">"weekly-prod"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="install-the-agent">
<span id="self-hosted-install-the-agent"></span><h3>Install the Agent<a class="headerlink" href="#install-the-agent" title="Permalink to this headline">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">downloads</span><span class="o">.</span><span class="n">sesam</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">agent</span><span class="o">/</span><span class="n">sesam</span><span class="o">-</span><span class="n">agent</span> <span class="o">-</span><span class="n">O</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">sesam</span><span class="o">-</span><span class="n">agent</span>
<span class="n">sudo</span> <span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">sesam</span><span class="o">-</span><span class="n">agent</span>
<span class="n">sudo</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">sesam</span><span class="o">-</span><span class="n">agent</span> <span class="n">install</span>
<span class="n">sudo</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">sesam</span><span class="o">-</span><span class="n">agent</span> <span class="n">start</span>
</pre></div>
</div>
<p>Log in to <a class="reference external" href="https://portal.sesam.io">Sesam portal</a> and add your sesam-node URL to the connection under the network tab and finally upload the license.</p>
</div>
<div class="section" id="bring-your-own-certificate">
<h3>Bring your own certificate<a class="headerlink" href="#bring-your-own-certificate" title="Permalink to this headline">#</a></h3>
<p>In order to serve the node with your own certificate you will need a valid password-less KEY and a cert in PEM format. If your certificate is password protected you can remove the password with openssl or equivalent tools.</p>
<p>Give your cert and key a name and place them in the <code class="docutils literal notranslate"><span class="pre">/sesam/nginx/conf/ssl</span></code> folder (<code class="docutils literal notranslate"><span class="pre">privkey.pem</span></code> and <code class="docutils literal notranslate"><span class="pre">fullchain.pem</span></code> in this example).</p>
<p>Update the Sesam configuration file (<code class="docutils literal notranslate"><span class="pre">/etc/sesam-agent/config.json</span></code>) to include the path to the keys in the nginx section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"nginx"</span><span class="p">:</span> <span class="p">{</span>
  <span class="s2">"ssl_cert"</span><span class="p">:</span> <span class="s2">"/etc/nginx/includes.d/ssl/fullchain.pem"</span><span class="p">,</span>
  <span class="s2">"ssl_key"</span><span class="p">:</span> <span class="s2">"/etc/nginx/includes.d/ssl/privkey.pem"</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Restart nginx for things to take effect:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">restart</span> <span class="n">nginx</span>
</pre></div>
</div>
</div>
<div class="section" id="migrate-an-old-installation-to-use-the-sesam-agent">
<h3>Migrate an old installation to use the sesam-agent<a class="headerlink" href="#migrate-an-old-installation-to-use-the-sesam-agent" title="Permalink to this headline">#</a></h3>
<p>Be sure to back up your data before proceeding. Before <a class="reference internal" href="#self-hosted-install-the-agent"><span class="std std-ref">Install the Agent</span></a> section you must make sure you have done the following:</p>
<ul class="simple">
<li><p>Stop and remove all running containers.</p></li>
<li><p>Copy or move the current store folder and license to the location configured under <a class="reference internal" href="#self-hosted-file-structure"><span class="std std-ref">File structure</span></a>.</p></li>
</ul>
</div>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="data-modelling.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Data modelling in Sesam</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="source-datatype-mapping.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Source datatype mappings</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022 Sesam.io AS
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Self-hosted service</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#hardware-requirements">Hardware requirements</a></li>
<li><a class="reference internal" href="#software-requirements">Software requirements</a></li>
<li><a class="reference internal" href="#firewall-requirements">Firewall requirements</a><ul>
<li><a class="reference internal" href="#inbound-firewall-rules">Inbound firewall rules</a></li>
<li><a class="reference internal" href="#outbound-firewall-rules">Outbound firewall rules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#file-structure">File structure</a></li>
<li><a class="reference internal" href="#license-key">License Key</a></li>
<li><a class="reference internal" href="#agent-configuration-file">Agent Configuration File</a></li>
<li><a class="reference internal" href="#install-the-agent">Install the Agent</a></li>
<li><a class="reference internal" href="#bring-your-own-certificate">Bring your own certificate</a></li>
<li><a class="reference internal" href="#migrate-an-old-installation-to-use-the-sesam-agent">Migrate an old installation to use the sesam-agent</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>